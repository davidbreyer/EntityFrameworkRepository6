\documentclass[a4paper,10pt]{article}
\usepackage[paper=a4paper,left=20mm,right=20mm,top=20mm,bottom=20mm]{geometry}
\usepackage{longtable}
\usepackage{fancyhdr}
\usepackage[pdftex]{color}
\usepackage{colortbl}
\definecolor{green}{rgb}{0,1,0.12}
\definecolor{red}{rgb}{1,0,0}
\definecolor{gray}{rgb}{0.86,0.86,0.86}

\usepackage[pdftex,
            colorlinks=true, linkcolor=red, urlcolor=green, citecolor=red,%
            raiselinks=true,%
            bookmarks=true,%
            bookmarksopenlevel=1,%
            bookmarksopen=true,%
            bookmarksnumbered=true,%
            hyperindex=true,% 
            plainpages=false,% correct hyperlinks
            pdfpagelabels=true%,% view TeX pagenumber in PDF reader
            %pdfborder={0 0 0.5}
            ]{hyperref}

\hypersetup{pdftitle={Coverage Report},
            pdfauthor={ReportGenerator - 2.5.5.0}
           }

\pagestyle{fancy}
\fancyhead[LE,LO]{\leftmark}
\fancyhead[R]{\thepage}
\fancyfoot[C]{ReportGenerator - 2.5.5.0}

\begin{document}

\setcounter{secnumdepth}{-1}
\section{Summary}
\begin{longtable}[l]{ll}
\textbf{Generated on:} & 3/3/2017 - 8:38:07 AM\\
\textbf{Parser:} & VisualStudioParser\\
\textbf{Assemblies:} & 8\\
\textbf{Classes:} & 53\\
\textbf{Files:} & 46\\
\textbf{Covered lines:} & 1445\\
\textbf{Uncovered lines:} & 175\\
\textbf{Coverable lines:} & 1620\\
\textbf{Total lines:} & 4298\\
\textbf{Line coverage:} & 89.1\%\\
\end{longtable}
\section{Assemblies}
\begin{longtable}[l]{ll}
\textbf{entityframework.auditable.repository6.dll} & \textbf{81.4\%}\\
EntityFramework.Auditable.Repository6.AuditableBaseContext<TContext> & 28.5\%\\
EntityFramework.Auditable.Repository6.AuditableBaseRepository & 0\%\\
EntityFramework.Auditable.Repository6.AuditableBaseRepository<C, T> & 100\%\\
EntityFramework.Repository6.BaseContext<TContext> & 0\%\\
EntityFramework.Repository6.BaseRepository & 63.1\%\\
EntityFramework.Repository6.BaseRepository<C, T> & 96.7\%\\
EntityFramework.Repository6.DatabaseFactory<C> & 0\%\\
EntityFramework.Repository6.Delta<T> & 100\%\\
\textbf{entityframework.auditable.repository6.tests.dll} & \textbf{98.2\%}\\
EntityFramework.Auditable.Repository6.Tests.RepositoryCreateTests & 98.7\%\\
EntityFramework.Auditable.Repository6.Tests.RepositoryDeleteTests & 100\%\\
EntityFramework.Auditable.Repository6.Tests.RepositoryReadTests & 100\%\\
EntityFramework.Auditable.Repository6.Tests.RepositoryUpdateTests & 98.3\%\\
EntityFramework.Auditable.Repository6.Tests.TestDbInitializer & 100\%\\
EntityFramework.Auditable.Repository6.Tests.TestExampleDatabaseFactory & 100\%\\
EntityFramework.Repository6.Tests.DeltaTests & 94.1\%\\
\textbf{entityframework.auditing.dll} & \textbf{79.4\%}\\
EntityFramework.Auditing.AuditableEntity & 100\%\\
EntityFramework.Auditing.AuditConfigurationSection & 66.6\%\\
EntityFramework.Auditing.AuditDbContext & 83.9\%\\
EntityFramework.Auditing.AuditEntity & 100\%\\
EntityFramework.Auditing.AuditTypeInfo & 100\%\\
EntityFramework.Auditing.EntityElement & 50\%\\
EntityFramework.Auditing.EntityElementCollection & 37.5\%\\
\textbf{entityframework.auditing.test.dll} & \textbf{88\%}\\
EntityFramework.Auditing.Test.AuditDbTest & 87.5\%\\
EntityFramework.Auditing.Test.Context & 100\%\\
EntityFramework.Auditing.Test.Customer & 100\%\\
EntityFramework.Auditing.Test.CustomerAudit & 100\%\\
\textbf{entityframework.repository6.dll} & \textbf{85.2\%}\\
EntityFramework.Repository6.BaseContext<TContext> & 28.5\%\\
EntityFramework.Repository6.BaseRepository & 63.1\%\\
EntityFramework.Repository6.BaseRepository<C, T> & 96.7\%\\
EntityFramework.Repository6.DatabaseFactory<C> & 0\%\\
EntityFramework.Repository6.Delta<T> & 100\%\\
\textbf{entityframework.repository6.tests.dll} & \textbf{98.7\%}\\
EntityFramework.Repository6.Tests.DeltaTests & 96\%\\
EntityFramework.Repository6.Tests.RepositoryCreateTests & 98.7\%\\
EntityFramework.Repository6.Tests.RepositoryDeleteTests & 100\%\\
EntityFramework.Repository6.Tests.RepositoryReadTests & 100\%\\
EntityFramework.Repository6.Tests.RepositoryUpdateTests & 97.8\%\\
EntityFramework.Repository6.Tests.TestDbInitializer & 100\%\\
EntityFramework.Repository6.Tests.TestExampleDatabaseFactory & 100\%\\
\textbf{persistentlayer.auditable.dll} & \textbf{68.9\%}\\
PersistentLayer.Auditable.Contexts.YourCustomDataContext & 80\%\\
PersistentLayer.Auditable.Entities.PersistentEntity & 0\%\\
PersistentLayer.Auditable.Entities.SimpleCompositeKeyEntity & 100\%\\
PersistentLayer.Auditable.Entities.SimpleDataEntity & 100\%\\
PersistentLayer.Auditable.Entities.SimpleDataEntityAudit & 100\%\\
PersistentLayer.Auditable.Initializers.MyDbInitializer & 0\%\\
PersistentLayer.Auditable.Repositories.SimpleCompositeKeyEntityRepository & 100\%\\
PersistentLayer.Auditable.Repositories.SimpleDataEntityRepository & 100\%\\
\textbf{persistentlayer.dll} & \textbf{61.9\%}\\
PersistentLayer.Contexts.YourCustomDataContext & 75\%\\
PersistentLayer.Entities.PersistentEntity & 100\%\\
PersistentLayer.Entities.SimpleCompositeKeyEntity & 100\%\\
PersistentLayer.Entities.SimpleDataEntity & 100\%\\
PersistentLayer.Initializers.MyDbInitializer & 0\%\\
PersistentLayer.Repositories.SimpleCompositeKeyEntityRepository & 100\%\\
PersistentLayer.Repositories.SimpleDataEntityRepository & 100\%\\
\end{longtable}
\newpage
\section{EntityFramework.Auditable.Repository6.AuditableBaseContext<TContext>}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Auditable.Repository6.AuditableBaseContext<TContext>\\
\textbf{Assembly:} & entityframework.auditable.repository6.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{ameworkRepository6\textbackslash EntityFrameworkAuditableRepository6\textbackslash AuditableBaseContext.cs}\end{minipage} \\
\textbf{Covered lines:} & 2\\
\textbf{Uncovered lines:} & 5\\
\textbf{Coverable lines:} & 7\\
\textbf{Total lines:} & 24\\
\textbf{Line coverage:} & 28.5\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{AuditableBaseContext} & 1 & 0\\
\hline
\textbf{AuditableBaseContext} & 3 & 0\\
\hline
\textbf{AuditableBaseContext} & 0 & 3\\
\hline
\textbf{AuditableBaseContext} & 0 & 3\\
\hline
\textbf{AuditableBaseContext} & 0 & 3\\
\hline
\textbf{AuditableBaseContext} & 0 & 3\\
\hline
\textbf{AuditableBaseContext} & 0 & 3\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{ameworkRepository6\textbackslash EntityFrameworkAuditableRepository6\textbackslash AuditableBaseContext.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using EntityFramework.Auditing;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using System.Data.Common;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System.Data.Entity;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~namespace EntityFramework.Auditable.Repository6~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~    public class AuditableBaseContext<TContext> : AuditDbContext~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~            where TContext : AuditDbContext~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~10~ & & \verb~        static AuditableBaseContext() { }~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~12~ & & \verb~        protected AuditableBaseContext(DbConnection dbConnection) : base(dbCon~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~14~ & & \verb~        protected AuditableBaseContext(DbConnection dbConnection, bool context~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~16~ & & \verb~        protected AuditableBaseContext(string connectionString) : base(connect~\\
\cellcolor{gray} &  & \verb~17~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~18~ & & \verb~        protected AuditableBaseContext(string connectionString, IDatabaseIniti~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~20~ & & \verb~        protected AuditableBaseContext(DbConnection dbConnection, IDatabaseIni~\\
\cellcolor{gray} &  & \verb~21~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~22~ & & \verb~        protected AuditableBaseContext(DbConnection dbConnection, IDatabaseIni~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Auditable.Repository6.AuditableBaseRepository}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Auditable.Repository6.AuditableBaseRepository\\
\textbf{Assembly:} & entityframework.auditable.repository6.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{workRepository6\textbackslash EntityFrameworkAuditableRepository6\textbackslash AuditableBaseRepository.cs}\end{minipage} \\
\textbf{Covered lines:} & 0\\
\textbf{Uncovered lines:} & 3\\
\textbf{Coverable lines:} & 3\\
\textbf{Total lines:} & 31\\
\textbf{Line coverage:} & 0\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{SaveAsync()} & 0 & 5\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{workRepository6\textbackslash EntityFrameworkAuditableRepository6\textbackslash AuditableBaseRepository.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using EntityFramework.Auditing;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using EntityFramework.Repository6;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using EntityFramework.Repository6.Interfaces;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~namespace EntityFramework.Auditable.Repository6~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~    public abstract class AuditableBaseRepository<C, T> :~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~        BaseRepository<C, T>~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~        , IBaseRepository<C, T>~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~        , IDisposable~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~        , IAuditSaveFunctions<T>~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~        where T : class~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~        where C : AuditDbContext~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~17~ & & \verb~        protected AuditableBaseRepository(C context) : base(context)~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~~\\
\cellcolor{gray} &  & \verb~21~ & & \verb~        public async virtual Task<int> SaveAsync(string userName)~\\
\cellcolor{red} & 0 & \verb~22~ & & \verb~        {~\\
\cellcolor{red} & 0 & \verb~23~ & & \verb~            return await Context.SaveChangesAsync(userName);~\\
\cellcolor{red} & 0 & \verb~24~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~25~ & & \verb~~\\
\cellcolor{gray} &  & \verb~26~ & & \verb~        public virtual int Save(string userName)~\\
\cellcolor{gray} &  & \verb~27~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~28~ & & \verb~            return Context.SaveChanges(userName);~\\
\cellcolor{gray} &  & \verb~29~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~31~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Auditable.Repository6.AuditableBaseRepository<C, T>}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Auditable.Repository6.AuditableBaseRepository<C, T>\\
\textbf{Assembly:} & entityframework.auditable.repository6.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{workRepository6\textbackslash EntityFrameworkAuditableRepository6\textbackslash AuditableBaseRepository.cs}\end{minipage} \\
\textbf{Covered lines:} & 6\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 6\\
\textbf{Total lines:} & 31\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{AuditableBaseReposit} & 2 & 0\\
\hline
\textbf{Save(string)} & 4 & 0\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{workRepository6\textbackslash EntityFrameworkAuditableRepository6\textbackslash AuditableBaseRepository.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using EntityFramework.Auditing;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using EntityFramework.Repository6;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using EntityFramework.Repository6.Interfaces;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~namespace EntityFramework.Auditable.Repository6~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~    public abstract class AuditableBaseRepository<C, T> :~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~        BaseRepository<C, T>~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~        , IBaseRepository<C, T>~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~        , IDisposable~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~        , IAuditSaveFunctions<T>~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~        where T : class~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~        where C : AuditDbContext~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~17~ & & \verb~        protected AuditableBaseRepository(C context) : base(context)~\\
\cellcolor{green} & 1 & \verb~18~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~19~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~~\\
\cellcolor{gray} &  & \verb~21~ & & \verb~        public async virtual Task<int> SaveAsync(string userName)~\\
\cellcolor{gray} &  & \verb~22~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~            return await Context.SaveChangesAsync(userName);~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~25~ & & \verb~~\\
\cellcolor{gray} &  & \verb~26~ & & \verb~        public virtual int Save(string userName)~\\
\cellcolor{green} & 1 & \verb~27~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~28~ & & \verb~            return Context.SaveChanges(userName);~\\
\cellcolor{green} & 1 & \verb~29~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~31~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Repository6.BaseContext<TContext>}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Repository6.BaseContext<TContext>\\
\textbf{Assembly:} & entityframework.auditable.repository6.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{velopment\textbackslash EntityFrameworkRepository6\textbackslash EntityFrameworkRepository6\textbackslash BaseContext.cs}\end{minipage} \\
\textbf{Covered lines:} & 0\\
\textbf{Uncovered lines:} & 7\\
\textbf{Coverable lines:} & 7\\
\textbf{Total lines:} & 23\\
\textbf{Line coverage:} & 0\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{BaseContext()} & 0 & 1\\
\hline
\textbf{BaseContext(System.D} & 0 & 3\\
\hline
\textbf{BaseContext(System.D} & 0 & 3\\
\hline
\textbf{BaseContext(string)} & 0 & 3\\
\hline
\textbf{BaseContext(string, } & 0 & 3\\
\hline
\textbf{BaseContext(System.D} & 0 & 3\\
\hline
\textbf{BaseContext(System.D} & 0 & 3\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{velopment\textbackslash EntityFrameworkRepository6\textbackslash EntityFrameworkRepository6\textbackslash BaseContext.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using System.Data.Common;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using System.Data.Entity;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~namespace EntityFramework.Repository6~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~    public class BaseContext<TContext> : DbContext~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~            where TContext : DbContext~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~    {~\\
\cellcolor{red} & 0 & \verb~9~ & & \verb~        static BaseContext() { }~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~11~ & & \verb~        protected BaseContext(DbConnection dbConnection) : base(dbConnection, ~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~13~ & & \verb~        protected BaseContext(DbConnection dbConnection, bool contextOwnsConne~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~15~ & & \verb~        protected BaseContext(string connectionString) : base(connectionString~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~17~ & & \verb~        protected BaseContext(string connectionString, IDatabaseInitializer<TC~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~19~ & & \verb~        protected BaseContext(DbConnection dbConnection, IDatabaseInitializer<~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~21~ & & \verb~        protected BaseContext(DbConnection dbConnection, IDatabaseInitializer<~\\
\cellcolor{gray} &  & \verb~22~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Repository6.BaseRepository}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Repository6.BaseRepository\\
\textbf{Assembly:} & entityframework.auditable.repository6.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{opment\textbackslash EntityFrameworkRepository6\textbackslash EntityFrameworkRepository6\textbackslash BaseRepository.cs}\end{minipage} \\
\textbf{Covered lines:} & 12\\
\textbf{Uncovered lines:} & 7\\
\textbf{Coverable lines:} & 19\\
\textbf{Total lines:} & 241\\
\textbf{Line coverage:} & 63.1\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{FindAsync()} & 6 & 0\\
\hline
\textbf{FindAsync()} & 6 & 0\\
\hline
\textbf{ReloadAsync()} & 6 & 0\\
\hline
\textbf{SaveAsync()} & 0 & 5\\
\hline
\textbf{CountAsync()} & 0 & 6\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{opment\textbackslash EntityFrameworkRepository6\textbackslash EntityFrameworkRepository6\textbackslash BaseRepository.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using EntityFramework.Repository6.Interfaces;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using System.Data.Entity;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Linq.Expressions;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~namespace EntityFramework.Repository6~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~    public abstract class BaseRepository<C, T> :~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~            IBaseRepository<C, T>~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~            , IDisposable~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~        where T : class~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~        where C : DbContext~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~17~ & & \verb~        protected C Context { get; set; }~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~        protected Lazy<List<string>> IgnoreFieldsOnUpdate = new Lazy<List<stri~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~        protected Lazy<List<Expression<Func<T, bool>>>> IgnoreFieldsOnUpdate2 ~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~~\\
\cellcolor{gray} &  & \verb~21~ & & \verb~        protected BaseRepository(C context)~\\
\cellcolor{gray} &  & \verb~22~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~            Context = context;~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~25~ & & \verb~~\\
\cellcolor{gray} &  & \verb~26~ & & \verb~        public virtual void AddUpdateIgnoreField(string fieldName)~\\
\cellcolor{gray} &  & \verb~27~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~28~ & & \verb~            IgnoreFieldsOnUpdate.Value.Add(fieldName);~\\
\cellcolor{gray} &  & \verb~29~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~~\\
\cellcolor{gray} &  & \verb~31~ & & \verb~        public virtual void AddUpdateIgnoreField(Expression<Func<T, bool>> fie~\\
\cellcolor{gray} &  & \verb~32~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~33~ & & \verb~            IgnoreFieldsOnUpdate2.Value.Add(fieldName);~\\
\cellcolor{gray} &  & \verb~34~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~35~ & & \verb~~\\
\cellcolor{gray} &  & \verb~36~ & & \verb~        public virtual T Find(int id)~\\
\cellcolor{gray} &  & \verb~37~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~38~ & & \verb~            T entity = Context.Set<T>().Find(id);~\\
\cellcolor{gray} &  & \verb~39~ & & \verb~~\\
\cellcolor{gray} &  & \verb~40~ & & \verb~            return entity;~\\
\cellcolor{gray} &  & \verb~41~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~42~ & & \verb~~\\
\cellcolor{gray} &  & \verb~43~ & & \verb~        public virtual T Find(params object[] ids)~\\
\cellcolor{gray} &  & \verb~44~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~45~ & & \verb~            T entity = Context.Set<T>().Find(ids);~\\
\cellcolor{gray} &  & \verb~46~ & & \verb~~\\
\cellcolor{gray} &  & \verb~47~ & & \verb~            return entity;~\\
\cellcolor{gray} &  & \verb~48~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~49~ & & \verb~~\\
\cellcolor{gray} &  & \verb~50~ & & \verb~        public virtual async Task<T> FindAsync(int id)~\\
\cellcolor{green} & 1 & \verb~51~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~52~ & & \verb~            var query = Context.Set<T>().FindAsync(id);~\\
\cellcolor{green} & 1 & \verb~53~ & & \verb~            return await query;~\\
\cellcolor{green} & 1 & \verb~54~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~55~ & & \verb~~\\
\cellcolor{gray} &  & \verb~56~ & & \verb~        public virtual async Task<T> FindAsync(params object[] ids)~\\
\cellcolor{green} & 1 & \verb~57~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~58~ & & \verb~            var query = Context.Set<T>().FindAsync(ids);~\\
\cellcolor{green} & 1 & \verb~59~ & & \verb~            return await query;~\\
\cellcolor{green} & 1 & \verb~60~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~61~ & & \verb~~\\
\cellcolor{gray} &  & \verb~62~ & & \verb~        public virtual IQueryable<T> FindBy(Expression<Func<T, bool>> predicat~\\
\cellcolor{gray} &  & \verb~63~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~64~ & & \verb~            IQueryable<T> query = Context.Set<T>().Where(predicate);~\\
\cellcolor{gray} &  & \verb~65~ & & \verb~            return query;~\\
\cellcolor{gray} &  & \verb~66~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~67~ & & \verb~~\\
\cellcolor{gray} &  & \verb~68~ & & \verb~        public virtual bool Exists(Expression<Func<T, bool>> predicate)~\\
\cellcolor{gray} &  & \verb~69~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~70~ & & \verb~            return Context.Set<T>().AsNoTracking().Any(predicate);~\\
\cellcolor{gray} &  & \verb~71~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~72~ & & \verb~~\\
\cellcolor{gray} &  & \verb~73~ & & \verb~        public virtual void Delete(T entity)~\\
\cellcolor{gray} &  & \verb~74~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~75~ & & \verb~            Context.Set<T>().Remove(entity);~\\
\cellcolor{gray} &  & \verb~76~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~77~ & & \verb~~\\
\cellcolor{gray} &  & \verb~78~ & & \verb~        public virtual void Delete(IEnumerable<T> entities)~\\
\cellcolor{gray} &  & \verb~79~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~80~ & & \verb~            foreach (T entity in entities)~\\
\cellcolor{gray} &  & \verb~81~ & & \verb~            {~\\
\cellcolor{gray} &  & \verb~82~ & & \verb~                Delete(entity);~\\
\cellcolor{gray} &  & \verb~83~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~84~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~85~ & & \verb~~\\
\cellcolor{gray} &  & \verb~86~ & & \verb~        public virtual void Reload(T entity)~\\
\cellcolor{gray} &  & \verb~87~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~88~ & & \verb~            Context.Entry<T>(entity).Reload();~\\
\cellcolor{gray} &  & \verb~89~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~90~ & & \verb~~\\
\cellcolor{gray} &  & \verb~91~ & & \verb~        public async virtual Task ReloadAsync(T entity)~\\
\cellcolor{green} & 1 & \verb~92~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~93~ & & \verb~            await Context.Entry<T>(entity).ReloadAsync();~\\
\cellcolor{green} & 1 & \verb~94~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~95~ & & \verb~~\\
\cellcolor{gray} &  & \verb~96~ & & \verb~        public virtual IQueryable<T> FindByReadOnly(Expression<Func<T, bool>> ~\\
\cellcolor{gray} &  & \verb~97~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~98~ & & \verb~            IQueryable<T> query = Context.Set<T>().AsNoTracking().Where(predic~\\
\cellcolor{gray} &  & \verb~99~ & & \verb~            return query;~\\
\cellcolor{gray} &  & \verb~100~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~101~ & & \verb~~\\
\cellcolor{gray} &  & \verb~102~ & & \verb~        public virtual IQueryable<T> GetAll()~\\
\cellcolor{gray} &  & \verb~103~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~104~ & & \verb~            IQueryable<T> query = Context.Set<T>().AsNoTracking();~\\
\cellcolor{gray} &  & \verb~105~ & & \verb~~\\
\cellcolor{gray} &  & \verb~106~ & & \verb~            return query;~\\
\cellcolor{gray} &  & \verb~107~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~108~ & & \verb~~\\
\cellcolor{gray} &  & \verb~109~ & & \verb~        public virtual T Add(T entity)~\\
\cellcolor{gray} &  & \verb~110~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~111~ & & \verb~            Context.Set<T>().Add(entity);~\\
\cellcolor{gray} &  & \verb~112~ & & \verb~~\\
\cellcolor{gray} &  & \verb~113~ & & \verb~            return entity;~\\
\cellcolor{gray} &  & \verb~114~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~115~ & & \verb~~\\
\cellcolor{gray} &  & \verb~116~ & & \verb~        public virtual IEnumerable<T> Add(IEnumerable<T> entities)~\\
\cellcolor{gray} &  & \verb~117~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~118~ & & \verb~            Context.Set<T>().AddRange(entities);~\\
\cellcolor{gray} &  & \verb~119~ & & \verb~~\\
\cellcolor{gray} &  & \verb~120~ & & \verb~            return entities;~\\
\cellcolor{gray} &  & \verb~121~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~122~ & & \verb~~\\
\cellcolor{gray} &  & \verb~123~ & & \verb~        public virtual void Update(T entity, int id)~\\
\cellcolor{gray} &  & \verb~124~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~125~ & & \verb~            var entityToUpdate = Context.Set<T>().Find(id);~\\
\cellcolor{gray} &  & \verb~126~ & & \verb~~\\
\cellcolor{gray} &  & \verb~127~ & & \verb~            if (entityToUpdate == null) throw CreateEntityNotFoundException<Ar~\\
\cellcolor{gray} &  & \verb~128~ & & \verb~~\\
\cellcolor{gray} &  & \verb~129~ & & \verb~            Context.Entry(entityToUpdate).CurrentValues.SetValues(entity);~\\
\cellcolor{gray} &  & \verb~130~ & & \verb~~\\
\cellcolor{gray} &  & \verb~131~ & & \verb~            MarkIgnoreFields(entityToUpdate);~\\
\cellcolor{gray} &  & \verb~132~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~133~ & & \verb~~\\
\cellcolor{gray} &  & \verb~134~ & & \verb~        public virtual void Update(T entity, Expression<Func<T, bool>> predica~\\
\cellcolor{gray} &  & \verb~135~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~136~ & & \verb~            var entityToUpdate = Context.Set<T>().Where(predicate).SingleOrDef~\\
\cellcolor{gray} &  & \verb~137~ & & \verb~~\\
\cellcolor{gray} &  & \verb~138~ & & \verb~            if (entityToUpdate == null) throw CreateEntityNotFoundException<Ar~\\
\cellcolor{gray} &  & \verb~139~ & & \verb~~\\
\cellcolor{gray} &  & \verb~140~ & & \verb~            Context.Entry(entityToUpdate).CurrentValues.SetValues(entity);~\\
\cellcolor{gray} &  & \verb~141~ & & \verb~~\\
\cellcolor{gray} &  & \verb~142~ & & \verb~            MarkIgnoreFields(entityToUpdate);~\\
\cellcolor{gray} &  & \verb~143~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~144~ & & \verb~~\\
\cellcolor{gray} &  & \verb~145~ & & \verb~        public virtual void Update(Delta<T> delta, params object[] ids)~\\
\cellcolor{gray} &  & \verb~146~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~147~ & & \verb~            var entityToUpdate = Context.Set<T>().Find(ids);~\\
\cellcolor{gray} &  & \verb~148~ & & \verb~~\\
\cellcolor{gray} &  & \verb~149~ & & \verb~            if (entityToUpdate == null) throw CreateEntityNotFoundException<Ar~\\
\cellcolor{gray} &  & \verb~150~ & & \verb~~\\
\cellcolor{gray} &  & \verb~151~ & & \verb~            foreach (string field in delta.UpdatedFields())~\\
\cellcolor{gray} &  & \verb~152~ & & \verb~            {~\\
\cellcolor{gray} &  & \verb~153~ & & \verb~                var fieldToSet = typeof(T).GetProperty(field);~\\
\cellcolor{gray} &  & \verb~154~ & & \verb~                var dataOrigion = delta.Internal.GetType().GetProperty(field);~\\
\cellcolor{gray} &  & \verb~155~ & & \verb~~\\
\cellcolor{gray} &  & \verb~156~ & & \verb~                fieldToSet.SetValue(entityToUpdate, dataOrigion.GetValue(delta~\\
\cellcolor{gray} &  & \verb~157~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~158~ & & \verb~~\\
\cellcolor{gray} &  & \verb~159~ & & \verb~            MarkIgnoreFields(entityToUpdate);~\\
\cellcolor{gray} &  & \verb~160~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~161~ & & \verb~~\\
\cellcolor{gray} &  & \verb~162~ & & \verb~        public void Update(Delta<T> delta, Expression<Func<T, bool>> predicate~\\
\cellcolor{gray} &  & \verb~163~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~164~ & & \verb~            var entityToUpdate = Context.Set<T>().Where(predicate).SingleOrDef~\\
\cellcolor{gray} &  & \verb~165~ & & \verb~~\\
\cellcolor{gray} &  & \verb~166~ & & \verb~            if (entityToUpdate == null) throw CreateEntityNotFoundException<Ar~\\
\cellcolor{gray} &  & \verb~167~ & & \verb~~\\
\cellcolor{gray} &  & \verb~168~ & & \verb~            foreach (string field in delta.UpdatedFields())~\\
\cellcolor{gray} &  & \verb~169~ & & \verb~            {~\\
\cellcolor{gray} &  & \verb~170~ & & \verb~                var fieldToSet = typeof(T).GetProperty(field);~\\
\cellcolor{gray} &  & \verb~171~ & & \verb~                var dataOrigion = delta.Internal.GetType().GetProperty(field);~\\
\cellcolor{gray} &  & \verb~172~ & & \verb~~\\
\cellcolor{gray} &  & \verb~173~ & & \verb~                fieldToSet.SetValue(entityToUpdate, dataOrigion.GetValue(delta~\\
\cellcolor{gray} &  & \verb~174~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~175~ & & \verb~~\\
\cellcolor{gray} &  & \verb~176~ & & \verb~            MarkIgnoreFields(entityToUpdate);~\\
\cellcolor{gray} &  & \verb~177~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~178~ & & \verb~~\\
\cellcolor{gray} &  & \verb~179~ & & \verb~        protected virtual E CreateEntityNotFoundException<E>(string entityId, ~\\
\cellcolor{gray} &  & \verb~180~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~181~ & & \verb~            return (E)Activator.CreateInstance(typeof(E), string.Format("{0} i~\\
\cellcolor{gray} &  & \verb~182~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~183~ & & \verb~~\\
\cellcolor{gray} &  & \verb~184~ & & \verb~        protected virtual void MarkIgnoreFields(T entityToUpdate)~\\
\cellcolor{gray} &  & \verb~185~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~186~ & & \verb~            if(IgnoreFieldsOnUpdate.IsValueCreated)~\\
\cellcolor{green} & 1 & \verb~187~ & & \verb~            { IgnoreFieldsOnUpdate.Value.ForEach(ignoreField => Context.Entry(~\\
\cellcolor{gray} &  & \verb~188~ & & \verb~~\\
\cellcolor{gray} &  & \verb~189~ & & \verb~~\\
\cellcolor{gray} &  & \verb~190~ & & \verb~            if(IgnoreFieldsOnUpdate2.IsValueCreated)~\\
\cellcolor{red} & 0 & \verb~191~ & & \verb~            { IgnoreFieldsOnUpdate2.Value.ForEach(ignoreField => Context.Entry~\\
\cellcolor{gray} &  & \verb~192~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~193~ & & \verb~~\\
\cellcolor{gray} &  & \verb~194~ & & \verb~        public async virtual Task<int> SaveAsync()~\\
\cellcolor{red} & 0 & \verb~195~ & & \verb~        {~\\
\cellcolor{red} & 0 & \verb~196~ & & \verb~            return await Context.SaveChangesAsync();~\\
\cellcolor{red} & 0 & \verb~197~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~198~ & & \verb~~\\
\cellcolor{gray} &  & \verb~199~ & & \verb~        public virtual int Save()~\\
\cellcolor{gray} &  & \verb~200~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~201~ & & \verb~            return Context.SaveChanges();~\\
\cellcolor{gray} &  & \verb~202~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~203~ & & \verb~~\\
\cellcolor{gray} &  & \verb~204~ & & \verb~        public virtual int Count()~\\
\cellcolor{gray} &  & \verb~205~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~206~ & & \verb~            return Context.Set<T>().Count();~\\
\cellcolor{gray} &  & \verb~207~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~208~ & & \verb~~\\
\cellcolor{gray} &  & \verb~209~ & & \verb~        public async virtual Task<int> CountAsync()~\\
\cellcolor{red} & 0 & \verb~210~ & & \verb~        {~\\
\cellcolor{red} & 0 & \verb~211~ & & \verb~            return await Context.Set<T>().CountAsync();~\\
\cellcolor{red} & 0 & \verb~212~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~213~ & & \verb~~\\
\cellcolor{gray} &  & \verb~214~ & & \verb~        #region IDisposable Support~\\
\cellcolor{gray} &  & \verb~215~ & & \verb~        private bool disposedValue = false; // To detect redundant calls~\\
\cellcolor{gray} &  & \verb~216~ & & \verb~~\\
\cellcolor{gray} &  & \verb~217~ & & \verb~        protected virtual void Dispose(bool disposing)~\\
\cellcolor{gray} &  & \verb~218~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~219~ & & \verb~            if (!disposedValue)~\\
\cellcolor{gray} &  & \verb~220~ & & \verb~            {~\\
\cellcolor{gray} &  & \verb~221~ & & \verb~                if (disposing)~\\
\cellcolor{gray} &  & \verb~222~ & & \verb~                {~\\
\cellcolor{gray} &  & \verb~223~ & & \verb~                    if (Context != null)~\\
\cellcolor{gray} &  & \verb~224~ & & \verb~                    {~\\
\cellcolor{gray} &  & \verb~225~ & & \verb~                        Context.Dispose();~\\
\cellcolor{gray} &  & \verb~226~ & & \verb~                        Context = null;~\\
\cellcolor{gray} &  & \verb~227~ & & \verb~                    }~\\
\cellcolor{gray} &  & \verb~228~ & & \verb~                }~\\
\cellcolor{gray} &  & \verb~229~ & & \verb~~\\
\cellcolor{gray} &  & \verb~230~ & & \verb~                disposedValue = true;~\\
\cellcolor{gray} &  & \verb~231~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~232~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~233~ & & \verb~~\\
\cellcolor{gray} &  & \verb~234~ & & \verb~        public void Dispose()~\\
\cellcolor{gray} &  & \verb~235~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~236~ & & \verb~            Dispose(true);~\\
\cellcolor{gray} &  & \verb~237~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~238~ & & \verb~        #endregion~\\
\cellcolor{gray} &  & \verb~239~ & & \verb~~\\
\cellcolor{gray} &  & \verb~240~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~241~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Repository6.BaseRepository<C, T>}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Repository6.BaseRepository<C, T>\\
\textbf{Assembly:} & entityframework.auditable.repository6.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{opment\textbackslash EntityFrameworkRepository6\textbackslash EntityFrameworkRepository6\textbackslash BaseRepository.cs}\end{minipage} \\
\textbf{Covered lines:} & 119\\
\textbf{Uncovered lines:} & 4\\
\textbf{Coverable lines:} & 123\\
\textbf{Total lines:} & 241\\
\textbf{Line coverage:} & 96.7\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{BaseRepository(C)} & 5 & 0\\
\hline
\textbf{AddUpdateIgnoreField} & 3 & 0\\
\hline
\textbf{AddUpdateIgnoreField} & 0 & 3\\
\hline
\textbf{Find(int)} & 5 & 0\\
\hline
\textbf{Find(object[])} & 5 & 0\\
\hline
\textbf{FindBy(System.Linq.E} & 5 & 0\\
\hline
\textbf{Exists(System.Linq.E} & 6 & 0\\
\hline
\textbf{Delete(T)} & 4 & 0\\
\hline
\textbf{Delete(System.Collec} & 9 & 0\\
\hline
\textbf{Reload(T)} & 4 & 0\\
\hline
\textbf{FindByReadOnly(Syste} & 6 & 0\\
\hline
\textbf{GetAll()} & 5 & 0\\
\hline
\textbf{Add(T)} & 5 & 0\\
\hline
\textbf{Add(System.Collectio} & 5 & 0\\
\hline
\textbf{Update(T, int)} & 10 & 5\\
\hline
\textbf{Update(T, System.Lin} & 16 & 0\\
\hline
\textbf{Update(EntityFramewo} & 27 & 0\\
\hline
\textbf{Update(EntityFramewo} & 28 & 0\\
\hline
\textbf{CreateEntityNotFound} & 5 & 0\\
\hline
\textbf{MarkIgnoreFields(T)} & 9 & 4\\
\hline
\textbf{Save()} & 4 & 0\\
\hline
\textbf{Count()} & 5 & 0\\
\hline
\textbf{Dispose(bool)} & 11 & 0\\
\hline
\textbf{Dispose()} & 2 & 0\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{opment\textbackslash EntityFrameworkRepository6\textbackslash EntityFrameworkRepository6\textbackslash BaseRepository.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using EntityFramework.Repository6.Interfaces;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using System.Data.Entity;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Linq.Expressions;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~namespace EntityFramework.Repository6~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~    public abstract class BaseRepository<C, T> :~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~            IBaseRepository<C, T>~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~            , IDisposable~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~        where T : class~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~        where C : DbContext~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~17~ & & \verb~        protected C Context { get; set; }~\\
\cellcolor{green} & 1 & \verb~18~ & & \verb~        protected Lazy<List<string>> IgnoreFieldsOnUpdate = new Lazy<List<stri~\\
\cellcolor{green} & 1 & \verb~19~ & & \verb~        protected Lazy<List<Expression<Func<T, bool>>>> IgnoreFieldsOnUpdate2 ~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~21~ & & \verb~        protected BaseRepository(C context)~\\
\cellcolor{green} & 1 & \verb~22~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~23~ & & \verb~            Context = context;~\\
\cellcolor{green} & 1 & \verb~24~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~25~ & & \verb~~\\
\cellcolor{gray} &  & \verb~26~ & & \verb~        public virtual void AddUpdateIgnoreField(string fieldName)~\\
\cellcolor{green} & 1 & \verb~27~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~28~ & & \verb~            IgnoreFieldsOnUpdate.Value.Add(fieldName);~\\
\cellcolor{green} & 1 & \verb~29~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~~\\
\cellcolor{gray} &  & \verb~31~ & & \verb~        public virtual void AddUpdateIgnoreField(Expression<Func<T, bool>> fie~\\
\cellcolor{red} & 0 & \verb~32~ & & \verb~        {~\\
\cellcolor{red} & 0 & \verb~33~ & & \verb~            IgnoreFieldsOnUpdate2.Value.Add(fieldName);~\\
\cellcolor{red} & 0 & \verb~34~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~35~ & & \verb~~\\
\cellcolor{gray} &  & \verb~36~ & & \verb~        public virtual T Find(int id)~\\
\cellcolor{green} & 1 & \verb~37~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~38~ & & \verb~            T entity = Context.Set<T>().Find(id);~\\
\cellcolor{gray} &  & \verb~39~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~40~ & & \verb~            return entity;~\\
\cellcolor{green} & 1 & \verb~41~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~42~ & & \verb~~\\
\cellcolor{gray} &  & \verb~43~ & & \verb~        public virtual T Find(params object[] ids)~\\
\cellcolor{green} & 1 & \verb~44~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~45~ & & \verb~            T entity = Context.Set<T>().Find(ids);~\\
\cellcolor{gray} &  & \verb~46~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~47~ & & \verb~            return entity;~\\
\cellcolor{green} & 1 & \verb~48~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~49~ & & \verb~~\\
\cellcolor{gray} &  & \verb~50~ & & \verb~        public virtual async Task<T> FindAsync(int id)~\\
\cellcolor{gray} &  & \verb~51~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~52~ & & \verb~            var query = Context.Set<T>().FindAsync(id);~\\
\cellcolor{gray} &  & \verb~53~ & & \verb~            return await query;~\\
\cellcolor{gray} &  & \verb~54~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~55~ & & \verb~~\\
\cellcolor{gray} &  & \verb~56~ & & \verb~        public virtual async Task<T> FindAsync(params object[] ids)~\\
\cellcolor{gray} &  & \verb~57~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~58~ & & \verb~            var query = Context.Set<T>().FindAsync(ids);~\\
\cellcolor{gray} &  & \verb~59~ & & \verb~            return await query;~\\
\cellcolor{gray} &  & \verb~60~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~61~ & & \verb~~\\
\cellcolor{gray} &  & \verb~62~ & & \verb~        public virtual IQueryable<T> FindBy(Expression<Func<T, bool>> predicat~\\
\cellcolor{green} & 1 & \verb~63~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~64~ & & \verb~            IQueryable<T> query = Context.Set<T>().Where(predicate);~\\
\cellcolor{green} & 1 & \verb~65~ & & \verb~            return query;~\\
\cellcolor{green} & 1 & \verb~66~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~67~ & & \verb~~\\
\cellcolor{gray} &  & \verb~68~ & & \verb~        public virtual bool Exists(Expression<Func<T, bool>> predicate)~\\
\cellcolor{green} & 1 & \verb~69~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~70~ & & \verb~            return Context.Set<T>().AsNoTracking().Any(predicate);~\\
\cellcolor{green} & 1 & \verb~71~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~72~ & & \verb~~\\
\cellcolor{gray} &  & \verb~73~ & & \verb~        public virtual void Delete(T entity)~\\
\cellcolor{green} & 1 & \verb~74~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~75~ & & \verb~            Context.Set<T>().Remove(entity);~\\
\cellcolor{green} & 1 & \verb~76~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~77~ & & \verb~~\\
\cellcolor{gray} &  & \verb~78~ & & \verb~        public virtual void Delete(IEnumerable<T> entities)~\\
\cellcolor{green} & 1 & \verb~79~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~80~ & & \verb~            foreach (T entity in entities)~\\
\cellcolor{green} & 1 & \verb~81~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~82~ & & \verb~                Delete(entity);~\\
\cellcolor{green} & 1 & \verb~83~ & & \verb~            }~\\
\cellcolor{green} & 1 & \verb~84~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~85~ & & \verb~~\\
\cellcolor{gray} &  & \verb~86~ & & \verb~        public virtual void Reload(T entity)~\\
\cellcolor{green} & 1 & \verb~87~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~88~ & & \verb~            Context.Entry<T>(entity).Reload();~\\
\cellcolor{green} & 1 & \verb~89~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~90~ & & \verb~~\\
\cellcolor{gray} &  & \verb~91~ & & \verb~        public async virtual Task ReloadAsync(T entity)~\\
\cellcolor{gray} &  & \verb~92~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~93~ & & \verb~            await Context.Entry<T>(entity).ReloadAsync();~\\
\cellcolor{gray} &  & \verb~94~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~95~ & & \verb~~\\
\cellcolor{gray} &  & \verb~96~ & & \verb~        public virtual IQueryable<T> FindByReadOnly(Expression<Func<T, bool>> ~\\
\cellcolor{green} & 1 & \verb~97~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~98~ & & \verb~            IQueryable<T> query = Context.Set<T>().AsNoTracking().Where(predic~\\
\cellcolor{green} & 1 & \verb~99~ & & \verb~            return query;~\\
\cellcolor{green} & 1 & \verb~100~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~101~ & & \verb~~\\
\cellcolor{gray} &  & \verb~102~ & & \verb~        public virtual IQueryable<T> GetAll()~\\
\cellcolor{green} & 1 & \verb~103~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~104~ & & \verb~            IQueryable<T> query = Context.Set<T>().AsNoTracking();~\\
\cellcolor{gray} &  & \verb~105~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~106~ & & \verb~            return query;~\\
\cellcolor{green} & 1 & \verb~107~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~108~ & & \verb~~\\
\cellcolor{gray} &  & \verb~109~ & & \verb~        public virtual T Add(T entity)~\\
\cellcolor{green} & 1 & \verb~110~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~111~ & & \verb~            Context.Set<T>().Add(entity);~\\
\cellcolor{gray} &  & \verb~112~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~113~ & & \verb~            return entity;~\\
\cellcolor{green} & 1 & \verb~114~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~115~ & & \verb~~\\
\cellcolor{gray} &  & \verb~116~ & & \verb~        public virtual IEnumerable<T> Add(IEnumerable<T> entities)~\\
\cellcolor{green} & 1 & \verb~117~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~118~ & & \verb~            Context.Set<T>().AddRange(entities);~\\
\cellcolor{gray} &  & \verb~119~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~120~ & & \verb~            return entities;~\\
\cellcolor{green} & 1 & \verb~121~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~122~ & & \verb~~\\
\cellcolor{gray} &  & \verb~123~ & & \verb~        public virtual void Update(T entity, int id)~\\
\cellcolor{green} & 1 & \verb~124~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~125~ & & \verb~            var entityToUpdate = Context.Set<T>().Find(id);~\\
\cellcolor{gray} &  & \verb~126~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~127~ & & \verb~            if (entityToUpdate == null) throw CreateEntityNotFoundException<Ar~\\
\cellcolor{gray} &  & \verb~128~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~129~ & & \verb~            Context.Entry(entityToUpdate).CurrentValues.SetValues(entity);~\\
\cellcolor{gray} &  & \verb~130~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~131~ & & \verb~            MarkIgnoreFields(entityToUpdate);~\\
\cellcolor{green} & 1 & \verb~132~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~133~ & & \verb~~\\
\cellcolor{gray} &  & \verb~134~ & & \verb~        public virtual void Update(T entity, Expression<Func<T, bool>> predica~\\
\cellcolor{green} & 1 & \verb~135~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~136~ & & \verb~            var entityToUpdate = Context.Set<T>().Where(predicate).SingleOrDef~\\
\cellcolor{gray} &  & \verb~137~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~138~ & & \verb~            if (entityToUpdate == null) throw CreateEntityNotFoundException<Ar~\\
\cellcolor{gray} &  & \verb~139~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~140~ & & \verb~            Context.Entry(entityToUpdate).CurrentValues.SetValues(entity);~\\
\cellcolor{gray} &  & \verb~141~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~142~ & & \verb~            MarkIgnoreFields(entityToUpdate);~\\
\cellcolor{green} & 1 & \verb~143~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~144~ & & \verb~~\\
\cellcolor{gray} &  & \verb~145~ & & \verb~        public virtual void Update(Delta<T> delta, params object[] ids)~\\
\cellcolor{green} & 1 & \verb~146~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~147~ & & \verb~            var entityToUpdate = Context.Set<T>().Find(ids);~\\
\cellcolor{gray} &  & \verb~148~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~149~ & & \verb~            if (entityToUpdate == null) throw CreateEntityNotFoundException<Ar~\\
\cellcolor{gray} &  & \verb~150~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~151~ & & \verb~            foreach (string field in delta.UpdatedFields())~\\
\cellcolor{green} & 1 & \verb~152~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~153~ & & \verb~                var fieldToSet = typeof(T).GetProperty(field);~\\
\cellcolor{green} & 1 & \verb~154~ & & \verb~                var dataOrigion = delta.Internal.GetType().GetProperty(field);~\\
\cellcolor{gray} &  & \verb~155~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~156~ & & \verb~                fieldToSet.SetValue(entityToUpdate, dataOrigion.GetValue(delta~\\
\cellcolor{green} & 1 & \verb~157~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~158~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~159~ & & \verb~            MarkIgnoreFields(entityToUpdate);~\\
\cellcolor{green} & 1 & \verb~160~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~161~ & & \verb~~\\
\cellcolor{gray} &  & \verb~162~ & & \verb~        public void Update(Delta<T> delta, Expression<Func<T, bool>> predicate~\\
\cellcolor{green} & 1 & \verb~163~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~164~ & & \verb~            var entityToUpdate = Context.Set<T>().Where(predicate).SingleOrDef~\\
\cellcolor{gray} &  & \verb~165~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~166~ & & \verb~            if (entityToUpdate == null) throw CreateEntityNotFoundException<Ar~\\
\cellcolor{gray} &  & \verb~167~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~168~ & & \verb~            foreach (string field in delta.UpdatedFields())~\\
\cellcolor{green} & 1 & \verb~169~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~170~ & & \verb~                var fieldToSet = typeof(T).GetProperty(field);~\\
\cellcolor{green} & 1 & \verb~171~ & & \verb~                var dataOrigion = delta.Internal.GetType().GetProperty(field);~\\
\cellcolor{gray} &  & \verb~172~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~173~ & & \verb~                fieldToSet.SetValue(entityToUpdate, dataOrigion.GetValue(delta~\\
\cellcolor{green} & 1 & \verb~174~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~175~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~176~ & & \verb~            MarkIgnoreFields(entityToUpdate);~\\
\cellcolor{green} & 1 & \verb~177~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~178~ & & \verb~~\\
\cellcolor{gray} &  & \verb~179~ & & \verb~        protected virtual E CreateEntityNotFoundException<E>(string entityId, ~\\
\cellcolor{green} & 1 & \verb~180~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~181~ & & \verb~            return (E)Activator.CreateInstance(typeof(E), string.Format("{0} i~\\
\cellcolor{green} & 1 & \verb~182~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~183~ & & \verb~~\\
\cellcolor{gray} &  & \verb~184~ & & \verb~        protected virtual void MarkIgnoreFields(T entityToUpdate)~\\
\cellcolor{green} & 1 & \verb~185~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~186~ & & \verb~            if(IgnoreFieldsOnUpdate.IsValueCreated)~\\
\cellcolor{green} & 1 & \verb~187~ & & \verb~            { IgnoreFieldsOnUpdate.Value.ForEach(ignoreField => Context.Entry(~\\
\cellcolor{gray} &  & \verb~188~ & & \verb~~\\
\cellcolor{gray} &  & \verb~189~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~190~ & & \verb~            if(IgnoreFieldsOnUpdate2.IsValueCreated)~\\
\cellcolor{red} & 0 & \verb~191~ & & \verb~            { IgnoreFieldsOnUpdate2.Value.ForEach(ignoreField => Context.Entry~\\
\cellcolor{green} & 1 & \verb~192~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~193~ & & \verb~~\\
\cellcolor{gray} &  & \verb~194~ & & \verb~        public async virtual Task<int> SaveAsync()~\\
\cellcolor{gray} &  & \verb~195~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~196~ & & \verb~            return await Context.SaveChangesAsync();~\\
\cellcolor{gray} &  & \verb~197~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~198~ & & \verb~~\\
\cellcolor{gray} &  & \verb~199~ & & \verb~        public virtual int Save()~\\
\cellcolor{green} & 1 & \verb~200~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~201~ & & \verb~            return Context.SaveChanges();~\\
\cellcolor{green} & 1 & \verb~202~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~203~ & & \verb~~\\
\cellcolor{gray} &  & \verb~204~ & & \verb~        public virtual int Count()~\\
\cellcolor{green} & 1 & \verb~205~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~206~ & & \verb~            return Context.Set<T>().Count();~\\
\cellcolor{green} & 1 & \verb~207~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~208~ & & \verb~~\\
\cellcolor{gray} &  & \verb~209~ & & \verb~        public async virtual Task<int> CountAsync()~\\
\cellcolor{gray} &  & \verb~210~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~211~ & & \verb~            return await Context.Set<T>().CountAsync();~\\
\cellcolor{gray} &  & \verb~212~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~213~ & & \verb~~\\
\cellcolor{gray} &  & \verb~214~ & & \verb~        #region IDisposable Support~\\
\cellcolor{green} & 1 & \verb~215~ & & \verb~        private bool disposedValue = false; // To detect redundant calls~\\
\cellcolor{gray} &  & \verb~216~ & & \verb~~\\
\cellcolor{gray} &  & \verb~217~ & & \verb~        protected virtual void Dispose(bool disposing)~\\
\cellcolor{green} & 1 & \verb~218~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~219~ & & \verb~            if (!disposedValue)~\\
\cellcolor{green} & 1 & \verb~220~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~221~ & & \verb~                if (disposing)~\\
\cellcolor{green} & 1 & \verb~222~ & & \verb~                {~\\
\cellcolor{green} & 1 & \verb~223~ & & \verb~                    if (Context != null)~\\
\cellcolor{green} & 1 & \verb~224~ & & \verb~                    {~\\
\cellcolor{green} & 1 & \verb~225~ & & \verb~                        Context.Dispose();~\\
\cellcolor{green} & 1 & \verb~226~ & & \verb~                        Context = null;~\\
\cellcolor{green} & 1 & \verb~227~ & & \verb~                    }~\\
\cellcolor{green} & 1 & \verb~228~ & & \verb~                }~\\
\cellcolor{gray} &  & \verb~229~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~230~ & & \verb~                disposedValue = true;~\\
\cellcolor{green} & 1 & \verb~231~ & & \verb~            }~\\
\cellcolor{green} & 1 & \verb~232~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~233~ & & \verb~~\\
\cellcolor{gray} &  & \verb~234~ & & \verb~        public void Dispose()~\\
\cellcolor{green} & 1 & \verb~235~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~236~ & & \verb~            Dispose(true);~\\
\cellcolor{green} & 1 & \verb~237~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~238~ & & \verb~        #endregion~\\
\cellcolor{gray} &  & \verb~239~ & & \verb~~\\
\cellcolor{gray} &  & \verb~240~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~241~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Repository6.DatabaseFactory<C>}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Repository6.DatabaseFactory<C>\\
\textbf{Assembly:} & entityframework.auditable.repository6.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{pment\textbackslash EntityFrameworkRepository6\textbackslash EntityFrameworkRepository6\textbackslash DatabaseFactory.cs}\end{minipage} \\
\textbf{Covered lines:} & 0\\
\textbf{Uncovered lines:} & 11\\
\textbf{Coverable lines:} & 11\\
\textbf{Total lines:} & 33\\
\textbf{Line coverage:} & 0\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{DatabaseFactory(stri} & 0 & 3\\
\hline
\textbf{GetNewDbContext()} & 0 & 11\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{pment\textbackslash EntityFrameworkRepository6\textbackslash EntityFrameworkRepository6\textbackslash DatabaseFactory.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using System.Data.Entity;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~namespace EntityFramework.Repository6~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~    public interface IDatabaseFactory<C>~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~        C GetNewDbContext();~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~        Action<string> Logging { get; set; }~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~    public class DatabaseFactory<C> : IDatabaseFactory<C>~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~        where C : DbContext~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~    {~\\
\cellcolor{red} & 0 & \verb~15~ & & \verb~        public Action<string> Logging { get; set; }~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~17~ & & \verb~        protected string dbConnectionString { get; set; }~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~19~ & & \verb~        public DatabaseFactory(string connectionString)~\\
\cellcolor{red} & 0 & \verb~20~ & & \verb~        {~\\
\cellcolor{red} & 0 & \verb~21~ & & \verb~            dbConnectionString = connectionString;~\\
\cellcolor{red} & 0 & \verb~22~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~        public virtual C GetNewDbContext()~\\
\cellcolor{red} & 0 & \verb~25~ & & \verb~        {~\\
\cellcolor{red} & 0 & \verb~26~ & & \verb~            var newContext = (C)Activator.CreateInstance(typeof(C), dbConnecti~\\
\cellcolor{gray} &  & \verb~27~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~28~ & & \verb~            if (Logging != null) { newContext.Database.Log = Logging; }~\\
\cellcolor{gray} &  & \verb~29~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~30~ & & \verb~            return newContext;~\\
\cellcolor{red} & 0 & \verb~31~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~32~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~33~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Repository6.Delta<T>}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Repository6.Delta<T>\\
\textbf{Assembly:} & entityframework.auditable.repository6.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{velopment\textbackslash EntityFrameworkRepository6\textbackslash EntityFramework.SharedRepository\textbackslash Delta.cs}\end{minipage} \\
\textbf{Covered lines:} & 23\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 23\\
\textbf{Total lines:} & 43\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{UpdatedFields()} & 3 & 0\\
\hline
\textbf{Delta()} & 7 & 0\\
\hline
\textbf{SetValue(string, obj} & 14 & 0\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{velopment\textbackslash EntityFrameworkRepository6\textbackslash EntityFramework.SharedRepository\textbackslash Delta.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using System.Text;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~namespace EntityFramework.Repository6~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~    public class Delta<T> where T : class~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~11~ & & \verb~        List<string> Fields { get; set; }~\\
\cellcolor{green} & 1 & \verb~12~ & & \verb~        public T Internal { get; set; }~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~        public List<string> UpdatedFields()~\\
\cellcolor{green} & 1 & \verb~15~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~16~ & & \verb~            return Fields;~\\
\cellcolor{green} & 1 & \verb~17~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~19~ & & \verb~        public Delta()~\\
\cellcolor{green} & 1 & \verb~20~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~21~ & & \verb~            Internal = (T)Activator.CreateInstance(typeof(T));~\\
\cellcolor{green} & 1 & \verb~22~ & & \verb~            Fields = new List<string>();~\\
\cellcolor{green} & 1 & \verb~23~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~~\\
\cellcolor{gray} &  & \verb~25~ & & \verb~        public void SetValue(string fieldName, object data)~\\
\cellcolor{green} & 1 & \verb~26~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~27~ & & \verb~            var prop1 = typeof(T).GetProperty(fieldName);~\\
\cellcolor{green} & 1 & \verb~28~ & & \verb~            if (prop1 == null)~\\
\cellcolor{green} & 1 & \verb~29~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~30~ & & \verb~                throw new ArgumentException($"{fieldName} was not a property f~\\
\cellcolor{gray} &  & \verb~31~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~32~ & & \verb~            try~\\
\cellcolor{green} & 1 & \verb~33~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~34~ & & \verb~                prop1.SetValue(Internal, data);~\\
\cellcolor{green} & 1 & \verb~35~ & & \verb~                Fields.Add(fieldName);~\\
\cellcolor{green} & 1 & \verb~36~ & & \verb~            }~\\
\cellcolor{green} & 1 & \verb~37~ & & \verb~            catch (ArgumentException ex)~\\
\cellcolor{green} & 1 & \verb~38~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~39~ & & \verb~                throw ex;~\\
\cellcolor{gray} &  & \verb~40~ & & \verb~            }~\\
\cellcolor{green} & 1 & \verb~41~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~42~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~43~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Auditable.Repository6.Tests.RepositoryCreateTests}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Auditable.Repository6.Tests.RepositoryCreateTests\\
\textbf{Assembly:} & entityframework.auditable.repository6.tests.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{kRepository6\textbackslash EntityFrameworkAuditableRepository6Tests\textbackslash RepositoryCreateTests.cs}\end{minipage} \\
\textbf{Covered lines:} & 80\\
\textbf{Uncovered lines:} & 1\\
\textbf{Coverable lines:} & 81\\
\textbf{Total lines:} & 168\\
\textbf{Line coverage:} & 98.7\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{Setup()} & 18 & 0\\
\hline
\textbf{InsertTestMethodAudi} & 14 & 0\\
\hline
\textbf{InsertTestMethod2Aud} & 14 & 0\\
\hline
\textbf{InsertTestMethod3Aud} & 14 & 0\\
\hline
\textbf{InsertMultipleTestAu} & 20 & 0\\
\hline
\textbf{InsertIntoCompositeK} & 24 & 0\\
\hline
\textbf{InsertDuplicateIntoC} & 17 & 1\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{kRepository6\textbackslash EntityFrameworkAuditableRepository6Tests\textbackslash RepositoryCreateTests.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using Microsoft.VisualStudio.TestTools.UnitTesting;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System.Diagnostics;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using Microsoft.Practices.Unity;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using PersistentLayer.Auditable.Repositories;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using PersistentLayer.Auditable.Entities;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~using System.Data.Entity.Infrastructure;~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~using EntityFramework.Auditing;~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~using EntityFramework.Repository6;~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~namespace EntityFramework.Auditable.Repository6.Tests~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    [TestClass]~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    public class RepositoryCreateTests~\\
\cellcolor{gray} &  & \verb~17~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~18~ & & \verb~        UnityContainer LocalIoCContainer { get; set; }~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~        [TestInitialize]~\\
\cellcolor{gray} &  & \verb~21~ & & \verb~        public void Setup()~\\
\cellcolor{green} & 1 & \verb~22~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~23~ & & \verb~            Action<string> logSetup = message => Debug.WriteLine(message);~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~25~ & & \verb~            LocalIoCContainer = new UnityContainer();~\\
\cellcolor{green} & 1 & \verb~26~ & & \verb~            LocalIoCContainer.RegisterType<ISimpleDataEntityRepository, Simple~\\
\cellcolor{green} & 1 & \verb~27~ & & \verb~            LocalIoCContainer.RegisterType<ISimpleCompositeKeyEntityRepository~\\
\cellcolor{gray} &  & \verb~28~ & & \verb~~\\
\cellcolor{gray} &  & \verb~29~ & & \verb~            //AuditDbContext.RegisterAuditType(typeof(SimpleDataEntity), typeo~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~~\\
\cellcolor{gray} &  & \verb~31~ & & \verb~            //Use a physical database file~\\
\cellcolor{gray} &  & \verb~32~ & & \verb~            //var connectionString = @"Data Source = (LocalDb)\MSSQLLocalDB; D~\\
\cellcolor{gray} &  & \verb~33~ & & \verb~            //or~\\
\cellcolor{gray} &  & \verb~34~ & & \verb~            //var connectionString = @"TestDatabase";~\\
\cellcolor{gray} &  & \verb~35~ & & \verb~            //LocalIoCContainer.RegisterType(typeof(IDatabaseFactory<>), typeo~\\
\cellcolor{gray} &  & \verb~36~ & & \verb~            //    , new HierarchicalLifetimeManager()~\\
\cellcolor{gray} &  & \verb~37~ & & \verb~            //    , new InjectionConstructor(connectionString)~\\
\cellcolor{gray} &  & \verb~38~ & & \verb~            //    , new InjectionProperty("Logging", logSetup));~\\
\cellcolor{gray} &  & \verb~39~ & & \verb~~\\
\cellcolor{gray} &  & \verb~40~ & & \verb~            //Use an nmemory database~\\
\cellcolor{green} & 1 & \verb~41~ & & \verb~            LocalIoCContainer.RegisterType(typeof(IDatabaseFactory<>), typeof(~\\
\cellcolor{green} & 1 & \verb~42~ & & \verb~                , new HierarchicalLifetimeManager()~\\
\cellcolor{green} & 1 & \verb~43~ & & \verb~                , new InjectionProperty("Logging", logSetup));~\\
\cellcolor{green} & 1 & \verb~44~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~45~ & & \verb~~\\
\cellcolor{gray} &  & \verb~46~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~47~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~48~ & & \verb~        public void InsertTestMethodAudit()~\\
\cellcolor{green} & 1 & \verb~49~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~50~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{green} & 1 & \verb~51~ & & \verb~            var newItem = new SimpleDataEntity { Name = "My Test" };~\\
\cellcolor{green} & 1 & \verb~52~ & & \verb~            var actual = repository.Add(newItem);~\\
\cellcolor{green} & 1 & \verb~53~ & & \verb~            var result = repository.Save();~\\
\cellcolor{gray} &  & \verb~54~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~55~ & & \verb~            Assert.AreNotEqual(0, actual.Id);~\\
\cellcolor{gray} &  & \verb~56~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~57~ & & \verb~            var actual2 = repository.Find(actual.Id);~\\
\cellcolor{gray} &  & \verb~58~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~59~ & & \verb~            Assert.AreEqual("My Test", actual2.Name);~\\
\cellcolor{gray} &  & \verb~60~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~61~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~62~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~63~ & & \verb~~\\
\cellcolor{gray} &  & \verb~64~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~65~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~66~ & & \verb~        public void InsertTestMethod2Audit()~\\
\cellcolor{green} & 1 & \verb~67~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~68~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{green} & 1 & \verb~69~ & & \verb~            var newItem = new SimpleDataEntity { Name = "My Test 200" };~\\
\cellcolor{green} & 1 & \verb~70~ & & \verb~            var actual = repository.Add(newItem);~\\
\cellcolor{green} & 1 & \verb~71~ & & \verb~            var result = repository.Save();~\\
\cellcolor{gray} &  & \verb~72~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~73~ & & \verb~            Assert.AreNotEqual(0, actual.Id);~\\
\cellcolor{gray} &  & \verb~74~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~75~ & & \verb~            var actual2 = repository.Find(actual.Id);~\\
\cellcolor{gray} &  & \verb~76~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~77~ & & \verb~            Assert.AreEqual("My Test 200", actual2.Name);~\\
\cellcolor{gray} &  & \verb~78~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~79~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~80~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~81~ & & \verb~~\\
\cellcolor{gray} &  & \verb~82~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~83~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~84~ & & \verb~        public void InsertTestMethod3Audit()~\\
\cellcolor{green} & 1 & \verb~85~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~86~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{green} & 1 & \verb~87~ & & \verb~            var newItem = new SimpleDataEntity { Name = "My Test 300" };~\\
\cellcolor{green} & 1 & \verb~88~ & & \verb~            var actual = repository.Add(newItem);~\\
\cellcolor{green} & 1 & \verb~89~ & & \verb~            var result = repository.Save();~\\
\cellcolor{gray} &  & \verb~90~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~91~ & & \verb~            Assert.AreNotEqual(0, actual.Id);~\\
\cellcolor{gray} &  & \verb~92~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~93~ & & \verb~            var actual2 = repository.Find(actual.Id);~\\
\cellcolor{gray} &  & \verb~94~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~95~ & & \verb~            Assert.AreEqual("My Test 300", actual2.Name);~\\
\cellcolor{gray} &  & \verb~96~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~97~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~98~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~99~ & & \verb~~\\
\cellcolor{gray} &  & \verb~100~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~101~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~102~ & & \verb~        public void InsertMultipleTestAudit()~\\
\cellcolor{green} & 1 & \verb~103~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~104~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~105~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~106~ & & \verb~            var actual1 = repository.Count();~\\
\cellcolor{gray} &  & \verb~107~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~108~ & & \verb~            var newItem1 = new SimpleDataEntity { Name = "Multiple Item 1" };~\\
\cellcolor{green} & 1 & \verb~109~ & & \verb~            var newItem2 = new SimpleDataEntity { Name = "Multiple Item 2" };~\\
\cellcolor{green} & 1 & \verb~110~ & & \verb~            var newItem3 = new SimpleDataEntity { Name = "Multiple Item 3" };~\\
\cellcolor{green} & 1 & \verb~111~ & & \verb~            var actual = repository.Add(new List<SimpleDataEntity>~\\
\cellcolor{green} & 1 & \verb~112~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~113~ & & \verb~                newItem1~\\
\cellcolor{green} & 1 & \verb~114~ & & \verb~                , newItem2~\\
\cellcolor{green} & 1 & \verb~115~ & & \verb~                , newItem3~\\
\cellcolor{green} & 1 & \verb~116~ & & \verb~            });~\\
\cellcolor{green} & 1 & \verb~117~ & & \verb~            var result = repository.Save();~\\
\cellcolor{gray} &  & \verb~118~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~119~ & & \verb~            var actual2 = repository.Count();~\\
\cellcolor{gray} &  & \verb~120~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~121~ & & \verb~            Assert.AreEqual(7, actual1);~\\
\cellcolor{green} & 1 & \verb~122~ & & \verb~            Assert.AreEqual(10, actual2);~\\
\cellcolor{gray} &  & \verb~123~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~124~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~125~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~126~ & & \verb~~\\
\cellcolor{gray} &  & \verb~127~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~128~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~129~ & & \verb~        public void InsertIntoCompositeKeyTableMethodAudit()~\\
\cellcolor{green} & 1 & \verb~130~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~131~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleCompositeKeyEnti~\\
\cellcolor{green} & 1 & \verb~132~ & & \verb~            var newItem = new SimpleCompositeKeyEntity { Id = 1, Name = "Compo~\\
\cellcolor{green} & 1 & \verb~133~ & & \verb~            var actual = repository.Add(newItem);~\\
\cellcolor{green} & 1 & \verb~134~ & & \verb~            var result = repository.Save();~\\
\cellcolor{gray} &  & \verb~135~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~136~ & & \verb~            Assert.AreNotEqual(0, actual.Id);~\\
\cellcolor{gray} &  & \verb~137~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~138~ & & \verb~            var actual2 = repository.Find(actual.Id, actual.Name);~\\
\cellcolor{gray} &  & \verb~139~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~140~ & & \verb~            var saveAgain = repository.Add(new SimpleCompositeKeyEntity { Id =~\\
\cellcolor{green} & 1 & \verb~141~ & & \verb~            var result2 = repository.Save();~\\
\cellcolor{gray} &  & \verb~142~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~143~ & & \verb~            Assert.AreNotEqual(actual.Id, saveAgain.Id);~\\
\cellcolor{gray} &  & \verb~144~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~145~ & & \verb~            Assert.AreEqual("Composite Test", actual2.Name);~\\
\cellcolor{gray} &  & \verb~146~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~147~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~148~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~149~ & & \verb~~\\
\cellcolor{gray} &  & \verb~150~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~151~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~152~ & & \verb~        [ExpectedException(typeof(DbUpdateException))]~\\
\cellcolor{gray} &  & \verb~153~ & & \verb~        public void InsertDuplicateIntoCompositeKeyTableMethodAudit()~\\
\cellcolor{green} & 1 & \verb~154~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~155~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleCompositeKeyEnti~\\
\cellcolor{green} & 1 & \verb~156~ & & \verb~            var newItem = new SimpleCompositeKeyEntity { Id = 1, Name = "Compo~\\
\cellcolor{green} & 1 & \verb~157~ & & \verb~            var actual = repository.Add(newItem);~\\
\cellcolor{green} & 1 & \verb~158~ & & \verb~            var result = repository.Save();~\\
\cellcolor{gray} &  & \verb~159~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~160~ & & \verb~            Assert.AreNotEqual(0, actual.Id);~\\
\cellcolor{gray} &  & \verb~161~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~162~ & & \verb~            var actual2 = repository.Find(actual.Id, actual.Name);~\\
\cellcolor{gray} &  & \verb~163~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~164~ & & \verb~            var saveAgain = repository.Add(new SimpleCompositeKeyEntity { Id =~\\
\cellcolor{green} & 1 & \verb~165~ & & \verb~            var result2 = repository.Save();~\\
\cellcolor{red} & 0 & \verb~166~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~167~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~168~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Auditable.Repository6.Tests.RepositoryDeleteTests}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Auditable.Repository6.Tests.RepositoryDeleteTests\\
\textbf{Assembly:} & entityframework.auditable.repository6.tests.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{kRepository6\textbackslash EntityFrameworkAuditableRepository6Tests\textbackslash RepositoryDeleteTests.cs}\end{minipage} \\
\textbf{Covered lines:} & 32\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 32\\
\textbf{Total lines:} & 88\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{Setup()} & 18 & 0\\
\hline
\textbf{DeleteTestMethod()} & 11 & 0\\
\hline
\textbf{DeleteMultipleTestMe} & 25 & 0\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{kRepository6\textbackslash EntityFrameworkAuditableRepository6Tests\textbackslash RepositoryDeleteTests.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using Microsoft.Practices.Unity;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using Microsoft.VisualStudio.TestTools.UnitTesting;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using PersistentLayer.Auditable.Entities;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using PersistentLayer.Auditable.Repositories;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using System.Diagnostics;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~using System.Text;~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~using EntityFramework.Repository6;~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~namespace EntityFramework.Auditable.Repository6.Tests~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    [TestClass]~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    public class RepositoryDeleteTests~\\
\cellcolor{gray} &  & \verb~17~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~18~ & & \verb~        UnityContainer LocalIoCContainer { get; set; }~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~        [TestInitialize]~\\
\cellcolor{gray} &  & \verb~21~ & & \verb~        public void Setup()~\\
\cellcolor{green} & 1 & \verb~22~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~23~ & & \verb~            Action<string> logSetup = message => Debug.WriteLine(message);~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~25~ & & \verb~            LocalIoCContainer = new UnityContainer();~\\
\cellcolor{green} & 1 & \verb~26~ & & \verb~            LocalIoCContainer.RegisterType<ISimpleDataEntityRepository, Simple~\\
\cellcolor{green} & 1 & \verb~27~ & & \verb~            LocalIoCContainer.RegisterType<ISimpleCompositeKeyEntityRepository~\\
\cellcolor{gray} &  & \verb~28~ & & \verb~~\\
\cellcolor{gray} &  & \verb~29~ & & \verb~            //Use a physical database file~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~            //var connectionString = @"Data Source = (LocalDb)\MSSQLLocalDB; D~\\
\cellcolor{gray} &  & \verb~31~ & & \verb~            //or~\\
\cellcolor{gray} &  & \verb~32~ & & \verb~            //var connectionString = @"TestDatabase";~\\
\cellcolor{gray} &  & \verb~33~ & & \verb~            //LocalIoCContainer.RegisterType(typeof(IDatabaseFactory<>), typeo~\\
\cellcolor{gray} &  & \verb~34~ & & \verb~            //    , new HierarchicalLifetimeManager()~\\
\cellcolor{gray} &  & \verb~35~ & & \verb~            //    , new InjectionConstructor(connectionString)~\\
\cellcolor{gray} &  & \verb~36~ & & \verb~            //    , new InjectionProperty("Logging", logSetup));~\\
\cellcolor{gray} &  & \verb~37~ & & \verb~~\\
\cellcolor{gray} &  & \verb~38~ & & \verb~            //Use an nmemory database~\\
\cellcolor{green} & 1 & \verb~39~ & & \verb~            LocalIoCContainer.RegisterType(typeof(IDatabaseFactory<>), typeof(~\\
\cellcolor{green} & 1 & \verb~40~ & & \verb~                , new HierarchicalLifetimeManager()~\\
\cellcolor{green} & 1 & \verb~41~ & & \verb~                , new InjectionProperty("Logging", logSetup));~\\
\cellcolor{green} & 1 & \verb~42~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~43~ & & \verb~~\\
\cellcolor{gray} &  & \verb~44~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~45~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~46~ & & \verb~        public void DeleteTestMethod()~\\
\cellcolor{green} & 1 & \verb~47~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~48~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~49~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~50~ & & \verb~            var actual1 = repository.Count();~\\
\cellcolor{gray} &  & \verb~51~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~52~ & & \verb~            var itemToDelete = repository.Find(1);~\\
\cellcolor{gray} &  & \verb~53~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~54~ & & \verb~            repository.Delete(itemToDelete);~\\
\cellcolor{gray} &  & \verb~55~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~56~ & & \verb~            repository.Save();~\\
\cellcolor{gray} &  & \verb~57~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~58~ & & \verb~            var actual2 = repository.Count();~\\
\cellcolor{gray} &  & \verb~59~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~60~ & & \verb~            Assert.AreEqual(7, actual1);~\\
\cellcolor{green} & 1 & \verb~61~ & & \verb~            Assert.AreEqual(6, actual2);~\\
\cellcolor{gray} &  & \verb~62~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~63~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~64~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~65~ & & \verb~~\\
\cellcolor{gray} &  & \verb~66~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~67~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~68~ & & \verb~        public void DeleteMultipleTestMethod()~\\
\cellcolor{green} & 1 & \verb~69~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~70~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~71~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~72~ & & \verb~            var actual1 = repository.Count();~\\
\cellcolor{gray} &  & \verb~73~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~74~ & & \verb~            var itemsToDelete = repository.FindBy(x => x.Id == 1 || x.Id == 2)~\\
\cellcolor{gray} &  & \verb~75~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~76~ & & \verb~            repository.Delete(itemsToDelete);~\\
\cellcolor{gray} &  & \verb~77~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~78~ & & \verb~            repository.Save();~\\
\cellcolor{gray} &  & \verb~79~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~80~ & & \verb~            var actual2 = repository.Count();~\\
\cellcolor{gray} &  & \verb~81~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~82~ & & \verb~            Assert.AreEqual(7, actual1);~\\
\cellcolor{green} & 1 & \verb~83~ & & \verb~            Assert.AreEqual(5, actual2);~\\
\cellcolor{gray} &  & \verb~84~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~85~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~86~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~87~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~88~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Auditable.Repository6.Tests.RepositoryReadTests}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Auditable.Repository6.Tests.RepositoryReadTests\\
\textbf{Assembly:} & entityframework.auditable.repository6.tests.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{orkRepository6\textbackslash EntityFrameworkAuditableRepository6Tests\textbackslash RepositoryReadTests.cs}\end{minipage} \\
\textbf{Covered lines:} & 78\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 78\\
\textbf{Total lines:} & 182\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{Setup()} & 18 & 0\\
\hline
\textbf{GetAllFromSimpleData} & 7 & 0\\
\hline
\textbf{CountOfSimpleDataEnt} & 6 & 0\\
\hline
\textbf{FindTestMethod1Audit} & 7 & 0\\
\hline
\textbf{SelectTestMethodAudi} & 16 & 0\\
\hline
\textbf{FindAsyncTestAudit()} & 8 & 0\\
\hline
\textbf{FindAsyncMultiplePar} & 8 & 0\\
\hline
\textbf{FindByReadOnlyTestAu} & 16 & 0\\
\hline
\textbf{ExistsTestAudit()} & 14 & 0\\
\hline
\textbf{FindAndReloadAsyncTe} & 15 & 0\\
\hline
\textbf{FindAndReloadTestAud} & 13 & 0\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{orkRepository6\textbackslash EntityFrameworkAuditableRepository6Tests\textbackslash RepositoryReadTests.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using Microsoft.VisualStudio.TestTools.UnitTesting;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System.Diagnostics;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using Microsoft.Practices.Unity;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using PersistentLayer.Auditable.Repositories;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using EntityFramework.Auditing;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~using PersistentLayer.Auditable.Entities;~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~using EntityFramework.Repository6;~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~namespace EntityFramework.Auditable.Repository6.Tests~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~    [TestClass]~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~    public class RepositoryReadTests~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~16~ & & \verb~        UnityContainer LocalIoCContainer { get; set; }~\\
\cellcolor{gray} &  & \verb~17~ & & \verb~~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~        [TestInitialize]~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~        public void Setup()~\\
\cellcolor{green} & 1 & \verb~20~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~21~ & & \verb~            Action<string> logSetup = message => Debug.WriteLine(message);~\\
\cellcolor{gray} &  & \verb~22~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~23~ & & \verb~            LocalIoCContainer = new UnityContainer();~\\
\cellcolor{green} & 1 & \verb~24~ & & \verb~            LocalIoCContainer.RegisterType<ISimpleDataEntityRepository, Simple~\\
\cellcolor{green} & 1 & \verb~25~ & & \verb~            LocalIoCContainer.RegisterType<ISimpleCompositeKeyEntityRepository~\\
\cellcolor{gray} &  & \verb~26~ & & \verb~~\\
\cellcolor{gray} &  & \verb~27~ & & \verb~            //AuditDbContext.RegisterAuditType(typeof(SimpleDataEntity), typeo~\\
\cellcolor{gray} &  & \verb~28~ & & \verb~~\\
\cellcolor{gray} &  & \verb~29~ & & \verb~            //Use a physical database file~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~            //var connectionString = @"Data Source = (LocalDb)\MSSQLLocalDB; D~\\
\cellcolor{gray} &  & \verb~31~ & & \verb~            //or~\\
\cellcolor{gray} &  & \verb~32~ & & \verb~            //var connectionString = @"TestDatabase";~\\
\cellcolor{gray} &  & \verb~33~ & & \verb~            //LocalIoCContainer.RegisterType(typeof(IDatabaseFactory<>), typeo~\\
\cellcolor{gray} &  & \verb~34~ & & \verb~            //    , new HierarchicalLifetimeManager()~\\
\cellcolor{gray} &  & \verb~35~ & & \verb~            //    , new InjectionConstructor(connectionString)~\\
\cellcolor{gray} &  & \verb~36~ & & \verb~            //    , new InjectionProperty("Logging", logSetup));~\\
\cellcolor{gray} &  & \verb~37~ & & \verb~~\\
\cellcolor{gray} &  & \verb~38~ & & \verb~            //Use an nmemory database~\\
\cellcolor{green} & 1 & \verb~39~ & & \verb~            LocalIoCContainer.RegisterType(typeof(IDatabaseFactory<>), typeof(~\\
\cellcolor{green} & 1 & \verb~40~ & & \verb~                , new HierarchicalLifetimeManager()~\\
\cellcolor{green} & 1 & \verb~41~ & & \verb~                , new InjectionProperty("Logging", logSetup));~\\
\cellcolor{green} & 1 & \verb~42~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~43~ & & \verb~~\\
\cellcolor{gray} &  & \verb~44~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~45~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~46~ & & \verb~        public void GetAllFromSimpleDataEntitiesTableAudit()~\\
\cellcolor{green} & 1 & \verb~47~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~48~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~49~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~50~ & & \verb~            var actual = repository.GetAll();~\\
\cellcolor{green} & 1 & \verb~51~ & & \verb~            Assert.AreEqual(7, actual.Count());~\\
\cellcolor{gray} &  & \verb~52~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~53~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~54~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~55~ & & \verb~~\\
\cellcolor{gray} &  & \verb~56~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~57~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~58~ & & \verb~        public void CountOfSimpleDataEntitiesTableAudit()~\\
\cellcolor{green} & 1 & \verb~59~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~60~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~61~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~62~ & & \verb~            var actual = repository.Count();~\\
\cellcolor{green} & 1 & \verb~63~ & & \verb~            Assert.AreEqual(7, actual);~\\
\cellcolor{gray} &  & \verb~64~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~65~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~66~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~67~ & & \verb~~\\
\cellcolor{gray} &  & \verb~68~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~69~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~70~ & & \verb~        public void FindTestMethod1Audit()~\\
\cellcolor{green} & 1 & \verb~71~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~72~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~73~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~74~ & & \verb~            var actual = repository.Find(1);~\\
\cellcolor{green} & 1 & \verb~75~ & & \verb~            Assert.AreEqual("Test 1", actual.Name);~\\
\cellcolor{gray} &  & \verb~76~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~77~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~78~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~79~ & & \verb~~\\
\cellcolor{gray} &  & \verb~80~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~81~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~82~ & & \verb~        public void SelectTestMethodAudit()~\\
\cellcolor{green} & 1 & \verb~83~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~84~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~85~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~86~ & & \verb~            var actual = repository.FindBy(x => x.Id == 2).FirstOrDefault();~\\
\cellcolor{green} & 1 & \verb~87~ & & \verb~            Assert.AreEqual("Test 2", actual.Name);~\\
\cellcolor{gray} &  & \verb~88~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~89~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~90~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~91~ & & \verb~~\\
\cellcolor{gray} &  & \verb~92~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~93~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~94~ & & \verb~        public void FindAsyncTestAudit()~\\
\cellcolor{green} & 1 & \verb~95~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~96~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~97~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~98~ & & \verb~            var actual = repository.FindAsync(2);~\\
\cellcolor{green} & 1 & \verb~99~ & & \verb~            Assert.AreEqual("Test 2", actual.Result.Name);~\\
\cellcolor{gray} &  & \verb~100~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~101~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~102~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~103~ & & \verb~~\\
\cellcolor{gray} &  & \verb~104~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~105~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~106~ & & \verb~        public void FindAsyncMultipleParamsTestAudit()~\\
\cellcolor{green} & 1 & \verb~107~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~108~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleCompositeKeyEnti~\\
\cellcolor{gray} &  & \verb~109~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~110~ & & \verb~            var actual = repository.FindAsync(1, "Another Key");~\\
\cellcolor{green} & 1 & \verb~111~ & & \verb~            Assert.AreEqual("Another Key", actual.Result.Name);~\\
\cellcolor{gray} &  & \verb~112~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~113~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~114~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~115~ & & \verb~~\\
\cellcolor{gray} &  & \verb~116~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~117~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~118~ & & \verb~        public void FindByReadOnlyTestAudit()~\\
\cellcolor{green} & 1 & \verb~119~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~120~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~121~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~122~ & & \verb~            var actual = repository.FindByReadOnly(x=>x.Id == 1).SingleOrDefau~\\
\cellcolor{green} & 1 & \verb~123~ & & \verb~            Assert.AreEqual("Test 1", actual.Name);~\\
\cellcolor{gray} &  & \verb~124~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~125~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~126~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~127~ & & \verb~~\\
\cellcolor{gray} &  & \verb~128~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~129~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~130~ & & \verb~        public void ExistsTestAudit()~\\
\cellcolor{green} & 1 & \verb~131~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~132~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~133~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~134~ & & \verb~            var actual = repository.Exists(x => x.Id == 1);~\\
\cellcolor{green} & 1 & \verb~135~ & & \verb~            Assert.IsTrue(actual);~\\
\cellcolor{gray} &  & \verb~136~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~137~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~138~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~139~ & & \verb~~\\
\cellcolor{gray} &  & \verb~140~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~141~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~142~ & & \verb~        public void FindAndReloadAsyncTestAudit()~\\
\cellcolor{green} & 1 & \verb~143~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~144~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~145~ & & \verb~~\\
\cellcolor{gray} &  & \verb~146~ & & \verb~            //Load the entity~\\
\cellcolor{green} & 1 & \verb~147~ & & \verb~            var actualEntity = repository.FindAsync(2).Result;~\\
\cellcolor{green} & 1 & \verb~148~ & & \verb~            Assert.AreEqual("Test 2", actualEntity.Name);~\\
\cellcolor{gray} &  & \verb~149~ & & \verb~~\\
\cellcolor{gray} &  & \verb~150~ & & \verb~            //Alter the entity~\\
\cellcolor{green} & 1 & \verb~151~ & & \verb~            actualEntity.Name = "Test 10";~\\
\cellcolor{green} & 1 & \verb~152~ & & \verb~            Assert.AreEqual("Test 10", actualEntity.Name);~\\
\cellcolor{gray} &  & \verb~153~ & & \verb~~\\
\cellcolor{gray} &  & \verb~154~ & & \verb~            //Reload the entity from the database, resetting the data~\\
\cellcolor{green} & 1 & \verb~155~ & & \verb~            repository.ReloadAsync(actualEntity).Wait();~\\
\cellcolor{gray} &  & \verb~156~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~157~ & & \verb~            Assert.AreEqual("Test 2", actualEntity.Name);~\\
\cellcolor{green} & 1 & \verb~158~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~159~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~160~ & & \verb~~\\
\cellcolor{gray} &  & \verb~161~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~162~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~163~ & & \verb~        public void FindAndReloadTestAudit()~\\
\cellcolor{green} & 1 & \verb~164~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~165~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~166~ & & \verb~~\\
\cellcolor{gray} &  & \verb~167~ & & \verb~            //Load the entity~\\
\cellcolor{green} & 1 & \verb~168~ & & \verb~            var actualEntity = repository.Find(2);~\\
\cellcolor{green} & 1 & \verb~169~ & & \verb~            Assert.AreEqual("Test 2", actualEntity.Name);~\\
\cellcolor{gray} &  & \verb~170~ & & \verb~~\\
\cellcolor{gray} &  & \verb~171~ & & \verb~            //Alter the entity~\\
\cellcolor{green} & 1 & \verb~172~ & & \verb~            actualEntity.Name = "Test 10";~\\
\cellcolor{green} & 1 & \verb~173~ & & \verb~            Assert.AreEqual("Test 10", actualEntity.Name);~\\
\cellcolor{gray} &  & \verb~174~ & & \verb~~\\
\cellcolor{gray} &  & \verb~175~ & & \verb~            //Reload the entity from the database, resetting the data~\\
\cellcolor{green} & 1 & \verb~176~ & & \verb~            repository.Reload(actualEntity);~\\
\cellcolor{gray} &  & \verb~177~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~178~ & & \verb~            Assert.AreEqual("Test 2", actualEntity.Name);~\\
\cellcolor{green} & 1 & \verb~179~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~180~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~181~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~182~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Auditable.Repository6.Tests.RepositoryUpdateTests}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Auditable.Repository6.Tests.RepositoryUpdateTests\\
\textbf{Assembly:} & entityframework.auditable.repository6.tests.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{kRepository6\textbackslash EntityFrameworkAuditableRepository6Tests\textbackslash RepositoryUpdateTests.cs}\end{minipage} \\
\textbf{Covered lines:} & 61\\
\textbf{Uncovered lines:} & 1\\
\textbf{Coverable lines:} & 62\\
\textbf{Total lines:} & 142\\
\textbf{Line coverage:} & 98.3\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{Setup()} & 18 & 0\\
\hline
\textbf{UpdateTestMethodAudi} & 12 & 0\\
\hline
\textbf{UpdateTestMethodWith} & 13 & 0\\
\hline
\textbf{UpdateByTestMethodAu} & 19 & 0\\
\hline
\textbf{UpdateByAuditTestMet} & 42 & 2\\
\hline
\textbf{UpdateByTestMethodIn} & 13 & 1\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{kRepository6\textbackslash EntityFrameworkAuditableRepository6Tests\textbackslash RepositoryUpdateTests.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using EntityFramework.Auditing;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using EntityFramework.Repository6;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using Microsoft.Practices.Unity;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using Microsoft.VisualStudio.TestTools.UnitTesting;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using PersistentLayer.Auditable.Entities;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using PersistentLayer.Auditable.Repositories;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~using System.Data.Entity.Infrastructure;~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~using System.Diagnostics;~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~namespace EntityFramework.Auditable.Repository6.Tests~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~    [TestClass]~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    public class RepositoryUpdateTests~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~17~ & & \verb~        UnityContainer LocalIoCContainer { get; set; }~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~        [TestInitialize]~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~        public void Setup()~\\
\cellcolor{green} & 1 & \verb~21~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~22~ & & \verb~            Action<string> logSetup = message => Debug.WriteLine(message);~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~24~ & & \verb~            LocalIoCContainer = new UnityContainer();~\\
\cellcolor{green} & 1 & \verb~25~ & & \verb~            LocalIoCContainer.RegisterType<ISimpleDataEntityRepository, Simple~\\
\cellcolor{green} & 1 & \verb~26~ & & \verb~            LocalIoCContainer.RegisterType<ISimpleCompositeKeyEntityRepository~\\
\cellcolor{gray} &  & \verb~27~ & & \verb~~\\
\cellcolor{gray} &  & \verb~28~ & & \verb~~\\
\cellcolor{gray} &  & \verb~29~ & & \verb~~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~            //AuditDbContext.RegisterAuditType(typeof(SimpleDataEntity), typeo~\\
\cellcolor{gray} &  & \verb~31~ & & \verb~~\\
\cellcolor{gray} &  & \verb~32~ & & \verb~            //Use a physical database file~\\
\cellcolor{gray} &  & \verb~33~ & & \verb~            //Direct connection string~\\
\cellcolor{gray} &  & \verb~34~ & & \verb~            //var connectionString = @"Data Source = (LocalDb)\MSSQLLocalDB; D~\\
\cellcolor{gray} &  & \verb~35~ & & \verb~            //or~\\
\cellcolor{gray} &  & \verb~36~ & & \verb~            //Computed connection~\\
\cellcolor{gray} &  & \verb~37~ & & \verb~            //var connectionString = @"TestDatabase";~\\
\cellcolor{gray} &  & \verb~38~ & & \verb~            //LocalIoCContainer.RegisterType(typeof(IDatabaseFactory<>), typeo~\\
\cellcolor{gray} &  & \verb~39~ & & \verb~            //    , new HierarchicalLifetimeManager()~\\
\cellcolor{gray} &  & \verb~40~ & & \verb~            //    , new InjectionConstructor(connectionString)~\\
\cellcolor{gray} &  & \verb~41~ & & \verb~            //    , new InjectionProperty("Logging", logSetup));~\\
\cellcolor{gray} &  & \verb~42~ & & \verb~~\\
\cellcolor{gray} &  & \verb~43~ & & \verb~            //Use an nmemory database~\\
\cellcolor{green} & 1 & \verb~44~ & & \verb~            LocalIoCContainer.RegisterType(typeof(IDatabaseFactory<>), typeof(~\\
\cellcolor{green} & 1 & \verb~45~ & & \verb~                , new HierarchicalLifetimeManager()~\\
\cellcolor{green} & 1 & \verb~46~ & & \verb~                , new InjectionProperty("Logging", logSetup));~\\
\cellcolor{green} & 1 & \verb~47~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~48~ & & \verb~~\\
\cellcolor{gray} &  & \verb~49~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~50~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~51~ & & \verb~        public void UpdateTestMethodAudit()~\\
\cellcolor{green} & 1 & \verb~52~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~53~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~54~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~55~ & & \verb~            var itemToUpdate = repository.Find(2);~\\
\cellcolor{green} & 1 & \verb~56~ & & \verb~            itemToUpdate.Name = "Updated Name";~\\
\cellcolor{green} & 1 & \verb~57~ & & \verb~            repository.Update(itemToUpdate, itemToUpdate.Id);~\\
\cellcolor{green} & 1 & \verb~58~ & & \verb~            repository.Save();~\\
\cellcolor{gray} &  & \verb~59~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~60~ & & \verb~            var actual = repository.Find(2);~\\
\cellcolor{gray} &  & \verb~61~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~62~ & & \verb~            Assert.AreEqual("Updated Name", actual.Name);~\\
\cellcolor{gray} &  & \verb~63~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~64~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~65~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~66~ & & \verb~~\\
\cellcolor{gray} &  & \verb~67~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~68~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~69~ & & \verb~        public void UpdateTestMethodWithIgnoreFieldFeatureAudit()~\\
\cellcolor{green} & 1 & \verb~70~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~71~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{green} & 1 & \verb~72~ & & \verb~            repository.AddUpdateIgnoreField("Name");~\\
\cellcolor{gray} &  & \verb~73~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~74~ & & \verb~            var itemToUpdate = repository.Find(2);~\\
\cellcolor{green} & 1 & \verb~75~ & & \verb~            itemToUpdate.Name = "Updated Name";~\\
\cellcolor{green} & 1 & \verb~76~ & & \verb~            repository.Update(itemToUpdate, itemToUpdate.Id);~\\
\cellcolor{green} & 1 & \verb~77~ & & \verb~            repository.Save("UserName1");~\\
\cellcolor{gray} &  & \verb~78~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~79~ & & \verb~            var actual = repository.Find(2);~\\
\cellcolor{gray} &  & \verb~80~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~81~ & & \verb~            Assert.AreNotEqual("Updated Name", actual.Name);~\\
\cellcolor{gray} &  & \verb~82~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~83~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~84~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~85~ & & \verb~~\\
\cellcolor{gray} &  & \verb~86~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~87~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~88~ & & \verb~        public void UpdateByTestMethodAudit()~\\
\cellcolor{green} & 1 & \verb~89~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~90~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~91~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~92~ & & \verb~            var itemToUpdate = repository.Find(2);~\\
\cellcolor{green} & 1 & \verb~93~ & & \verb~            itemToUpdate.Name = "Updated Name 2";~\\
\cellcolor{green} & 1 & \verb~94~ & & \verb~            repository.Update(itemToUpdate, x => x.Id == 2);~\\
\cellcolor{green} & 1 & \verb~95~ & & \verb~            repository.Save();~\\
\cellcolor{gray} &  & \verb~96~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~97~ & & \verb~            var actual = repository.Find(2);~\\
\cellcolor{gray} &  & \verb~98~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~99~ & & \verb~            Assert.AreEqual("Updated Name 2", actual.Name);~\\
\cellcolor{gray} &  & \verb~100~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~101~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~102~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~103~ & & \verb~~\\
\cellcolor{gray} &  & \verb~104~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~105~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~106~ & & \verb~        public void UpdateByAuditTestMethod()~\\
\cellcolor{green} & 1 & \verb~107~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~108~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{green} & 1 & \verb~109~ & & \verb~            Assert.IsTrue(AuditDbContext.AuditEnabled);~\\
\cellcolor{gray} &  & \verb~110~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~111~ & & \verb~            AuditDbContext.RegisterAuditType(typeof(SimpleDataEntity), typeof(~\\
\cellcolor{gray} &  & \verb~112~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~113~ & & \verb~            var itemToUpdate = repository.Find(2);~\\
\cellcolor{green} & 1 & \verb~114~ & & \verb~            itemToUpdate.Name = "Updated Name 3";~\\
\cellcolor{green} & 1 & \verb~115~ & & \verb~            repository.Update(itemToUpdate, x => x.Id == 2);~\\
\cellcolor{gray} &  & \verb~116~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~117~ & & \verb~            repository.Save("UserName2");~\\
\cellcolor{gray} &  & \verb~118~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~119~ & & \verb~            var actual = repository.Find(2);~\\
\cellcolor{gray} &  & \verb~120~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~121~ & & \verb~            var auditactual = repository.GetExistingContext().SimpleDataEntity~\\
\cellcolor{gray} &  & \verb~122~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~123~ & & \verb~            Assert.AreEqual("Updated Name 3", actual.Name);~\\
\cellcolor{green} & 1 & \verb~124~ & & \verb~            Assert.AreEqual("Test 2", auditactual?.Name);~\\
\cellcolor{green} & 1 & \verb~125~ & & \verb~            Assert.AreEqual("UserName2", auditactual?.AuditUser);~\\
\cellcolor{gray} &  & \verb~126~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~127~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~128~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~129~ & & \verb~~\\
\cellcolor{gray} &  & \verb~130~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~131~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~132~ & & \verb~        [ExpectedException(typeof(ArgumentOutOfRangeException))]~\\
\cellcolor{gray} &  & \verb~133~ & & \verb~        public void UpdateByTestMethodIncorrectIdAudit()~\\
\cellcolor{green} & 1 & \verb~134~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~135~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~136~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~137~ & & \verb~            var itemToUpdate = repository.Find(2);~\\
\cellcolor{green} & 1 & \verb~138~ & & \verb~            itemToUpdate.Name = "Updated Name 2";~\\
\cellcolor{green} & 1 & \verb~139~ & & \verb~            repository.Update(itemToUpdate, x => x.Id == 55);~\\
\cellcolor{red} & 0 & \verb~140~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~141~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~142~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Auditable.Repository6.Tests.TestDbInitializer}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Auditable.Repository6.Tests.TestDbInitializer\\
\textbf{Assembly:} & entityframework.auditable.repository6.tests.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{tory6\textbackslash EntityFrameworkAuditableRepository6Tests\textbackslash SampleData\textbackslash TestDbInitializer.cs}\end{minipage} \\
\textbf{Covered lines:} & 7\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 7\\
\textbf{Total lines:} & 24\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{Seed(PersistentLayer} & 11 & 0\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{tory6\textbackslash EntityFrameworkAuditableRepository6Tests\textbackslash SampleData\textbackslash TestDbInitializer.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using PersistentLayer.Auditable.Contexts;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using PersistentLayer.Auditable.Entities;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System.Data.Entity;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using System.Text;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~namespace EntityFramework.Auditable.Repository6.Tests~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~    public class TestDbInitializer : DropCreateDatabaseAlways<YourCustomDataCo~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~        protected override void Seed(YourCustomDataContext context)~\\
\cellcolor{green} & 1 & \verb~15~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~16~ & & \verb~            var mydata1 = new SimpleDataEntity { Name = "Hello Test 2" };~\\
\cellcolor{green} & 1 & \verb~17~ & & \verb~            var mydata2 = new SimpleDataEntity { Name = "Hello Test Again 2" }~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~19~ & & \verb~            context.SimpleDataEntities.Add(mydata1);~\\
\cellcolor{green} & 1 & \verb~20~ & & \verb~            context.SimpleDataEntities.Add(mydata2);~\\
\cellcolor{green} & 1 & \verb~21~ & & \verb~            var result = context.SaveChangesAsync().Result;~\\
\cellcolor{green} & 1 & \verb~22~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Auditable.Repository6.Tests.TestExampleDatabaseFactory}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Auditable.Repository6.Tests.TestExampleDatabaseFactory\\
\textbf{Assembly:} & entityframework.auditable.repository6.tests.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{ityFrameworkAuditableRepository6Tests\textbackslash SampleData\textbackslash TestExampleDatabaseFactory.cs}\end{minipage} \\
\textbf{Covered lines:} & 17\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 17\\
\textbf{Total lines:} & 45\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{GetNewDbContext()} & 71 & 0\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{ityFrameworkAuditableRepository6Tests\textbackslash SampleData\textbackslash TestExampleDatabaseFactory.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using System.Text;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Data.Entity;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using Effort.Extra;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~using PersistentLayer.Auditable.Entities;~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~using PersistentLayer.Auditable;~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~using PersistentLayer.Auditable.Contexts;~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~using EntityFramework.Repository6;~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~namespace EntityFramework.Auditable.Repository6.Tests~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    public class TestExampleDatabaseFactory : IDatabaseFactory<YourCustomDataC~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~17~ & & \verb~        public Action<string> Logging { get; set; }~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~        public YourCustomDataContext GetNewDbContext()~\\
\cellcolor{green} & 1 & \verb~20~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~21~ & & \verb~            var data = new ObjectData();~\\
\cellcolor{gray} &  & \verb~22~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~23~ & & \verb~            data.Table<SimpleDataEntity>("SimpleDataEntities").Add(new SimpleD~\\
\cellcolor{green} & 1 & \verb~24~ & & \verb~            data.Table<SimpleDataEntity>("SimpleDataEntities").Add(new SimpleD~\\
\cellcolor{green} & 1 & \verb~25~ & & \verb~            data.Table<SimpleDataEntity>("SimpleDataEntities").Add(new SimpleD~\\
\cellcolor{green} & 1 & \verb~26~ & & \verb~            data.Table<SimpleDataEntity>("SimpleDataEntities").Add(new SimpleD~\\
\cellcolor{green} & 1 & \verb~27~ & & \verb~            data.Table<SimpleDataEntity>("SimpleDataEntities").Add(new SimpleD~\\
\cellcolor{gray} &  & \verb~28~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~29~ & & \verb~            data.Table<SimpleCompositeKeyEntity>("SimpleCompositeKeyEntities")~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~31~ & & \verb~            var dataLoader = new ObjectDataLoader(data);~\\
\cellcolor{gray} &  & \verb~32~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~33~ & & \verb~            var connection = Effort.DbConnectionFactory.CreateTransient(dataLo~\\
\cellcolor{gray} &  & \verb~34~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~35~ & & \verb~            var _context = new YourCustomDataContext(connection);~\\
\cellcolor{gray} &  & \verb~36~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~37~ & & \verb~            _context.Database.CreateIfNotExists();~\\
\cellcolor{green} & 1 & \verb~38~ & & \verb~            _context.Database.Initialize(true);~\\
\cellcolor{gray} &  & \verb~39~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~40~ & & \verb~            if (Logging != null) { _context.Database.Log = Logging; }~\\
\cellcolor{gray} &  & \verb~41~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~42~ & & \verb~            return _context;~\\
\cellcolor{green} & 1 & \verb~43~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~44~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~45~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Repository6.Tests.DeltaTests}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Repository6.Tests.DeltaTests\\
\textbf{Assembly:} & entityframework.auditable.repository6.tests.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{ityFrameworkRepository6\textbackslash EntityFrameworkAuditableRepository6Tests\textbackslash DeltaTests.cs}\end{minipage} \\
\textbf{Covered lines:} & 64\\
\textbf{Uncovered lines:} & 4\\
\textbf{Coverable lines:} & 68\\
\textbf{Total lines:} & 144\\
\textbf{Line coverage:} & 94.1\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{Setup()} & 18 & 0\\
\hline
\textbf{DeltaTest1Audit()} & 16 & 0\\
\hline
\textbf{DeltaTestWrongDataTy} & 8 & 1\\
\hline
\textbf{DeltaTestInvalidFiel} & 8 & 1\\
\hline
\textbf{DeltaTest2Audit()} & 27 & 0\\
\hline
\textbf{DeltaTestFailAudit()} & 9 & 1\\
\hline
\textbf{DeltaTestFailWithPre} & 17 & 1\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{ityFrameworkRepository6\textbackslash EntityFrameworkAuditableRepository6Tests\textbackslash DeltaTests.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using Microsoft.VisualStudio.TestTools.UnitTesting;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System.Diagnostics;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using Microsoft.Practices.Unity;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Data.Entity.Infrastructure;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using PersistentLayer.Auditable.Repositories;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~using EntityFramework.Auditable.Repository6.Tests;~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~using PersistentLayer.Auditable.Entities;~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~using EntityFramework.Repository6;~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~namespace EntityFramework.Repository6.Tests~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~    [TestClass]~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    public class DeltaTests~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~17~ & & \verb~        UnityContainer LocalIoCContainer { get; set; }~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~        [TestInitialize]~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~        public void Setup()~\\
\cellcolor{green} & 1 & \verb~21~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~22~ & & \verb~            Action<string> logSetup = message => Debug.WriteLine(message);~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~24~ & & \verb~            LocalIoCContainer = new UnityContainer();~\\
\cellcolor{green} & 1 & \verb~25~ & & \verb~            LocalIoCContainer.RegisterType<ISimpleDataEntityRepository, Simple~\\
\cellcolor{green} & 1 & \verb~26~ & & \verb~            LocalIoCContainer.RegisterType<ISimpleCompositeKeyEntityRepository~\\
\cellcolor{gray} &  & \verb~27~ & & \verb~~\\
\cellcolor{gray} &  & \verb~28~ & & \verb~            //Use a physical database file~\\
\cellcolor{gray} &  & \verb~29~ & & \verb~            //var connectionString = @"Data Source = (LocalDb)\MSSQLLocalDB; D~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~            //or~\\
\cellcolor{gray} &  & \verb~31~ & & \verb~            //var connectionString = @"TestDatabase";~\\
\cellcolor{gray} &  & \verb~32~ & & \verb~            //LocalIoCContainer.RegisterType(typeof(IDatabaseFactory<>), typeo~\\
\cellcolor{gray} &  & \verb~33~ & & \verb~            //    , new HierarchicalLifetimeManager()~\\
\cellcolor{gray} &  & \verb~34~ & & \verb~            //    , new InjectionConstructor(connectionString)~\\
\cellcolor{gray} &  & \verb~35~ & & \verb~            //    , new InjectionProperty("Logging", logSetup));~\\
\cellcolor{gray} &  & \verb~36~ & & \verb~~\\
\cellcolor{gray} &  & \verb~37~ & & \verb~            //Use an nmemory database~\\
\cellcolor{green} & 1 & \verb~38~ & & \verb~            LocalIoCContainer.RegisterType(typeof(IDatabaseFactory<>), typeof(~\\
\cellcolor{green} & 1 & \verb~39~ & & \verb~                , new HierarchicalLifetimeManager()~\\
\cellcolor{green} & 1 & \verb~40~ & & \verb~                , new InjectionProperty("Logging", logSetup));~\\
\cellcolor{green} & 1 & \verb~41~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~42~ & & \verb~~\\
\cellcolor{gray} &  & \verb~43~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~44~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~45~ & & \verb~        public void DeltaTest1Audit()~\\
\cellcolor{green} & 1 & \verb~46~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~47~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{green} & 1 & \verb~48~ & & \verb~            var newItem = new SimpleDataEntity { Name = "Delta Test" };~\\
\cellcolor{green} & 1 & \verb~49~ & & \verb~            var actual = repository.Add(newItem);~\\
\cellcolor{green} & 1 & \verb~50~ & & \verb~            var result = repository.Save();~\\
\cellcolor{gray} &  & \verb~51~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~52~ & & \verb~            var delta1 = new Delta<SimpleDataEntity>();~\\
\cellcolor{green} & 1 & \verb~53~ & & \verb~            delta1.SetValue("Name", "Delta Change Test");~\\
\cellcolor{gray} &  & \verb~54~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~55~ & & \verb~            repository.Update(delta1, newItem.Id);~\\
\cellcolor{gray} &  & \verb~56~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~57~ & & \verb~            repository.Save();~\\
\cellcolor{gray} &  & \verb~58~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~59~ & & \verb~            var updatedValue = repository.Find(actual.Id);~\\
\cellcolor{green} & 1 & \verb~60~ & & \verb~            Assert.AreEqual("Delta Change Test", updatedValue.Name);~\\
\cellcolor{green} & 1 & \verb~61~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~62~ & & \verb~~\\
\cellcolor{gray} &  & \verb~63~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~64~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~65~ & & \verb~        [ExpectedException(typeof(ArgumentException))]~\\
\cellcolor{gray} &  & \verb~66~ & & \verb~        public void DeltaTestWrongDataType1Audit()~\\
\cellcolor{green} & 1 & \verb~67~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~68~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{green} & 1 & \verb~69~ & & \verb~            var newItem = new SimpleDataEntity { Name = "Delta Test" };~\\
\cellcolor{green} & 1 & \verb~70~ & & \verb~            var actual = repository.Add(newItem);~\\
\cellcolor{green} & 1 & \verb~71~ & & \verb~            var result = repository.Save();~\\
\cellcolor{gray} &  & \verb~72~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~73~ & & \verb~            var delta1 = new Delta<SimpleDataEntity>();~\\
\cellcolor{green} & 1 & \verb~74~ & & \verb~            delta1.SetValue("Name", 1);~\\
\cellcolor{red} & 0 & \verb~75~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~76~ & & \verb~~\\
\cellcolor{gray} &  & \verb~77~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~78~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~79~ & & \verb~        [ExpectedException(typeof(ArgumentException))]~\\
\cellcolor{gray} &  & \verb~80~ & & \verb~        public void DeltaTestInvalidFieldName1Audit()~\\
\cellcolor{green} & 1 & \verb~81~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~82~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{green} & 1 & \verb~83~ & & \verb~            var newItem = new SimpleDataEntity { Name = "Delta Test" };~\\
\cellcolor{green} & 1 & \verb~84~ & & \verb~            var actual = repository.Add(newItem);~\\
\cellcolor{green} & 1 & \verb~85~ & & \verb~            var result = repository.Save();~\\
\cellcolor{gray} &  & \verb~86~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~87~ & & \verb~            var delta1 = new Delta<SimpleDataEntity>();~\\
\cellcolor{green} & 1 & \verb~88~ & & \verb~            delta1.SetValue("NameNotRight", "Right data type");~\\
\cellcolor{red} & 0 & \verb~89~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~90~ & & \verb~~\\
\cellcolor{gray} &  & \verb~91~ & & \verb~~\\
\cellcolor{gray} &  & \verb~92~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~93~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~94~ & & \verb~        public void DeltaTest2Audit()~\\
\cellcolor{green} & 1 & \verb~95~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~96~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{green} & 1 & \verb~97~ & & \verb~            var newItem = new SimpleDataEntity { Name = "Delta Test" };~\\
\cellcolor{green} & 1 & \verb~98~ & & \verb~            var actual = repository.Add(newItem);~\\
\cellcolor{green} & 1 & \verb~99~ & & \verb~            var result = repository.Save();~\\
\cellcolor{gray} &  & \verb~100~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~101~ & & \verb~            var delta2 = new Delta<SimpleDataEntity>();~\\
\cellcolor{green} & 1 & \verb~102~ & & \verb~            delta2.SetValue("Name", "Delta Change Test 2");~\\
\cellcolor{gray} &  & \verb~103~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~104~ & & \verb~            repository.Update(delta2, e => e.Id == newItem.Id);~\\
\cellcolor{gray} &  & \verb~105~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~106~ & & \verb~            repository.Save();~\\
\cellcolor{gray} &  & \verb~107~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~108~ & & \verb~            var updatedValue = repository.Find(actual.Id);~\\
\cellcolor{green} & 1 & \verb~109~ & & \verb~            Assert.AreEqual("Delta Change Test 2", updatedValue.Name);~\\
\cellcolor{green} & 1 & \verb~110~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~111~ & & \verb~~\\
\cellcolor{gray} &  & \verb~112~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~113~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~114~ & & \verb~        [ExpectedException(typeof(ArgumentOutOfRangeException))]~\\
\cellcolor{gray} &  & \verb~115~ & & \verb~        public void DeltaTestFailAudit()~\\
\cellcolor{green} & 1 & \verb~116~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~117~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{green} & 1 & \verb~118~ & & \verb~            var newItem = new SimpleDataEntity { Name = "Delta Test" };~\\
\cellcolor{green} & 1 & \verb~119~ & & \verb~            var actual = repository.Add(newItem);~\\
\cellcolor{green} & 1 & \verb~120~ & & \verb~            var result = repository.Save();~\\
\cellcolor{gray} &  & \verb~121~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~122~ & & \verb~            var delta1 = new Delta<SimpleDataEntity>();~\\
\cellcolor{green} & 1 & \verb~123~ & & \verb~            delta1.SetValue("Name", "Delta Change Test");~\\
\cellcolor{gray} &  & \verb~124~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~125~ & & \verb~            repository.Update(delta1, 55);~\\
\cellcolor{red} & 0 & \verb~126~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~127~ & & \verb~~\\
\cellcolor{gray} &  & \verb~128~ & & \verb~        [TestCategory("AuditRepository")]~\\
\cellcolor{gray} &  & \verb~129~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~130~ & & \verb~        [ExpectedException(typeof(ArgumentOutOfRangeException))]~\\
\cellcolor{gray} &  & \verb~131~ & & \verb~        public void DeltaTestFailWithPredicateAudit()~\\
\cellcolor{green} & 1 & \verb~132~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~133~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{green} & 1 & \verb~134~ & & \verb~            var newItem = new SimpleDataEntity { Name = "Delta Test" };~\\
\cellcolor{green} & 1 & \verb~135~ & & \verb~            var actual = repository.Add(newItem);~\\
\cellcolor{green} & 1 & \verb~136~ & & \verb~            var result = repository.Save();~\\
\cellcolor{gray} &  & \verb~137~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~138~ & & \verb~            var delta1 = new Delta<SimpleDataEntity>();~\\
\cellcolor{green} & 1 & \verb~139~ & & \verb~            delta1.SetValue("Name", "Delta Change Test");~\\
\cellcolor{gray} &  & \verb~140~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~141~ & & \verb~            repository.Update(delta1, x=>x.Id == 55);~\\
\cellcolor{red} & 0 & \verb~142~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~143~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~144~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Auditing.AuditableEntity}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Auditing.AuditableEntity\\
\textbf{Assembly:} & entityframework.auditing.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{\textbackslash Development\textbackslash EntityFrameworkRepository6\textbackslash AuditDbContextLocal\textbackslash AuditableEntity.cs}\end{minipage} \\
\textbf{Covered lines:} & 2\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 2\\
\textbf{Total lines:} & 35\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{File(s)}
\subsubsection{\textbackslash Development\textbackslash EntityFrameworkRepository6\textbackslash AuditDbContextLocal\textbackslash AuditableEntity.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~//-----------------------------------------------------------------------~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~// <copyright file="AuditableEntity.cs" company="Russell Wilkins">~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~//     Copyright (c) Russell Wilkins 2012. All Rights Reserved.~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~// </copyright>~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~// <author>Russell Wilkins</author>~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~// <license href="license.txt">~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~//     The use of this software is governed by the Microsoft Public License~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~//     which is included with this distribution.~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~// </license>~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~//-----------------------------------------------------------------------~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~namespace EntityFramework.Auditing~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~    using System;~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~    using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    using System.Linq;~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    using System.Text;~\\
\cellcolor{gray} &  & \verb~17~ & & \verb~~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~    /// <summary>~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~    /// Base class for auditable entities.~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~    /// </summary>~\\
\cellcolor{gray} &  & \verb~21~ & & \verb~    public abstract class AuditableEntity : IAuditableEntity~\\
\cellcolor{gray} &  & \verb~22~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~        /// <summary>~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~        /// Gets or sets the DateTime the entity was last updated.~\\
\cellcolor{gray} &  & \verb~25~ & & \verb~        /// Will be automatically set by AuditDbContext on SaveChanges.~\\
\cellcolor{gray} &  & \verb~26~ & & \verb~        /// </summary>~\\
\cellcolor{green} & 1 & \verb~27~ & & \verb~        public virtual DateTimeOffset? Updated { get; set; }~\\
\cellcolor{gray} &  & \verb~28~ & & \verb~~\\
\cellcolor{gray} &  & \verb~29~ & & \verb~        /// <summary>~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~        /// Gets or sets the User who last updated the entity on the database.~\\
\cellcolor{gray} &  & \verb~31~ & & \verb~        /// Will be automatically set by AuditDbContext on SaveChanges.~\\
\cellcolor{gray} &  & \verb~32~ & & \verb~        /// </summary>~\\
\cellcolor{green} & 1 & \verb~33~ & & \verb~        public virtual string UpdateUser { get; set; }~\\
\cellcolor{gray} &  & \verb~34~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~35~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Auditing.AuditConfigurationSection}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Auditing.AuditConfigurationSection\\
\textbf{Assembly:} & entityframework.auditing.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{workRepository6\textbackslash AuditDbContextLocal\textbackslash Configuration\textbackslash AuditConfigurationSection.cs}\end{minipage} \\
\textbf{Covered lines:} & 6\\
\textbf{Uncovered lines:} & 3\\
\textbf{Coverable lines:} & 9\\
\textbf{Total lines:} & 42\\
\textbf{Line coverage:} & 66.6\%\\
\end{longtable}
\subsection{File(s)}
\subsubsection{workRepository6\textbackslash AuditDbContextLocal\textbackslash Configuration\textbackslash AuditConfigurationSection.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~//-----------------------------------------------------------------------~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~// <copyright file="AuditConfigurationSection.cs" company="Russell Wilkins">~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~//     Copyright (c) Russell Wilkins 2012. All Rights Reserved.~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~// </copyright>~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~// <author>Russell Wilkins</author>~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~// <license href="license.txt">~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~//     The use of this software is governed by the Microsoft Public License~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~//     which is included with this distribution.~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~// </license>~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~//-----------------------------------------------------------------------~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~namespace EntityFramework.Auditing~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~    using System.Configuration;~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    internal class AuditConfigurationSection : ConfigurationSection~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~17~ & & \verb~        [ConfigurationProperty("entities", IsDefaultCollection = false)]~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~        [ConfigurationCollection(typeof(EntityElementCollection),~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~            AddItemName = "add")]~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~        internal EntityElementCollection Entities~\\
\cellcolor{gray} &  & \verb~21~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~22~ & & \verb~            get~\\
\cellcolor{green} & 1 & \verb~23~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~24~ & & \verb~                return (EntityElementCollection)base["entities"];~\\
\cellcolor{green} & 1 & \verb~25~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~26~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~27~ & & \verb~~\\
\cellcolor{gray} &  & \verb~28~ & & \verb~        [ConfigurationProperty("enabled", IsRequired = false, DefaultValue = t~\\
\cellcolor{gray} &  & \verb~29~ & & \verb~        internal bool Enabled~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~31~ & & \verb~            get~\\
\cellcolor{green} & 1 & \verb~32~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~33~ & & \verb~                return (bool)this["enabled"];~\\
\cellcolor{green} & 1 & \verb~34~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~35~ & & \verb~~\\
\cellcolor{gray} &  & \verb~36~ & & \verb~            set~\\
\cellcolor{red} & 0 & \verb~37~ & & \verb~            {~\\
\cellcolor{red} & 0 & \verb~38~ & & \verb~                this["enabled"] = value;~\\
\cellcolor{red} & 0 & \verb~39~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~40~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~41~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~42~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Auditing.AuditDbContext}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Auditing.AuditDbContext\\
\textbf{Assembly:} & entityframework.auditing.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{:\textbackslash Development\textbackslash EntityFrameworkRepository6\textbackslash AuditDbContextLocal\textbackslash AuditDbContext.cs}\end{minipage} \\
\textbf{Covered lines:} & 157\\
\textbf{Uncovered lines:} & 30\\
\textbf{Coverable lines:} & 187\\
\textbf{Total lines:} & 400\\
\textbf{Line coverage:} & 83.9\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{AuditDbContext()} & 24 & 0\\
\hline
\textbf{AuditDbContext(strin} & 2 & 0\\
\hline
\textbf{AuditDbContext(Syste} & 0 & 2\\
\hline
\textbf{AuditDbContext(Syste} & 2 & 0\\
\hline
\textbf{RegisterAuditType(Sy} & 45 & 4\\
\hline
\textbf{Reload(object)} & 3 & 0\\
\hline
\textbf{Detach(object)} & 0 & 2\\
\hline
\textbf{SaveChanges()} & 5 & 0\\
\hline
\textbf{SaveChanges(string)} & 18 & 2\\
\hline
\textbf{CreateAuditRecords(s} & 70 & 0\\
\hline
\textbf{AuditEntity(System.D} & 40 & 7\\
\hline
\textbf{GetComplexTypes(Enti} & 16 & 2\\
\hline
\textbf{SaveChangesAsync()} & 6 & 0\\
\hline
\textbf{SaveChangesAsync()} & 8 & 14\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{:\textbackslash Development\textbackslash EntityFrameworkRepository6\textbackslash AuditDbContextLocal\textbackslash AuditDbContext.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~//-----------------------------------------------------------------------~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~// <copyright file="AuditDbContext.cs" company="Russell Wilkins">~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~//     Copyright (c) Russell Wilkins 2012. All Rights Reserved.~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~// </copyright>~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~// <author>Russell Wilkins</author>~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~// <license href="license.txt">~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~//     The use of this software is governed by the Microsoft Public License~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~//     which is included with this distribution.~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~// </license>~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~//-----------------------------------------------------------------------~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~using System.Data.Entity;~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~namespace EntityFramework.Auditing~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    using System;~\\
\cellcolor{gray} &  & \verb~17~ & & \verb~    using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~    using System.Configuration;~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~    using System.Data;~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~    using System.Data.Common;~\\
\cellcolor{gray} &  & \verb~21~ & & \verb~    using System.Data.Entity.Core;~\\
\cellcolor{gray} &  & \verb~22~ & & \verb~    using System.Data.Entity.Infrastructure;~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~    using System.Linq;~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~    using System.Security.Principal;~\\
\cellcolor{gray} &  & \verb~25~ & & \verb~    using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~26~ & & \verb~~\\
\cellcolor{gray} &  & \verb~27~ & & \verb~    /// <summary>~\\
\cellcolor{gray} &  & \verb~28~ & & \verb~    /// The AuditDbContext adds auditing capabilities tot eh DbContext.~\\
\cellcolor{gray} &  & \verb~29~ & & \verb~    /// </summary>~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~    public class AuditDbContext : DbContext~\\
\cellcolor{gray} &  & \verb~31~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~32~ & & \verb~        private const string AuditUpdatedColumnName = "Audited";~\\
\cellcolor{gray} &  & \verb~33~ & & \verb~        private const string AuditUserColumnName = "AuditUser";~\\
\cellcolor{gray} &  & \verb~34~ & & \verb~        private const string AuditTypeColumnName = "AuditType";~\\
\cellcolor{gray} &  & \verb~35~ & & \verb~        private const string AuditSourceIdColumnName = "AuditSourceId";~\\
\cellcolor{gray} &  & \verb~36~ & & \verb~~\\
\cellcolor{gray} &  & \verb~37~ & & \verb~        private const string EntityUpdatedColumnName = "Updated";~\\
\cellcolor{gray} &  & \verb~38~ & & \verb~        private const string EntityUpdateUSerColumnName = "UpdateUser";~\\
\cellcolor{gray} &  & \verb~39~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~40~ & & \verb~        private static Dictionary<Type, AuditTypeInfo> auditTypes = new Dictio~\\
\cellcolor{gray} &  & \verb~41~ & & \verb~~\\
\cellcolor{gray} &  & \verb~42~ & & \verb~        #region Constructors~\\
\cellcolor{gray} &  & \verb~43~ & & \verb~        /// <summary>~\\
\cellcolor{gray} &  & \verb~44~ & & \verb~        /// Initializes static members of the AuditDbContext class.~\\
\cellcolor{gray} &  & \verb~45~ & & \verb~        /// </summary>~\\
\cellcolor{gray} &  & \verb~46~ & & \verb~        static AuditDbContext()~\\
\cellcolor{green} & 1 & \verb~47~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~48~ & & \verb~            AuditConfigurationSection config = ConfigurationManager.GetSection~\\
\cellcolor{gray} &  & \verb~49~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~50~ & & \verb~            if (config == null)~\\
\cellcolor{green} & 1 & \verb~51~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~52~ & & \verb~                config = new AuditConfigurationSection();~\\
\cellcolor{green} & 1 & \verb~53~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~54~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~55~ & & \verb~            AuditEnabled = config.Enabled;~\\
\cellcolor{gray} &  & \verb~56~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~57~ & & \verb~            foreach (EntityElement item in config.Entities)~\\
\cellcolor{green} & 1 & \verb~58~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~59~ & & \verb~                var entity = Type.GetType(item.Name);~\\
\cellcolor{green} & 1 & \verb~60~ & & \verb~                var auditEntity = Type.GetType(item.Audit);~\\
\cellcolor{gray} &  & \verb~61~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~62~ & & \verb~                if (entity != null)~\\
\cellcolor{green} & 1 & \verb~63~ & & \verb~                {~\\
\cellcolor{green} & 1 & \verb~64~ & & \verb~                    RegisterAuditType(entity, auditEntity);~\\
\cellcolor{green} & 1 & \verb~65~ & & \verb~                }~\\
\cellcolor{green} & 1 & \verb~66~ & & \verb~            }~\\
\cellcolor{green} & 1 & \verb~67~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~68~ & & \verb~~\\
\cellcolor{gray} &  & \verb~69~ & & \verb~        /// <summary>~\\
\cellcolor{gray} &  & \verb~70~ & & \verb~        /// Initializes a new instance of the AuditDbContext class~\\
\cellcolor{gray} &  & \verb~71~ & & \verb~        /// using the given string as the name or connection string~\\
\cellcolor{gray} &  & \verb~72~ & & \verb~        /// for the database to which a connection will be made.~\\
\cellcolor{gray} &  & \verb~73~ & & \verb~        /// </summary>~\\
\cellcolor{gray} &  & \verb~74~ & & \verb~        /// <param name="nameOrConnectionString">Either the database name or t~\\
\cellcolor{gray} &  & \verb~75~ & & \verb~        public AuditDbContext(string nameOrConnectionString)~\\
\cellcolor{green} & 1 & \verb~76~ & & \verb~            : base(nameOrConnectionString)~\\
\cellcolor{green} & 1 & \verb~77~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~78~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~79~ & & \verb~~\\
\cellcolor{gray} &  & \verb~80~ & & \verb~        /// <summary>~\\
\cellcolor{gray} &  & \verb~81~ & & \verb~        /// Initializes a new instance of the AuditDbContext class~\\
\cellcolor{gray} &  & \verb~82~ & & \verb~        /// using a given DBConnection~\\
\cellcolor{gray} &  & \verb~83~ & & \verb~        /// for the database which a connection will be made.~\\
\cellcolor{gray} &  & \verb~84~ & & \verb~        /// </summary>~\\
\cellcolor{gray} &  & \verb~85~ & & \verb~        /// <param name="connection">DBConnection object that the context will~\\
\cellcolor{gray} &  & \verb~86~ & & \verb~        public AuditDbContext(DbConnection connection)~\\
\cellcolor{red} & 0 & \verb~87~ & & \verb~            : base(connection, true)~\\
\cellcolor{red} & 0 & \verb~88~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~89~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~90~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~91~ & & \verb~~\\
\cellcolor{gray} &  & \verb~92~ & & \verb~        /// <summary>~\\
\cellcolor{gray} &  & \verb~93~ & & \verb~        ///~\\
\cellcolor{gray} &  & \verb~94~ & & \verb~        /// </summary>~\\
\cellcolor{gray} &  & \verb~95~ & & \verb~        /// <param name="connection"></param>~\\
\cellcolor{gray} &  & \verb~96~ & & \verb~        /// <param name="contextOwnsConnection"></param>~\\
\cellcolor{gray} &  & \verb~97~ & & \verb~        public AuditDbContext(DbConnection connection, bool contextOwnsConnect~\\
\cellcolor{green} & 1 & \verb~98~ & & \verb~            : base(connection, contextOwnsConnection)~\\
\cellcolor{green} & 1 & \verb~99~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~100~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~101~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~102~ & & \verb~~\\
\cellcolor{gray} &  & \verb~103~ & & \verb~        #endregion~\\
\cellcolor{gray} &  & \verb~104~ & & \verb~~\\
\cellcolor{gray} &  & \verb~105~ & & \verb~        /// <summary>~\\
\cellcolor{gray} &  & \verb~106~ & & \verb~        /// Gets a value indicating whether auditing is enabled on this contex~\\
\cellcolor{gray} &  & \verb~107~ & & \verb~        /// </summary>~\\
\cellcolor{green} & 1 & \verb~108~ & & \verb~        public static bool AuditEnabled { get; private set; }~\\
\cellcolor{gray} &  & \verb~109~ & & \verb~~\\
\cellcolor{gray} &  & \verb~110~ & & \verb~        /// <summary>~\\
\cellcolor{gray} &  & \verb~111~ & & \verb~        /// Gets a value indicating whether this context is using proxies.~\\
\cellcolor{gray} &  & \verb~112~ & & \verb~        /// </summary>~\\
\cellcolor{gray} &  & \verb~113~ & & \verb~        public bool Proxies~\\
\cellcolor{gray} &  & \verb~114~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~115~ & & \verb~            get~\\
\cellcolor{green} & 1 & \verb~116~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~117~ & & \verb~                if (auditTypes.Count > 0)~\\
\cellcolor{green} & 1 & \verb~118~ & & \verb~                {~\\
\cellcolor{green} & 1 & \verb~119~ & & \verb~                    var f = auditTypes.First();~\\
\cellcolor{green} & 1 & \verb~120~ & & \verb~                    var e = this.Set(f.Value.EntityType).Create();~\\
\cellcolor{green} & 1 & \verb~121~ & & \verb~                    return e.GetType().Namespace != f.Value.EntityType.Namespa~\\
\cellcolor{gray} &  & \verb~122~ & & \verb~                }~\\
\cellcolor{gray} &  & \verb~123~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~124~ & & \verb~                return false;~\\
\cellcolor{green} & 1 & \verb~125~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~126~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~127~ & & \verb~~\\
\cellcolor{gray} &  & \verb~128~ & & \verb~        /// <summary>~\\
\cellcolor{gray} &  & \verb~129~ & & \verb~        /// Registers and type for auditing.~\\
\cellcolor{gray} &  & \verb~130~ & & \verb~        /// </summary>~\\
\cellcolor{gray} &  & \verb~131~ & & \verb~        /// <param name="auditableEntityType">Type to audit, must implement IA~\\
\cellcolor{gray} &  & \verb~132~ & & \verb~        /// <param name="auditEntityType">Type of audit entity, must implement~\\
\cellcolor{gray} &  & \verb~133~ & & \verb~        public static void RegisterAuditType(Type auditableEntityType, Type au~\\
\cellcolor{green} & 1 & \verb~134~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~135~ & & \verb~            // Basic parameter validation.~\\
\cellcolor{green} & 1 & \verb~136~ & & \verb~            if (auditableEntityType == null)~\\
\cellcolor{red} & 0 & \verb~137~ & & \verb~            {~\\
\cellcolor{red} & 0 & \verb~138~ & & \verb~                throw new ArgumentNullException("auditableEntityType");~\\
\cellcolor{gray} &  & \verb~139~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~140~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~141~ & & \verb~            if (auditTypes.ContainsKey(auditableEntityType))~\\
\cellcolor{green} & 1 & \verb~142~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~143~ & & \verb~                throw new ArgumentException("Type already registered for audit~\\
\cellcolor{gray} &  & \verb~144~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~145~ & & \verb~~\\
\cellcolor{gray} &  & \verb~146~ & & \verb~            // Validate the entity.~\\
\cellcolor{green} & 1 & \verb~147~ & & \verb~            var iface = auditableEntityType.GetInterface("IAuditableEntity");~\\
\cellcolor{green} & 1 & \verb~148~ & & \verb~            if (iface == null)~\\
\cellcolor{green} & 1 & \verb~149~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~150~ & & \verb~                throw new ArgumentException("Entity does implement IAuditableE~\\
\cellcolor{gray} &  & \verb~151~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~152~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~153~ & & \verb~            AuditTypeInfo info = new AuditTypeInfo { EntityType = auditableEnt~\\
\cellcolor{gray} &  & \verb~154~ & & \verb~~\\
\cellcolor{gray} &  & \verb~155~ & & \verb~            // Validate the auditEntity~\\
\cellcolor{green} & 1 & \verb~156~ & & \verb~            if (auditEntityType != null)~\\
\cellcolor{green} & 1 & \verb~157~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~158~ & & \verb~                iface = auditEntityType.GetInterface("IAuditEntity");~\\
\cellcolor{green} & 1 & \verb~159~ & & \verb~                if (iface == null)~\\
\cellcolor{red} & 0 & \verb~160~ & & \verb~                {~\\
\cellcolor{red} & 0 & \verb~161~ & & \verb~                    throw new ArgumentException("Entity does implement IAuditE~\\
\cellcolor{gray} &  & \verb~162~ & & \verb~                }~\\
\cellcolor{gray} &  & \verb~163~ & & \verb~~\\
\cellcolor{gray} &  & \verb~164~ & & \verb~                // Extract the list of properties to audit.~\\
\cellcolor{green} & 1 & \verb~165~ & & \verb~                var properties = auditEntityType.GetProperties();~\\
\cellcolor{green} & 1 & \verb~166~ & & \verb~                var entityProperties = auditableEntityType.GetProperties().ToD~\\
\cellcolor{green} & 1 & \verb~167~ & & \verb~                foreach (var property in properties)~\\
\cellcolor{green} & 1 & \verb~168~ & & \verb~                {~\\
\cellcolor{green} & 1 & \verb~169~ & & \verb~                    if (entityProperties.ContainsKey(property.Name))~\\
\cellcolor{green} & 1 & \verb~170~ & & \verb~                    {~\\
\cellcolor{green} & 1 & \verb~171~ & & \verb~                        if (property.PropertyType == entityProperties[property~\\
\cellcolor{green} & 1 & \verb~172~ & & \verb~                        {~\\
\cellcolor{green} & 1 & \verb~173~ & & \verb~                            info.AuditProperties.Add(property.Name);~\\
\cellcolor{green} & 1 & \verb~174~ & & \verb~                        }~\\
\cellcolor{green} & 1 & \verb~175~ & & \verb~                    }~\\
\cellcolor{green} & 1 & \verb~176~ & & \verb~                }~\\
\cellcolor{green} & 1 & \verb~177~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~178~ & & \verb~~\\
\cellcolor{gray} &  & \verb~179~ & & \verb~            // Valid so register.~\\
\cellcolor{green} & 1 & \verb~180~ & & \verb~            auditTypes.Add(auditableEntityType, info);~\\
\cellcolor{green} & 1 & \verb~181~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~182~ & & \verb~~\\
\cellcolor{gray} &  & \verb~183~ & & \verb~        /// <summary>~\\
\cellcolor{gray} &  & \verb~184~ & & \verb~        /// Reloads the entity from the database overwriting any property valu~\\
\cellcolor{gray} &  & \verb~185~ & & \verb~        /// The entity will be in the Unchanged state after calling this metho~\\
\cellcolor{gray} &  & \verb~186~ & & \verb~        /// </summary>~\\
\cellcolor{gray} &  & \verb~187~ & & \verb~        /// <param name="entity">The entity object to reload.</param>~\\
\cellcolor{gray} &  & \verb~188~ & & \verb~        public void Reload(object entity)~\\
\cellcolor{green} & 1 & \verb~189~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~190~ & & \verb~            this.Entry(entity).Reload();~\\
\cellcolor{green} & 1 & \verb~191~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~192~ & & \verb~~\\
\cellcolor{gray} &  & \verb~193~ & & \verb~        /// <summary>~\\
\cellcolor{gray} &  & \verb~194~ & & \verb~        /// Detaches the entity from the context.~\\
\cellcolor{gray} &  & \verb~195~ & & \verb~        /// </summary>~\\
\cellcolor{gray} &  & \verb~196~ & & \verb~        /// <param name="entity"></param>~\\
\cellcolor{gray} &  & \verb~197~ & & \verb~        public void Detach(object entity)~\\
\cellcolor{red} & 0 & \verb~198~ & & \verb~        {~\\
\cellcolor{red} & 0 & \verb~199~ & & \verb~            this.Detach(entity);~\\
\cellcolor{red} & 0 & \verb~200~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~201~ & & \verb~~\\
\cellcolor{gray} &  & \verb~202~ & & \verb~        /// <summary>~\\
\cellcolor{gray} &  & \verb~203~ & & \verb~        /// Saves all changes made in this context to the underlying database~\\
\cellcolor{gray} &  & \verb~204~ & & \verb~        /// using the current windows user for auditing.~\\
\cellcolor{gray} &  & \verb~205~ & & \verb~        /// </summary>~\\
\cellcolor{gray} &  & \verb~206~ & & \verb~        /// <returns>The number of objects written to the underlying database.~\\
\cellcolor{gray} &  & \verb~207~ & & \verb~        public override int SaveChanges()~\\
\cellcolor{green} & 1 & \verb~208~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~209~ & & \verb~            return this.SaveChanges(WindowsIdentity.GetCurrent().Name);~\\
\cellcolor{green} & 1 & \verb~210~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~211~ & & \verb~~\\
\cellcolor{gray} &  & \verb~212~ & & \verb~        /// <summary>~\\
\cellcolor{gray} &  & \verb~213~ & & \verb~        /// Saves all changes made in this context to the underlying database~\\
\cellcolor{gray} &  & \verb~214~ & & \verb~        /// using the current windows user for auditing.~\\
\cellcolor{gray} &  & \verb~215~ & & \verb~        /// </summary>~\\
\cellcolor{gray} &  & \verb~216~ & & \verb~        /// <returns>The number of objects written to the underlying database.~\\
\cellcolor{gray} &  & \verb~217~ & & \verb~        public override async Task<int> SaveChangesAsync()~\\
\cellcolor{green} & 1 & \verb~218~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~219~ & & \verb~            return await this.SaveChangesAsync(WindowsIdentity.GetCurrent().Na~\\
\cellcolor{green} & 1 & \verb~220~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~221~ & & \verb~~\\
\cellcolor{gray} &  & \verb~222~ & & \verb~        /// <summary>~\\
\cellcolor{gray} &  & \verb~223~ & & \verb~        /// Saves all changes made in this context to the underlying database~\\
\cellcolor{gray} &  & \verb~224~ & & \verb~        /// using the user parameter passed for auditing.~\\
\cellcolor{gray} &  & \verb~225~ & & \verb~        /// </summary>~\\
\cellcolor{gray} &  & \verb~226~ & & \verb~        /// <param name="user">User name for auditing.</param>~\\
\cellcolor{gray} &  & \verb~227~ & & \verb~        /// <returns>The number of objects written to the underlying database.~\\
\cellcolor{gray} &  & \verb~228~ & & \verb~        public virtual int SaveChanges(string user)~\\
\cellcolor{green} & 1 & \verb~229~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~230~ & & \verb~            if (AuditEnabled)~\\
\cellcolor{green} & 1 & \verb~231~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~232~ & & \verb~                var audits = CreateAuditRecords(user);~\\
\cellcolor{gray} &  & \verb~233~ & & \verb~~\\
\cellcolor{gray} &  & \verb~234~ & & \verb~                // Perform the updates.~\\
\cellcolor{gray} &  & \verb~235~ & & \verb~                try~\\
\cellcolor{green} & 1 & \verb~236~ & & \verb~                {~\\
\cellcolor{green} & 1 & \verb~237~ & & \verb~                    return base.SaveChanges();~\\
\cellcolor{gray} &  & \verb~238~ & & \verb~                }~\\
\cellcolor{green} & 1 & \verb~239~ & & \verb~                catch (Exception)~\\
\cellcolor{green} & 1 & \verb~240~ & & \verb~                {~\\
\cellcolor{gray} &  & \verb~241~ & & \verb~                    // Updated failed so remove the audit entities.~\\
\cellcolor{green} & 1 & \verb~242~ & & \verb~                    foreach (var item in audits)~\\
\cellcolor{green} & 1 & \verb~243~ & & \verb~                    {~\\
\cellcolor{green} & 1 & \verb~244~ & & \verb~                        this.Set(item.GetType()).Remove(item);~\\
\cellcolor{green} & 1 & \verb~245~ & & \verb~                    }~\\
\cellcolor{gray} &  & \verb~246~ & & \verb~~\\
\cellcolor{gray} &  & \verb~247~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~248~ & & \verb~                    throw;~\\
\cellcolor{gray} &  & \verb~249~ & & \verb~                }~\\
\cellcolor{gray} &  & \verb~250~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~251~ & & \verb~            else~\\
\cellcolor{red} & 0 & \verb~252~ & & \verb~            {~\\
\cellcolor{red} & 0 & \verb~253~ & & \verb~                return base.SaveChanges();~\\
\cellcolor{gray} &  & \verb~254~ & & \verb~            }~\\
\cellcolor{green} & 1 & \verb~255~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~256~ & & \verb~~\\
\cellcolor{gray} &  & \verb~257~ & & \verb~        public virtual async Task<int> SaveChangesAsync(string user)~\\
\cellcolor{green} & 1 & \verb~258~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~259~ & & \verb~            if (AuditEnabled)~\\
\cellcolor{green} & 1 & \verb~260~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~261~ & & \verb~                var audits = CreateAuditRecords(user);~\\
\cellcolor{gray} &  & \verb~262~ & & \verb~~\\
\cellcolor{gray} &  & \verb~263~ & & \verb~                // Perform the updates.~\\
\cellcolor{gray} &  & \verb~264~ & & \verb~                try~\\
\cellcolor{green} & 1 & \verb~265~ & & \verb~                {~\\
\cellcolor{green} & 1 & \verb~266~ & & \verb~                    return await base.SaveChangesAsync();~\\
\cellcolor{gray} &  & \verb~267~ & & \verb~                }~\\
\cellcolor{red} & 0 & \verb~268~ & & \verb~                catch (Exception)~\\
\cellcolor{red} & 0 & \verb~269~ & & \verb~                {~\\
\cellcolor{gray} &  & \verb~270~ & & \verb~                    // Updated failed so remove the audit entities.~\\
\cellcolor{red} & 0 & \verb~271~ & & \verb~                    foreach (var item in audits)~\\
\cellcolor{red} & 0 & \verb~272~ & & \verb~                    {~\\
\cellcolor{red} & 0 & \verb~273~ & & \verb~                        this.Set(item.GetType()).Remove(item);~\\
\cellcolor{red} & 0 & \verb~274~ & & \verb~                    }~\\
\cellcolor{gray} &  & \verb~275~ & & \verb~~\\
\cellcolor{gray} &  & \verb~276~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~277~ & & \verb~                    throw;~\\
\cellcolor{gray} &  & \verb~278~ & & \verb~                }~\\
\cellcolor{gray} &  & \verb~279~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~280~ & & \verb~            else~\\
\cellcolor{red} & 0 & \verb~281~ & & \verb~            {~\\
\cellcolor{red} & 0 & \verb~282~ & & \verb~                return await base.SaveChangesAsync();~\\
\cellcolor{gray} &  & \verb~283~ & & \verb~            }~\\
\cellcolor{green} & 1 & \verb~284~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~285~ & & \verb~~\\
\cellcolor{gray} &  & \verb~286~ & & \verb~        private List<IAuditEntity> CreateAuditRecords(string user)~\\
\cellcolor{green} & 1 & \verb~287~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~288~ & & \verb~            // Track all audit entities created in this transaction, will be r~\\
\cellcolor{green} & 1 & \verb~289~ & & \verb~            List<IAuditEntity> audits = new List<IAuditEntity>();~\\
\cellcolor{gray} &  & \verb~290~ & & \verb~~\\
\cellcolor{gray} &  & \verb~291~ & & \verb~            // Use the same datetime for all updates in this transaction, retr~\\
\cellcolor{green} & 1 & \verb~292~ & & \verb~            DateTimeOffset? updateDateTime = null;~\\
\cellcolor{gray} &  & \verb~293~ & & \verb~~\\
\cellcolor{gray} &  & \verb~294~ & & \verb~            // Process any auditable objects.~\\
\cellcolor{green} & 1 & \verb~295~ & & \verb~            foreach (DbEntityEntry<IAuditableEntity> auditable in this.ChangeT~\\
\cellcolor{green} & 1 & \verb~296~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~297~ & & \verb~                if (auditable.State == EntityState.Added~\\
\cellcolor{green} & 1 & \verb~298~ & & \verb~                    || auditable.State == EntityState.Modified~\\
\cellcolor{green} & 1 & \verb~299~ & & \verb~                    || auditable.State == EntityState.Deleted)~\\
\cellcolor{green} & 1 & \verb~300~ & & \verb~                {~\\
\cellcolor{gray} &  & \verb~301~ & & \verb~                    // Need datetime for the audits.~\\
\cellcolor{green} & 1 & \verb~302~ & & \verb~                    if (updateDateTime.HasValue == false)~\\
\cellcolor{green} & 1 & \verb~303~ & & \verb~                    {~\\
\cellcolor{gray} &  & \verb~304~ & & \verb~                        try~\\
\cellcolor{green} & 1 & \verb~305~ & & \verb~                        {~\\
\cellcolor{green} & 1 & \verb~306~ & & \verb~                            updateDateTime = this.Database.SqlQuery<DateTimeOf~\\
\cellcolor{green} & 1 & \verb~307~ & & \verb~                        }~\\
\cellcolor{green} & 1 & \verb~308~ & & \verb~                        catch (Exception)~\\
\cellcolor{green} & 1 & \verb~309~ & & \verb~                        {~\\
\cellcolor{green} & 1 & \verb~310~ & & \verb~                            updateDateTime = DateTimeOffset.Now;~\\
\cellcolor{green} & 1 & \verb~311~ & & \verb~                        }~\\
\cellcolor{green} & 1 & \verb~312~ & & \verb~                    }~\\
\cellcolor{gray} &  & \verb~313~ & & \verb~~\\
\cellcolor{gray} &  & \verb~314~ & & \verb~                    // Create an audit entity.~\\
\cellcolor{green} & 1 & \verb~315~ & & \verb~                    if (auditable.State == EntityState.Modified~\\
\cellcolor{green} & 1 & \verb~316~ & & \verb~                        || auditable.State == EntityState.Deleted)~\\
\cellcolor{green} & 1 & \verb~317~ & & \verb~                    {~\\
\cellcolor{gray} &  & \verb~318~ & & \verb~                        // TODO: Find a better way of doing this proxy check.~\\
\cellcolor{green} & 1 & \verb~319~ & & \verb~                        Type entityType = auditable.Entity.GetType();~\\
\cellcolor{green} & 1 & \verb~320~ & & \verb~                        if (entityType.Namespace == "System.Data.Entity.Dynami~\\
\cellcolor{green} & 1 & \verb~321~ & & \verb~                        {~\\
\cellcolor{green} & 1 & \verb~322~ & & \verb~                            entityType = entityType.BaseType;~\\
\cellcolor{green} & 1 & \verb~323~ & & \verb~                        }~\\
\cellcolor{gray} &  & \verb~324~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~325~ & & \verb~                        if (auditTypes.ContainsKey(entityType) && auditTypes[e~\\
\cellcolor{green} & 1 & \verb~326~ & & \verb~                        {~\\
\cellcolor{green} & 1 & \verb~327~ & & \verb~                            audits.Add(this.AuditEntity(auditable, auditTypes[~\\
\cellcolor{green} & 1 & \verb~328~ & & \verb~                        }~\\
\cellcolor{green} & 1 & \verb~329~ & & \verb~                    }~\\
\cellcolor{gray} &  & \verb~330~ & & \verb~~\\
\cellcolor{gray} &  & \verb~331~ & & \verb~                    // Update the auditable entity.~\\
\cellcolor{green} & 1 & \verb~332~ & & \verb~                    if (auditable.State != EntityState.Deleted)~\\
\cellcolor{green} & 1 & \verb~333~ & & \verb~                    {~\\
\cellcolor{green} & 1 & \verb~334~ & & \verb~                        auditable.Entity.Updated = updateDateTime.Value;~\\
\cellcolor{green} & 1 & \verb~335~ & & \verb~                        auditable.Entity.UpdateUser = user;~\\
\cellcolor{green} & 1 & \verb~336~ & & \verb~                    }~\\
\cellcolor{green} & 1 & \verb~337~ & & \verb~                }~\\
\cellcolor{green} & 1 & \verb~338~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~339~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~340~ & & \verb~            return audits;~\\
\cellcolor{green} & 1 & \verb~341~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~342~ & & \verb~~\\
\cellcolor{gray} &  & \verb~343~ & & \verb~        private IAuditEntity AuditEntity(DbEntityEntry entityEntry, AuditTypeI~\\
\cellcolor{green} & 1 & \verb~344~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~345~ & & \verb~            // Create audit entity.~\\
\cellcolor{green} & 1 & \verb~346~ & & \verb~            DbSet set = this.Set(auditTypeInfo.AuditEntityType);~\\
\cellcolor{green} & 1 & \verb~347~ & & \verb~            IAuditEntity auditEntity = set.Create() as IAuditEntity;~\\
\cellcolor{gray} &  & \verb~348~ & & \verb~~\\
\cellcolor{gray} &  & \verb~349~ & & \verb~            // Check audit entity for complex types.~\\
\cellcolor{green} & 1 & \verb~350~ & & \verb~            var complexTypes = GetComplexTypes(auditTypeInfo, entityEntry);~\\
\cellcolor{gray} &  & \verb~351~ & & \verb~~\\
\cellcolor{gray} &  & \verb~352~ & & \verb~            //Instantiate complex types.~\\
\cellcolor{green} & 1 & \verb~353~ & & \verb~            foreach (var field in complexTypes)~\\
\cellcolor{red} & 0 & \verb~354~ & & \verb~            {~\\
\cellcolor{red} & 0 & \verb~355~ & & \verb~                var property = auditEntity.GetType().GetProperty(field);~\\
\cellcolor{red} & 0 & \verb~356~ & & \verb~                var entityType = property.PropertyType;~\\
\cellcolor{red} & 0 & \verb~357~ & & \verb~                property.SetValue(auditEntity, Activator.CreateInstance(entity~\\
\cellcolor{red} & 0 & \verb~358~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~359~ & & \verb~~\\
\cellcolor{gray} &  & \verb~360~ & & \verb~            //Attach audit Entity to the context.~\\
\cellcolor{green} & 1 & \verb~361~ & & \verb~            set.Add(auditEntity);~\\
\cellcolor{gray} &  & \verb~362~ & & \verb~~\\
\cellcolor{gray} &  & \verb~363~ & & \verb~            // Copy the properties.~\\
\cellcolor{green} & 1 & \verb~364~ & & \verb~            DbEntityEntry auditEntityEntry = this.Entry(auditEntity);~\\
\cellcolor{green} & 1 & \verb~365~ & & \verb~            foreach (string propertyName in auditTypeInfo.AuditProperties)~\\
\cellcolor{green} & 1 & \verb~366~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~367~ & & \verb~                auditEntityEntry.Property(propertyName).CurrentValue = entityE~\\
\cellcolor{green} & 1 & \verb~368~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~369~ & & \verb~~\\
\cellcolor{gray} &  & \verb~370~ & & \verb~            // Set the audit columns.~\\
\cellcolor{green} & 1 & \verb~371~ & & \verb~            auditEntityEntry.Property(AuditUpdatedColumnName).CurrentValue = a~\\
\cellcolor{green} & 1 & \verb~372~ & & \verb~            auditEntityEntry.Property(AuditUserColumnName).CurrentValue = user~\\
\cellcolor{green} & 1 & \verb~373~ & & \verb~            auditEntityEntry.Property(AuditTypeColumnName).CurrentValue = enti~\\
\cellcolor{green} & 1 & \verb~374~ & & \verb~            auditEntityEntry.Property(AuditSourceIdColumnName).CurrentValue = ~\\
\cellcolor{gray} &  & \verb~375~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~376~ & & \verb~            return auditEntity;~\\
\cellcolor{green} & 1 & \verb~377~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~378~ & & \verb~~\\
\cellcolor{gray} &  & \verb~379~ & & \verb~        /// <summary>~\\
\cellcolor{gray} &  & \verb~380~ & & \verb~        /// Checks the destination object for complex types. Returns a list of~\\
\cellcolor{gray} &  & \verb~381~ & & \verb~        /// </summary>~\\
\cellcolor{gray} &  & \verb~382~ & & \verb~        /// <param name="auditTypeInfo"></param>~\\
\cellcolor{gray} &  & \verb~383~ & & \verb~        /// <param name="entityEntry"></param>~\\
\cellcolor{gray} &  & \verb~384~ & & \verb~        /// <returns></returns>~\\
\cellcolor{gray} &  & \verb~385~ & & \verb~        private ICollection<string> GetComplexTypes(AuditTypeInfo auditTypeInf~\\
\cellcolor{green} & 1 & \verb~386~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~387~ & & \verb~            var returnValue = new List<string>();~\\
\cellcolor{gray} &  & \verb~388~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~389~ & & \verb~            foreach (string propertyName in auditTypeInfo.AuditProperties)~\\
\cellcolor{green} & 1 & \verb~390~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~391~ & & \verb~                if (entityEntry.Property(propertyName).GetType().Name.Contains~\\
\cellcolor{red} & 0 & \verb~392~ & & \verb~                {~\\
\cellcolor{red} & 0 & \verb~393~ & & \verb~                    returnValue.Add(propertyName);~\\
\cellcolor{red} & 0 & \verb~394~ & & \verb~                }~\\
\cellcolor{green} & 1 & \verb~395~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~396~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~397~ & & \verb~            return returnValue;~\\
\cellcolor{green} & 1 & \verb~398~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~399~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~400~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Auditing.AuditEntity}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Auditing.AuditEntity\\
\textbf{Assembly:} & entityframework.auditing.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{C:\textbackslash Development\textbackslash EntityFrameworkRepository6\textbackslash AuditDbContextLocal\textbackslash AuditEntity.cs}\end{minipage} \\
\textbf{Covered lines:} & 6\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 6\\
\textbf{Total lines:} & 55\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{File(s)}
\subsubsection{C:\textbackslash Development\textbackslash EntityFrameworkRepository6\textbackslash AuditDbContextLocal\textbackslash AuditEntity.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~//-----------------------------------------------------------------------~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~// <copyright file="AuditEntity.cs" company="Russell Wilkins">~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~//     Copyright (c) Russell Wilkins 2012. All Rights Reserved.~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~// </copyright>~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~// <author>Russell Wilkins</author>~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~// <license href="license.txt">~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~//     The use of this software is governed by the Microsoft Public License~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~//     which is included with this distribution.~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~// </license>~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~//-----------------------------------------------------------------------~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~namespace EntityFramework.Auditing~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~    using System;~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~    using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    using System.Linq;~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    using System.Text;~\\
\cellcolor{gray} &  & \verb~17~ & & \verb~~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~    /// <summary>~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~    /// Base class for audit entities.~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~    /// </summary>~\\
\cellcolor{gray} &  & \verb~21~ & & \verb~    public abstract class AuditEntity : IAuditEntity~\\
\cellcolor{gray} &  & \verb~22~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~        /// <summary>~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~        /// Gets or sets the DateTime the entity was last updated.~\\
\cellcolor{gray} &  & \verb~25~ & & \verb~        /// Will be automatically set by AuditDbContext on SaveChanges.~\\
\cellcolor{gray} &  & \verb~26~ & & \verb~        /// </summary>~\\
\cellcolor{green} & 1 & \verb~27~ & & \verb~        public virtual DateTimeOffset Updated { get; set; }~\\
\cellcolor{gray} &  & \verb~28~ & & \verb~~\\
\cellcolor{gray} &  & \verb~29~ & & \verb~        /// <summary>~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~        /// Gets or sets the User who last updated the entity on the database.~\\
\cellcolor{gray} &  & \verb~31~ & & \verb~        /// Will be automatically set by AuditDbContext on SaveChanges.~\\
\cellcolor{gray} &  & \verb~32~ & & \verb~        /// </summary>~\\
\cellcolor{green} & 1 & \verb~33~ & & \verb~        public virtual string UpdateUser { get; set; }~\\
\cellcolor{gray} &  & \verb~34~ & & \verb~~\\
\cellcolor{gray} &  & \verb~35~ & & \verb~        /// <summary>~\\
\cellcolor{gray} &  & \verb~36~ & & \verb~        /// Gets or sets the DateTime this audit entity was created.~\\
\cellcolor{gray} &  & \verb~37~ & & \verb~        /// Will be automatically set by AuditDbContext on SaveChanges.~\\
\cellcolor{gray} &  & \verb~38~ & & \verb~        /// </summary>~\\
\cellcolor{green} & 1 & \verb~39~ & & \verb~        public virtual DateTimeOffset Audited { get; set; }~\\
\cellcolor{gray} &  & \verb~40~ & & \verb~~\\
\cellcolor{gray} &  & \verb~41~ & & \verb~        /// <summary>~\\
\cellcolor{gray} &  & \verb~42~ & & \verb~        /// Gets or sets the user who updated the entity~\\
\cellcolor{gray} &  & \verb~43~ & & \verb~        /// Will be automatically set by AuditDbContext on SaveChanges.~\\
\cellcolor{gray} &  & \verb~44~ & & \verb~        /// </summary>~\\
\cellcolor{green} & 1 & \verb~45~ & & \verb~        public virtual string AuditUser { get; set; }~\\
\cellcolor{gray} &  & \verb~46~ & & \verb~~\\
\cellcolor{gray} &  & \verb~47~ & & \verb~        /// <summary>~\\
\cellcolor{gray} &  & \verb~48~ & & \verb~        /// Gets or sets the type of audit. update or delete.~\\
\cellcolor{gray} &  & \verb~49~ & & \verb~        /// Will be automatically set by AuditDbContext on SaveChanges.~\\
\cellcolor{gray} &  & \verb~50~ & & \verb~        /// </summary>~\\
\cellcolor{green} & 1 & \verb~51~ & & \verb~        public virtual string AuditType { get; set; }~\\
\cellcolor{gray} &  & \verb~52~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~53~ & & \verb~        public virtual int AuditSourceId { get; set; }~\\
\cellcolor{gray} &  & \verb~54~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~55~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Auditing.AuditTypeInfo}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Auditing.AuditTypeInfo\\
\textbf{Assembly:} & entityframework.auditing.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{C:\textbackslash Development\textbackslash EntityFrameworkRepository6\textbackslash AuditDbContextLocal\textbackslash AuditTypeInfo.cs}\end{minipage} \\
\textbf{Covered lines:} & 7\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 7\\
\textbf{Total lines:} & 33\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{AuditTypeInfo()} & 4 & 0\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{C:\textbackslash Development\textbackslash EntityFrameworkRepository6\textbackslash AuditDbContextLocal\textbackslash AuditTypeInfo.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~//-----------------------------------------------------------------------~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~// <copyright file="AuditTypeInfo.cs" company="Russell Wilkins">~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~//     Copyright (c) Russell Wilkins 2012. All Rights Reserved.~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~// </copyright>~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~// <author>Russell Wilkins</author>~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~// <license href="license.txt">~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~//     The use of this software is governed by the Microsoft Public License~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~//     which is included with this distribution.~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~// </license>~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~//-----------------------------------------------------------------------~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~namespace EntityFramework.Auditing~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~    using System;~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~    using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    using System.Collections.ObjectModel;~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~~\\
\cellcolor{gray} &  & \verb~17~ & & \verb~    internal class AuditTypeInfo~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~        /// <summary>~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~        /// Initializes a new instance of the AuditTypeInfo class.~\\
\cellcolor{gray} &  & \verb~21~ & & \verb~        /// </summary>~\\
\cellcolor{green} & 1 & \verb~22~ & & \verb~        internal AuditTypeInfo()~\\
\cellcolor{green} & 1 & \verb~23~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~24~ & & \verb~            this.AuditProperties = new Collection<string>();~\\
\cellcolor{green} & 1 & \verb~25~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~26~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~27~ & & \verb~        internal Type EntityType { get; set; }~\\
\cellcolor{gray} &  & \verb~28~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~29~ & & \verb~        internal Type AuditEntityType { get; set; }~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~31~ & & \verb~        internal Collection<string> AuditProperties { get; set; }~\\
\cellcolor{gray} &  & \verb~32~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~33~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Auditing.EntityElement}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Auditing.EntityElement\\
\textbf{Assembly:} & entityframework.auditing.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{\textbackslash EntityFrameworkRepository6\textbackslash AuditDbContextLocal\textbackslash Configuration\textbackslash EntityElement.cs}\end{minipage} \\
\textbf{Covered lines:} & 6\\
\textbf{Uncovered lines:} & 6\\
\textbf{Coverable lines:} & 12\\
\textbf{Total lines:} & 45\\
\textbf{Line coverage:} & 50\%\\
\end{longtable}
\subsection{File(s)}
\subsubsection{\textbackslash EntityFrameworkRepository6\textbackslash AuditDbContextLocal\textbackslash Configuration\textbackslash EntityElement.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~//-----------------------------------------------------------------------~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~// <copyright file="EntityElement.cs" company="Russell Wilkins">~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~//     Copyright (c) Russell Wilkins 2012. All Rights Reserved.~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~// </copyright>~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~// <author>Russell Wilkins</author>~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~// <license href="license.txt">~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~//     The use of this software is governed by the Microsoft Public License~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~//     which is included with this distribution.~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~// </license>~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~//-----------------------------------------------------------------------~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~namespace EntityFramework.Auditing~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~    using System.Configuration;~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    internal class EntityElement : ConfigurationElement~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~17~ & & \verb~        [ConfigurationProperty("name", IsRequired = false)]~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~        internal string Name~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~            get~\\
\cellcolor{green} & 1 & \verb~21~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~22~ & & \verb~                return (string)this["name"];~\\
\cellcolor{green} & 1 & \verb~23~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~~\\
\cellcolor{gray} &  & \verb~25~ & & \verb~            set~\\
\cellcolor{red} & 0 & \verb~26~ & & \verb~            {~\\
\cellcolor{red} & 0 & \verb~27~ & & \verb~                this["name"] = value;~\\
\cellcolor{red} & 0 & \verb~28~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~29~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~~\\
\cellcolor{gray} &  & \verb~31~ & & \verb~        [ConfigurationProperty("audit", IsRequired = false)]~\\
\cellcolor{gray} &  & \verb~32~ & & \verb~        internal string Audit~\\
\cellcolor{gray} &  & \verb~33~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~34~ & & \verb~            get~\\
\cellcolor{green} & 1 & \verb~35~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~36~ & & \verb~                return (string)this["audit"];~\\
\cellcolor{green} & 1 & \verb~37~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~38~ & & \verb~~\\
\cellcolor{gray} &  & \verb~39~ & & \verb~            set~\\
\cellcolor{red} & 0 & \verb~40~ & & \verb~            {~\\
\cellcolor{red} & 0 & \verb~41~ & & \verb~                this["audit"] = value;~\\
\cellcolor{red} & 0 & \verb~42~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~43~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~44~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~45~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Auditing.EntityElementCollection}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Auditing.EntityElementCollection\\
\textbf{Assembly:} & entityframework.auditing.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{meworkRepository6\textbackslash AuditDbContextLocal\textbackslash Configuration\textbackslash EntityElementCollection.cs}\end{minipage} \\
\textbf{Covered lines:} & 6\\
\textbf{Uncovered lines:} & 10\\
\textbf{Coverable lines:} & 16\\
\textbf{Total lines:} & 45\\
\textbf{Line coverage:} & 37.5\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{CreateNewElement()} & 3 & 0\\
\hline
\textbf{GetElementKey(System} & 3 & 0\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{meworkRepository6\textbackslash AuditDbContextLocal\textbackslash Configuration\textbackslash EntityElementCollection.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~//-----------------------------------------------------------------------~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~// <copyright file="EntityElementCollection.cs" company="Russell Wilkins">~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~//     Copyright (c) Russell Wilkins 2012. All Rights Reserved.~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~// </copyright>~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~// <author>Russell Wilkins</author>~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~// <license href="license.txt">~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~//     The use of this software is governed by the Microsoft Public License~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~//     which is included with this distribution.~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~// </license>~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~//-----------------------------------------------------------------------~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~namespace EntityFramework.Auditing~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~    using System.Configuration;~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    internal class EntityElementCollection : ConfigurationElementCollection~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~17~ & & \verb~        internal EntityElement this[int index]~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~            get~\\
\cellcolor{red} & 0 & \verb~20~ & & \verb~            {~\\
\cellcolor{red} & 0 & \verb~21~ & & \verb~                return (EntityElement)BaseGet(index);~\\
\cellcolor{red} & 0 & \verb~22~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~            set~\\
\cellcolor{red} & 0 & \verb~25~ & & \verb~            {~\\
\cellcolor{red} & 0 & \verb~26~ & & \verb~                if (BaseGet(index) != null)~\\
\cellcolor{red} & 0 & \verb~27~ & & \verb~                {~\\
\cellcolor{red} & 0 & \verb~28~ & & \verb~                    BaseRemoveAt(index);~\\
\cellcolor{red} & 0 & \verb~29~ & & \verb~                }~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~31~ & & \verb~                BaseAdd(index, value);~\\
\cellcolor{red} & 0 & \verb~32~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~33~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~34~ & & \verb~~\\
\cellcolor{gray} &  & \verb~35~ & & \verb~        protected override ConfigurationElement CreateNewElement()~\\
\cellcolor{green} & 1 & \verb~36~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~37~ & & \verb~            return new EntityElement();~\\
\cellcolor{green} & 1 & \verb~38~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~39~ & & \verb~~\\
\cellcolor{gray} &  & \verb~40~ & & \verb~        protected override object GetElementKey(ConfigurationElement element)~\\
\cellcolor{green} & 1 & \verb~41~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~42~ & & \verb~            return ((EntityElement)element).Name;~\\
\cellcolor{green} & 1 & \verb~43~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~44~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~45~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Auditing.Test.AuditDbTest}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Auditing.Test.AuditDbTest\\
\textbf{Assembly:} & entityframework.auditing.test.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{C:\textbackslash Development\textbackslash EntityFrameworkRepository6\textbackslash AuditDbContextTests\textbackslash AuditDbTest.cs}\end{minipage} \\
\textbf{Covered lines:} & 246\\
\textbf{Uncovered lines:} & 35\\
\textbf{Coverable lines:} & 281\\
\textbf{Total lines:} & 483\\
\textbf{Line coverage:} & 87.5\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{AuditDbTest()} & 5 & 0\\
\hline
\textbf{MyClassInitialize(Mi} & 3 & 0\\
\hline
\textbf{MyClassCleanup()} & 1 & 0\\
\hline
\textbf{MyTestInitialize()} & 1 & 0\\
\hline
\textbf{MyTestCleanup()} & 2 & 0\\
\hline
\textbf{CreateContext(bool)} & 7 & 0\\
\hline
\textbf{ClearDatabase()} & 19 & 3\\
\hline
\textbf{CreateTestNoProxy()} & 5 & 0\\
\hline
\textbf{CreateTestProxy()} & 5 & 0\\
\hline
\textbf{CreateTest(EntityFra} & 36 & 1\\
\hline
\textbf{ProxiesFalseTest()} & 4 & 0\\
\hline
\textbf{ProxiesTrueTest()} & 4 & 0\\
\hline
\textbf{ConcurrencyTest()} & 27 & 1\\
\hline
\textbf{UpdateTestNoProxy()} & 3 & 0\\
\hline
\textbf{UpdateTestProxy()} & 3 & 0\\
\hline
\textbf{UpdateTest(EntityFra} & 47 & 0\\
\hline
\textbf{DeleteTestNoProxy()} & 3 & 0\\
\hline
\textbf{DeleteTestProxy()} & 3 & 0\\
\hline
\textbf{GetConnection()} & 9 & 0\\
\hline
\textbf{DeleteTest(EntityFra} & 48 & 1\\
\hline
\textbf{RegisterAuditTypeTes} & 5 & 0\\
\hline
\textbf{RegisterAuditTypeTwi} & 7 & 1\\
\hline
\textbf{RegisterAuditTypeEnt} & 4 & 1\\
\hline
\textbf{RegisterAuditTypeEnt} & 4 & 1\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{C:\textbackslash Development\textbackslash EntityFrameworkRepository6\textbackslash AuditDbContextTests\textbackslash AuditDbTest.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using System.Configuration;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System.Data;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using System.Text;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using Microsoft.VisualStudio.TestTools.UnitTesting;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~using System.Data.Entity;~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~using System.Data.SqlClient;~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~using System.Data.Entity.Infrastructure;~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~using System.Data.SqlServerCe;~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~using System.IO;~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~using System.Data.Common;~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~using System.ComponentModel.DataAnnotations.Schema;~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~namespace EntityFramework.Auditing.Test~\\
\cellcolor{gray} &  & \verb~17~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~    /// <summary>~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~    /// Summary description for CodeFirstTest~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~    /// </summary>~\\
\cellcolor{gray} &  & \verb~21~ & & \verb~    [TestClass]~\\
\cellcolor{gray} &  & \verb~22~ & & \verb~    public class AuditDbTest~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~24~ & & \verb~        public AuditDbTest()~\\
\cellcolor{green} & 1 & \verb~25~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~26~ & & \verb~            //~\\
\cellcolor{gray} &  & \verb~27~ & & \verb~            // TODO: Add constructor logic here~\\
\cellcolor{gray} &  & \verb~28~ & & \verb~            //~\\
\cellcolor{green} & 1 & \verb~29~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~~\\
\cellcolor{gray} &  & \verb~31~ & & \verb~        private TestContext testContextInstance;~\\
\cellcolor{gray} &  & \verb~32~ & & \verb~~\\
\cellcolor{gray} &  & \verb~33~ & & \verb~        /// <summary>~\\
\cellcolor{gray} &  & \verb~34~ & & \verb~        ///Gets or sets the test context which provides~\\
\cellcolor{gray} &  & \verb~35~ & & \verb~        ///information about and functionality for the current test run.~\\
\cellcolor{gray} &  & \verb~36~ & & \verb~        ///</summary>~\\
\cellcolor{gray} &  & \verb~37~ & & \verb~        public TestContext TestContext~\\
\cellcolor{gray} &  & \verb~38~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~39~ & & \verb~            get~\\
\cellcolor{red} & 0 & \verb~40~ & & \verb~            {~\\
\cellcolor{red} & 0 & \verb~41~ & & \verb~                return testContextInstance;~\\
\cellcolor{red} & 0 & \verb~42~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~43~ & & \verb~            set~\\
\cellcolor{green} & 1 & \verb~44~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~45~ & & \verb~                testContextInstance = value;~\\
\cellcolor{green} & 1 & \verb~46~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~47~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~48~ & & \verb~~\\
\cellcolor{gray} &  & \verb~49~ & & \verb~        #region Additional test attributes~\\
\cellcolor{gray} &  & \verb~50~ & & \verb~        //~\\
\cellcolor{gray} &  & \verb~51~ & & \verb~        // You can use the following additional attributes as you write your t~\\
\cellcolor{gray} &  & \verb~52~ & & \verb~        //~\\
\cellcolor{gray} &  & \verb~53~ & & \verb~        // Use ClassInitialize to run code before running the first test in th~\\
\cellcolor{gray} &  & \verb~54~ & & \verb~        [ClassInitialize()]~\\
\cellcolor{gray} &  & \verb~55~ & & \verb~        public static void MyClassInitialize(TestContext testContext)~\\
\cellcolor{green} & 1 & \verb~56~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~57~ & & \verb~            //File.Delete(Path.GetDirectoryName(System.Reflection.Assembly.Get~\\
\cellcolor{green} & 1 & \verb~58~ & & \verb~            var initializer = new DropCreateDatabaseAlways<Context>();~\\
\cellcolor{green} & 1 & \verb~59~ & & \verb~            Database.SetInitializer<Context>(initializer);~\\
\cellcolor{gray} &  & \verb~60~ & & \verb~            //Database.DefaultConnectionFactory = new SqlCeConnectionFactory("~\\
\cellcolor{green} & 1 & \verb~61~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~62~ & & \verb~~\\
\cellcolor{gray} &  & \verb~63~ & & \verb~        //~\\
\cellcolor{gray} &  & \verb~64~ & & \verb~        // Use ClassCleanup to run code after all tests in a class have run~\\
\cellcolor{gray} &  & \verb~65~ & & \verb~        [ClassCleanup()]~\\
\cellcolor{gray} &  & \verb~66~ & & \verb~        public static void MyClassCleanup()~\\
\cellcolor{green} & 1 & \verb~67~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~68~ & & \verb~            //File.Delete(Path.GetDirectoryName(System.Reflection.Assembly.Get~\\
\cellcolor{green} & 1 & \verb~69~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~70~ & & \verb~~\\
\cellcolor{gray} &  & \verb~71~ & & \verb~        //~\\
\cellcolor{gray} &  & \verb~72~ & & \verb~        // Use TestInitialize to run code before running each test~\\
\cellcolor{gray} &  & \verb~73~ & & \verb~        [TestInitialize()]~\\
\cellcolor{gray} &  & \verb~74~ & & \verb~        public void MyTestInitialize()~\\
\cellcolor{green} & 1 & \verb~75~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~76~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~77~ & & \verb~~\\
\cellcolor{gray} &  & \verb~78~ & & \verb~        //~\\
\cellcolor{gray} &  & \verb~79~ & & \verb~        // Use TestCleanup to run code after each test has run~\\
\cellcolor{gray} &  & \verb~80~ & & \verb~        [TestCleanup()]~\\
\cellcolor{gray} &  & \verb~81~ & & \verb~        public void MyTestCleanup()~\\
\cellcolor{green} & 1 & \verb~82~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~83~ & & \verb~            this.ClearDatabase();~\\
\cellcolor{green} & 1 & \verb~84~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~85~ & & \verb~~\\
\cellcolor{gray} &  & \verb~86~ & & \verb~        #endregion~\\
\cellcolor{gray} &  & \verb~87~ & & \verb~~\\
\cellcolor{gray} &  & \verb~88~ & & \verb~        private Context CreateContext(bool withProxies)~\\
\cellcolor{green} & 1 & \verb~89~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~90~ & & \verb~            this.ClearDatabase();~\\
\cellcolor{green} & 1 & \verb~91~ & & \verb~            Context context = new Context(withProxies, contextConnectionString~\\
\cellcolor{green} & 1 & \verb~92~ & & \verb~            context.SaveChanges();~\\
\cellcolor{green} & 1 & \verb~93~ & & \verb~            Assert.AreEqual(withProxies, context.Proxies);~\\
\cellcolor{green} & 1 & \verb~94~ & & \verb~            return context;~\\
\cellcolor{green} & 1 & \verb~95~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~96~ & & \verb~~\\
\cellcolor{gray} &  & \verb~97~ & & \verb~        //string contextConnectionString = "AuditDbContextUnitTest";~\\
\cellcolor{gray} &  & \verb~98~ & & \verb~        //string sqlConnectionString = @"Data Source=|DataDirectory|\AuditDbCo~\\
\cellcolor{green} & 1 & \verb~99~ & & \verb~        string user = "UnitTest";~\\
\cellcolor{gray} &  & \verb~100~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~101~ & & \verb~        private string contextConnectionString = ConfigurationManager.Connecti~\\
\cellcolor{gray} &  & \verb~102~ & & \verb~~\\
\cellcolor{gray} &  & \verb~103~ & & \verb~        private void ClearDatabase()~\\
\cellcolor{green} & 1 & \verb~104~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~105~ & & \verb~            try~\\
\cellcolor{green} & 1 & \verb~106~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~107~ & & \verb~                using (DbConnection sqlConn = this.GetConnection())~\\
\cellcolor{green} & 1 & \verb~108~ & & \verb~                {~\\
\cellcolor{green} & 1 & \verb~109~ & & \verb~                    if (sqlConn.State == ConnectionState.Closed)~\\
\cellcolor{red} & 0 & \verb~110~ & & \verb~                    {~\\
\cellcolor{red} & 0 & \verb~111~ & & \verb~                        sqlConn.Open();~\\
\cellcolor{red} & 0 & \verb~112~ & & \verb~                    }~\\
\cellcolor{green} & 1 & \verb~113~ & & \verb~                    using (DbCommand cmd = sqlConn.CreateCommand())~\\
\cellcolor{green} & 1 & \verb~114~ & & \verb~                    {~\\
\cellcolor{green} & 1 & \verb~115~ & & \verb~                        cmd.CommandText = "truncate table customers";~\\
\cellcolor{green} & 1 & \verb~116~ & & \verb~                        cmd.ExecuteNonQuery();~\\
\cellcolor{green} & 1 & \verb~117~ & & \verb~                    }~\\
\cellcolor{green} & 1 & \verb~118~ & & \verb~                    using (DbCommand cmd = sqlConn.CreateCommand())~\\
\cellcolor{green} & 1 & \verb~119~ & & \verb~                    {~\\
\cellcolor{green} & 1 & \verb~120~ & & \verb~                        cmd.CommandText = "truncate table customeraudits";~\\
\cellcolor{green} & 1 & \verb~121~ & & \verb~                        cmd.ExecuteNonQuery();~\\
\cellcolor{green} & 1 & \verb~122~ & & \verb~                    }~\\
\cellcolor{green} & 1 & \verb~123~ & & \verb~                    sqlConn.Close();~\\
\cellcolor{green} & 1 & \verb~124~ & & \verb~                }~\\
\cellcolor{green} & 1 & \verb~125~ & & \verb~            }~\\
\cellcolor{red} & 0 & \verb~126~ & & \verb~            catch { }~\\
\cellcolor{green} & 1 & \verb~127~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~128~ & & \verb~~\\
\cellcolor{gray} &  & \verb~129~ & & \verb~        [TestCategory("AuditDbContext")]~\\
\cellcolor{gray} &  & \verb~130~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~131~ & & \verb~        public void CreateTestNoProxy()~\\
\cellcolor{green} & 1 & \verb~132~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~133~ & & \verb~            using (Context context = this.CreateContext(false))~\\
\cellcolor{green} & 1 & \verb~134~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~135~ & & \verb~                this.CreateTest(context);~\\
\cellcolor{green} & 1 & \verb~136~ & & \verb~            }~\\
\cellcolor{green} & 1 & \verb~137~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~138~ & & \verb~~\\
\cellcolor{gray} &  & \verb~139~ & & \verb~        [TestCategory("AuditDbContext")]~\\
\cellcolor{gray} &  & \verb~140~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~141~ & & \verb~        public void CreateTestProxy()~\\
\cellcolor{green} & 1 & \verb~142~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~143~ & & \verb~            using (Context context = this.CreateContext(true))~\\
\cellcolor{green} & 1 & \verb~144~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~145~ & & \verb~                this.CreateTest(context);~\\
\cellcolor{green} & 1 & \verb~146~ & & \verb~            }~\\
\cellcolor{green} & 1 & \verb~147~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~148~ & & \verb~~\\
\cellcolor{gray} &  & \verb~149~ & & \verb~        private void CreateTest(Context context)~\\
\cellcolor{green} & 1 & \verb~150~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~151~ & & \verb~            // Add the customer~\\
\cellcolor{green} & 1 & \verb~152~ & & \verb~            Customer customer = context.Customers.Create();~\\
\cellcolor{green} & 1 & \verb~153~ & & \verb~            customer.CustomerName = "Customer 1";~\\
\cellcolor{green} & 1 & \verb~154~ & & \verb~            context.Customers.Add(customer);~\\
\cellcolor{green} & 1 & \verb~155~ & & \verb~            context.SaveChanges(user);~\\
\cellcolor{gray} &  & \verb~156~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~157~ & & \verb~            using (DbConnection conn = this.GetConnection())~\\
\cellcolor{green} & 1 & \verb~158~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~159~ & & \verb~                using (DbCommand cmd = conn.CreateCommand())~\\
\cellcolor{green} & 1 & \verb~160~ & & \verb~                {~\\
\cellcolor{green} & 1 & \verb~161~ & & \verb~                    cmd.CommandText = "select * from customers";~\\
\cellcolor{green} & 1 & \verb~162~ & & \verb~                    using (var r = cmd.ExecuteReader())~\\
\cellcolor{green} & 1 & \verb~163~ & & \verb~                    {~\\
\cellcolor{green} & 1 & \verb~164~ & & \verb~                        int records = 0;~\\
\cellcolor{green} & 1 & \verb~165~ & & \verb~                        while (r.Read())~\\
\cellcolor{green} & 1 & \verb~166~ & & \verb~                        {~\\
\cellcolor{green} & 1 & \verb~167~ & & \verb~                            records++;~\\
\cellcolor{green} & 1 & \verb~168~ & & \verb~                        }~\\
\cellcolor{green} & 1 & \verb~169~ & & \verb~                        r.Close();~\\
\cellcolor{green} & 1 & \verb~170~ & & \verb~                        Assert.AreEqual(1, records);~\\
\cellcolor{green} & 1 & \verb~171~ & & \verb~                    }~\\
\cellcolor{green} & 1 & \verb~172~ & & \verb~                }~\\
\cellcolor{gray} &  & \verb~173~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~174~ & & \verb~                using (DbCommand cmd = conn.CreateCommand())~\\
\cellcolor{green} & 1 & \verb~175~ & & \verb~                {~\\
\cellcolor{green} & 1 & \verb~176~ & & \verb~                    cmd.CommandText = "select * from customeraudits";~\\
\cellcolor{green} & 1 & \verb~177~ & & \verb~                    using (var r = cmd.ExecuteReader())~\\
\cellcolor{green} & 1 & \verb~178~ & & \verb~                    {~\\
\cellcolor{green} & 1 & \verb~179~ & & \verb~                        int records = 0;~\\
\cellcolor{green} & 1 & \verb~180~ & & \verb~                        while (r.Read())~\\
\cellcolor{red} & 0 & \verb~181~ & & \verb~                        {~\\
\cellcolor{red} & 0 & \verb~182~ & & \verb~                            records++;~\\
\cellcolor{red} & 0 & \verb~183~ & & \verb~                        }~\\
\cellcolor{green} & 1 & \verb~184~ & & \verb~                        r.Close();~\\
\cellcolor{green} & 1 & \verb~185~ & & \verb~                        Assert.AreEqual(0, records);~\\
\cellcolor{green} & 1 & \verb~186~ & & \verb~                    }~\\
\cellcolor{green} & 1 & \verb~187~ & & \verb~                }~\\
\cellcolor{green} & 1 & \verb~188~ & & \verb~                conn.Close();~\\
\cellcolor{green} & 1 & \verb~189~ & & \verb~            }~\\
\cellcolor{green} & 1 & \verb~190~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~191~ & & \verb~~\\
\cellcolor{gray} &  & \verb~192~ & & \verb~        [TestCategory("AuditDbContext")]~\\
\cellcolor{gray} &  & \verb~193~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~194~ & & \verb~        public void ProxiesFalseTest()~\\
\cellcolor{green} & 1 & \verb~195~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~196~ & & \verb~            Context context = new Context(false, contextConnectionString);~\\
\cellcolor{green} & 1 & \verb~197~ & & \verb~            Assert.IsFalse(context.Proxies);~\\
\cellcolor{green} & 1 & \verb~198~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~199~ & & \verb~~\\
\cellcolor{gray} &  & \verb~200~ & & \verb~        [TestCategory("AuditDbContext")]~\\
\cellcolor{gray} &  & \verb~201~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~202~ & & \verb~        public void ProxiesTrueTest()~\\
\cellcolor{green} & 1 & \verb~203~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~204~ & & \verb~            Context context = new Context(true, contextConnectionString);~\\
\cellcolor{green} & 1 & \verb~205~ & & \verb~            Assert.IsTrue(context.Proxies);~\\
\cellcolor{green} & 1 & \verb~206~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~207~ & & \verb~~\\
\cellcolor{gray} &  & \verb~208~ & & \verb~        [TestCategory("AuditDbContext")]~\\
\cellcolor{gray} &  & \verb~209~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~210~ & & \verb~        public void ConcurrencyTest()~\\
\cellcolor{green} & 1 & \verb~211~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~212~ & & \verb~            Context context1 = new Context(true, contextConnectionString);~\\
\cellcolor{green} & 1 & \verb~213~ & & \verb~            Context context2 = new Context(true, contextConnectionString);~\\
\cellcolor{gray} &  & \verb~214~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~215~ & & \verb~            Customer customer1 = context1.Customers.Create();~\\
\cellcolor{green} & 1 & \verb~216~ & & \verb~            customer1.CustomerName = "Customer 1";~\\
\cellcolor{green} & 1 & \verb~217~ & & \verb~            Customer customer3 = context1.Customers.Create();~\\
\cellcolor{green} & 1 & \verb~218~ & & \verb~            customer3.CustomerName = "Customer 3";~\\
\cellcolor{green} & 1 & \verb~219~ & & \verb~            context1.Customers.Add(customer3);~\\
\cellcolor{green} & 1 & \verb~220~ & & \verb~            context1.Customers.Add(customer1);~\\
\cellcolor{green} & 1 & \verb~221~ & & \verb~            context1.SaveChanges(user);~\\
\cellcolor{gray} &  & \verb~222~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~223~ & & \verb~            Customer customer2 = context2.Customers.Find(customer1.Id);~\\
\cellcolor{green} & 1 & \verb~224~ & & \verb~            customer2.CustomerName = "Changed 2";~\\
\cellcolor{green} & 1 & \verb~225~ & & \verb~            context2.SaveChanges(user);~\\
\cellcolor{gray} &  & \verb~226~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~227~ & & \verb~            customer3.CustomerName = "arsd";~\\
\cellcolor{green} & 1 & \verb~228~ & & \verb~            customer1.CustomerName = "Concurrency";~\\
\cellcolor{gray} &  & \verb~229~ & & \verb~~\\
\cellcolor{gray} &  & \verb~230~ & & \verb~            try~\\
\cellcolor{green} & 1 & \verb~231~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~232~ & & \verb~                context1.SaveChanges(user);~\\
\cellcolor{red} & 0 & \verb~233~ & & \verb~            }~\\
\cellcolor{green} & 1 & \verb~234~ & & \verb~            catch~\\
\cellcolor{green} & 1 & \verb~235~ & & \verb~            { }~\\
\cellcolor{gray} &  & \verb~236~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~237~ & & \verb~            context1.Reload(customer1);~\\
\cellcolor{green} & 1 & \verb~238~ & & \verb~            customer1.CustomerName = "Changed after concurrency failure";~\\
\cellcolor{green} & 1 & \verb~239~ & & \verb~            context1.SaveChanges(user);~\\
\cellcolor{green} & 1 & \verb~240~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~241~ & & \verb~~\\
\cellcolor{gray} &  & \verb~242~ & & \verb~        [TestCategory("AuditDbContext")]~\\
\cellcolor{gray} &  & \verb~243~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~244~ & & \verb~        public void UpdateTestNoProxy()~\\
\cellcolor{green} & 1 & \verb~245~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~246~ & & \verb~            Context context = this.CreateContext(false);~\\
\cellcolor{green} & 1 & \verb~247~ & & \verb~            this.UpdateTest(context);~\\
\cellcolor{green} & 1 & \verb~248~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~249~ & & \verb~~\\
\cellcolor{gray} &  & \verb~250~ & & \verb~        [TestCategory("AuditDbContext")]~\\
\cellcolor{gray} &  & \verb~251~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~252~ & & \verb~        public void UpdateTestProxy()~\\
\cellcolor{green} & 1 & \verb~253~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~254~ & & \verb~            Context context = this.CreateContext(true);~\\
\cellcolor{green} & 1 & \verb~255~ & & \verb~            this.UpdateTest(context);~\\
\cellcolor{green} & 1 & \verb~256~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~257~ & & \verb~~\\
\cellcolor{gray} &  & \verb~258~ & & \verb~        private void UpdateTest(Context context)~\\
\cellcolor{green} & 1 & \verb~259~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~260~ & & \verb~            string customerName = "Updated";~\\
\cellcolor{green} & 1 & \verb~261~ & & \verb~            DateTimeOffset updated = DateTimeOffset.Now;~\\
\cellcolor{gray} &  & \verb~262~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~263~ & & \verb~            DbConnection conn = this.GetConnection();~\\
\cellcolor{gray} &  & \verb~264~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~265~ & & \verb~            var newCustomer = new Customer { CustomerName = "Unit Test", Updat~\\
\cellcolor{green} & 1 & \verb~266~ & & \verb~            context.Customers.Add(newCustomer);~\\
\cellcolor{green} & 1 & \verb~267~ & & \verb~            context.SaveChanges(user);~\\
\cellcolor{gray} &  & \verb~268~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~269~ & & \verb~            Customer customer = context.Customers.Find(1);~\\
\cellcolor{green} & 1 & \verb~270~ & & \verb~            customer.CustomerName = customerName;~\\
\cellcolor{green} & 1 & \verb~271~ & & \verb~            context.SaveChanges(user);~\\
\cellcolor{gray} &  & \verb~272~ & & \verb~~\\
\cellcolor{gray} &  & \verb~273~ & & \verb~            // Chech the audit records has been created.~\\
\cellcolor{green} & 1 & \verb~274~ & & \verb~            using (DbCommand cmd = conn.CreateCommand())~\\
\cellcolor{green} & 1 & \verb~275~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~276~ & & \verb~                cmd.CommandText = "select * from customeraudits";~\\
\cellcolor{green} & 1 & \verb~277~ & & \verb~                using (var r = cmd.ExecuteReader())~\\
\cellcolor{green} & 1 & \verb~278~ & & \verb~                {~\\
\cellcolor{green} & 1 & \verb~279~ & & \verb~                    int records = 0;~\\
\cellcolor{green} & 1 & \verb~280~ & & \verb~                    while (r.Read())~\\
\cellcolor{green} & 1 & \verb~281~ & & \verb~                    {~\\
\cellcolor{green} & 1 & \verb~282~ & & \verb~                        records++;~\\
\cellcolor{green} & 1 & \verb~283~ & & \verb~                    }~\\
\cellcolor{green} & 1 & \verb~284~ & & \verb~                    Assert.AreEqual(1, records);~\\
\cellcolor{green} & 1 & \verb~285~ & & \verb~                }~\\
\cellcolor{green} & 1 & \verb~286~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~287~ & & \verb~~\\
\cellcolor{gray} &  & \verb~288~ & & \verb~            // Check the audit fields.~\\
\cellcolor{green} & 1 & \verb~289~ & & \verb~            using (DbCommand cmd = conn.CreateCommand())~\\
\cellcolor{green} & 1 & \verb~290~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~291~ & & \verb~                cmd.CommandText = "select * from customeraudits";~\\
\cellcolor{green} & 1 & \verb~292~ & & \verb~                using (var r = cmd.ExecuteReader())~\\
\cellcolor{green} & 1 & \verb~293~ & & \verb~                {~\\
\cellcolor{green} & 1 & \verb~294~ & & \verb~                    r.Read();~\\
\cellcolor{green} & 1 & \verb~295~ & & \verb~                    Assert.AreEqual(1, r["Id"]);~\\
\cellcolor{green} & 1 & \verb~296~ & & \verb~                    Assert.AreEqual(1, r["AuditSourceId"]);~\\
\cellcolor{green} & 1 & \verb~297~ & & \verb~                    Assert.AreEqual(user, r["UpdateUser"]);~\\
\cellcolor{gray} &  & \verb~298~ & & \verb~                    //Assert.AreEqual(updated, r["Updated"]);~\\
\cellcolor{green} & 1 & \verb~299~ & & \verb~                    Assert.AreEqual("Unit Test", r["CustomerName"]);~\\
\cellcolor{green} & 1 & \verb~300~ & & \verb~                    Assert.AreEqual(user, r["AuditUser"]);~\\
\cellcolor{green} & 1 & \verb~301~ & & \verb~                    Assert.AreEqual("update", r["AuditType"]);~\\
\cellcolor{green} & 1 & \verb~302~ & & \verb~                }~\\
\cellcolor{green} & 1 & \verb~303~ & & \verb~            }~\\
\cellcolor{green} & 1 & \verb~304~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~305~ & & \verb~~\\
\cellcolor{gray} &  & \verb~306~ & & \verb~        [TestCategory("AuditDbContext")]~\\
\cellcolor{gray} &  & \verb~307~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~308~ & & \verb~        public void DeleteTestNoProxy()~\\
\cellcolor{green} & 1 & \verb~309~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~310~ & & \verb~            Context context = this.CreateContext(false);~\\
\cellcolor{green} & 1 & \verb~311~ & & \verb~            this.DeleteTest(context);~\\
\cellcolor{green} & 1 & \verb~312~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~313~ & & \verb~~\\
\cellcolor{gray} &  & \verb~314~ & & \verb~        [TestCategory("AuditDbContext")]~\\
\cellcolor{gray} &  & \verb~315~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~316~ & & \verb~        public void DeleteTestProxy()~\\
\cellcolor{green} & 1 & \verb~317~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~318~ & & \verb~            Context context = this.CreateContext(true);~\\
\cellcolor{green} & 1 & \verb~319~ & & \verb~            this.DeleteTest(context);~\\
\cellcolor{green} & 1 & \verb~320~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~321~ & & \verb~~\\
\cellcolor{gray} &  & \verb~322~ & & \verb~        private DbConnection GetConnection()~\\
\cellcolor{green} & 1 & \verb~323~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~324~ & & \verb~            //SqlCeConnection conn = new SqlCeConnection(sqlConnectionString);~\\
\cellcolor{green} & 1 & \verb~325~ & & \verb~            SqlConnection conn = new SqlConnection(contextConnectionString);~\\
\cellcolor{green} & 1 & \verb~326~ & & \verb~            conn.Open();~\\
\cellcolor{gray} &  & \verb~327~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~328~ & & \verb~            using (DbCommand cmd = conn.CreateCommand())~\\
\cellcolor{green} & 1 & \verb~329~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~330~ & & \verb~                cmd.CommandText = @"set identity_insert customers on";~\\
\cellcolor{green} & 1 & \verb~331~ & & \verb~                cmd.ExecuteNonQuery();~\\
\cellcolor{green} & 1 & \verb~332~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~333~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~334~ & & \verb~            return conn;~\\
\cellcolor{green} & 1 & \verb~335~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~336~ & & \verb~~\\
\cellcolor{gray} &  & \verb~337~ & & \verb~        private void DeleteTest(Context context)~\\
\cellcolor{green} & 1 & \verb~338~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~339~ & & \verb~            DbConnection conn = this.GetConnection();~\\
\cellcolor{gray} &  & \verb~340~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~341~ & & \verb~            using (DbCommand cmd = conn.CreateCommand())~\\
\cellcolor{green} & 1 & \verb~342~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~343~ & & \verb~                cmd.CommandText = @"INSERT INTO Customers(Id, CustomerName,Upd~\\
\cellcolor{green} & 1 & \verb~344~ & & \verb~                int r = cmd.ExecuteNonQuery();~\\
\cellcolor{green} & 1 & \verb~345~ & & \verb~                Assert.AreEqual(1, r);~\\
\cellcolor{green} & 1 & \verb~346~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~347~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~348~ & & \verb~            Customer customer = context.Customers.Find(1);~\\
\cellcolor{green} & 1 & \verb~349~ & & \verb~            context.Customers.Remove(customer);~\\
\cellcolor{green} & 1 & \verb~350~ & & \verb~            context.SaveChanges(user);~\\
\cellcolor{gray} &  & \verb~351~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~352~ & & \verb~            using (DbCommand cmd = conn.CreateCommand())~\\
\cellcolor{green} & 1 & \verb~353~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~354~ & & \verb~                cmd.CommandText = "select * from customers";~\\
\cellcolor{green} & 1 & \verb~355~ & & \verb~                using (var r = cmd.ExecuteReader())~\\
\cellcolor{green} & 1 & \verb~356~ & & \verb~                {~\\
\cellcolor{green} & 1 & \verb~357~ & & \verb~                    int records = 0;~\\
\cellcolor{green} & 1 & \verb~358~ & & \verb~                    while (r.Read())~\\
\cellcolor{red} & 0 & \verb~359~ & & \verb~                    {~\\
\cellcolor{red} & 0 & \verb~360~ & & \verb~                        records++;~\\
\cellcolor{red} & 0 & \verb~361~ & & \verb~                    }~\\
\cellcolor{green} & 1 & \verb~362~ & & \verb~                    Assert.AreEqual(0, records);~\\
\cellcolor{green} & 1 & \verb~363~ & & \verb~                }~\\
\cellcolor{green} & 1 & \verb~364~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~365~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~366~ & & \verb~            using (DbCommand cmd = conn.CreateCommand())~\\
\cellcolor{green} & 1 & \verb~367~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~368~ & & \verb~                cmd.CommandText = "select * from customeraudits";~\\
\cellcolor{green} & 1 & \verb~369~ & & \verb~                using (var r = cmd.ExecuteReader())~\\
\cellcolor{green} & 1 & \verb~370~ & & \verb~                {~\\
\cellcolor{green} & 1 & \verb~371~ & & \verb~                    int records = 0;~\\
\cellcolor{green} & 1 & \verb~372~ & & \verb~                    while (r.Read())~\\
\cellcolor{green} & 1 & \verb~373~ & & \verb~                    {~\\
\cellcolor{green} & 1 & \verb~374~ & & \verb~                        records++;~\\
\cellcolor{green} & 1 & \verb~375~ & & \verb~                    }~\\
\cellcolor{green} & 1 & \verb~376~ & & \verb~                    Assert.AreEqual(1, records);~\\
\cellcolor{gray} &  & \verb~377~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~378~ & & \verb~                }~\\
\cellcolor{green} & 1 & \verb~379~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~380~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~381~ & & \verb~            using (DbCommand cmd = conn.CreateCommand())~\\
\cellcolor{green} & 1 & \verb~382~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~383~ & & \verb~                cmd.CommandText = "select * from customeraudits";~\\
\cellcolor{green} & 1 & \verb~384~ & & \verb~                using (var r = cmd.ExecuteReader())~\\
\cellcolor{green} & 1 & \verb~385~ & & \verb~                {~\\
\cellcolor{green} & 1 & \verb~386~ & & \verb~                    r.Read();~\\
\cellcolor{green} & 1 & \verb~387~ & & \verb~                    Assert.AreEqual(user, r["AuditUser"]);~\\
\cellcolor{green} & 1 & \verb~388~ & & \verb~                    Assert.AreEqual("delete", r["AuditType"]);~\\
\cellcolor{green} & 1 & \verb~389~ & & \verb~                }~\\
\cellcolor{green} & 1 & \verb~390~ & & \verb~            }~\\
\cellcolor{green} & 1 & \verb~391~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~392~ & & \verb~~\\
\cellcolor{gray} &  & \verb~393~ & & \verb~        [TestCategory("AuditDbContext")]~\\
\cellcolor{gray} &  & \verb~394~ & & \verb~        [TestMethod()]~\\
\cellcolor{gray} &  & \verb~395~ & & \verb~        public void RegisterAuditTypeTest()~\\
\cellcolor{green} & 1 & \verb~396~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~397~ & & \verb~            AuditDbContext context = new AuditDbContext("test");~\\
\cellcolor{green} & 1 & \verb~398~ & & \verb~            AuditDbContext.RegisterAuditType(typeof(TestEntityWithComplexType)~\\
\cellcolor{green} & 1 & \verb~399~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~400~ & & \verb~~\\
\cellcolor{gray} &  & \verb~401~ & & \verb~        [TestCategory("AuditDbContext")]~\\
\cellcolor{gray} &  & \verb~402~ & & \verb~        [TestMethod()]~\\
\cellcolor{gray} &  & \verb~403~ & & \verb~        [ExpectedException(typeof(ArgumentException), "Entity")]~\\
\cellcolor{gray} &  & \verb~404~ & & \verb~        public void RegisterAuditTypeTwiceExceptionTest()~\\
\cellcolor{green} & 1 & \verb~405~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~406~ & & \verb~            AuditDbContext context = new AuditDbContext("test");~\\
\cellcolor{green} & 1 & \verb~407~ & & \verb~            AuditDbContext.RegisterAuditType(typeof(TestEntity), typeof(TestEn~\\
\cellcolor{green} & 1 & \verb~408~ & & \verb~            AuditDbContext.RegisterAuditType(typeof(TestEntity), typeof(TestEn~\\
\cellcolor{red} & 0 & \verb~409~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~410~ & & \verb~~\\
\cellcolor{gray} &  & \verb~411~ & & \verb~        [TestCategory("AuditDbContext")]~\\
\cellcolor{gray} &  & \verb~412~ & & \verb~        [TestMethod()]~\\
\cellcolor{gray} &  & \verb~413~ & & \verb~        [ExpectedException(typeof(ArgumentException), "Entity")]~\\
\cellcolor{gray} &  & \verb~414~ & & \verb~        public void RegisterAuditTypeEntityExceptionTest1()~\\
\cellcolor{green} & 1 & \verb~415~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~416~ & & \verb~            AuditDbContext context = new AuditDbContext("test");~\\
\cellcolor{green} & 1 & \verb~417~ & & \verb~            AuditDbContext.RegisterAuditType(typeof(TestInvalidEntity), typeof~\\
\cellcolor{red} & 0 & \verb~418~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~419~ & & \verb~~\\
\cellcolor{gray} &  & \verb~420~ & & \verb~        [TestCategory("AuditDbContext")]~\\
\cellcolor{gray} &  & \verb~421~ & & \verb~        [TestMethod()]~\\
\cellcolor{gray} &  & \verb~422~ & & \verb~        [ExpectedException(typeof(ArgumentException), "Entity")]~\\
\cellcolor{gray} &  & \verb~423~ & & \verb~        public void RegisterAuditTypeEntityExceptionTest2()~\\
\cellcolor{green} & 1 & \verb~424~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~425~ & & \verb~            AuditDbContext context = new AuditDbContext("test");~\\
\cellcolor{green} & 1 & \verb~426~ & & \verb~            AuditDbContext.RegisterAuditType(typeof(TestEntity), typeof(TestIn~\\
\cellcolor{red} & 0 & \verb~427~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~428~ & & \verb~~\\
\cellcolor{gray} &  & \verb~429~ & & \verb~        #region Unit test classes~\\
\cellcolor{gray} &  & \verb~430~ & & \verb~        class TestInvalidEntity~\\
\cellcolor{gray} &  & \verb~431~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~432~ & & \verb~~\\
\cellcolor{gray} &  & \verb~433~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~434~ & & \verb~~\\
\cellcolor{gray} &  & \verb~435~ & & \verb~        class TestInvalidAuditEntity~\\
\cellcolor{gray} &  & \verb~436~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~437~ & & \verb~~\\
\cellcolor{gray} &  & \verb~438~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~439~ & & \verb~~\\
\cellcolor{gray} &  & \verb~440~ & & \verb~        class TestEntity : IAuditableEntity~\\
\cellcolor{gray} &  & \verb~441~ & & \verb~        {~\\
\cellcolor{red} & 0 & \verb~442~ & & \verb~            public DateTimeOffset? Updated { get; set; }~\\
\cellcolor{red} & 0 & \verb~443~ & & \verb~            public string UpdateUser { get; set; }~\\
\cellcolor{gray} &  & \verb~444~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~445~ & & \verb~~\\
\cellcolor{gray} &  & \verb~446~ & & \verb~        class TestEntityWithComplexType : IAuditableEntity~\\
\cellcolor{gray} &  & \verb~447~ & & \verb~        {~\\
\cellcolor{red} & 0 & \verb~448~ & & \verb~            public TestComplexType Address { get; set; }~\\
\cellcolor{red} & 0 & \verb~449~ & & \verb~            public DateTimeOffset? Updated { get; set; }~\\
\cellcolor{red} & 0 & \verb~450~ & & \verb~            public string UpdateUser { get; set; }~\\
\cellcolor{gray} &  & \verb~451~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~452~ & & \verb~~\\
\cellcolor{gray} &  & \verb~453~ & & \verb~        [ComplexType]~\\
\cellcolor{gray} &  & \verb~454~ & & \verb~        class TestComplexType~\\
\cellcolor{gray} &  & \verb~455~ & & \verb~        {~\\
\cellcolor{red} & 0 & \verb~456~ & & \verb~            public string AddressLine1 { get; set; }~\\
\cellcolor{gray} &  & \verb~457~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~458~ & & \verb~~\\
\cellcolor{gray} &  & \verb~459~ & & \verb~        class TestEntityAudit : IAuditEntity~\\
\cellcolor{gray} &  & \verb~460~ & & \verb~        {~\\
\cellcolor{red} & 0 & \verb~461~ & & \verb~            public DateTimeOffset Updated { get; set; }~\\
\cellcolor{red} & 0 & \verb~462~ & & \verb~            public string UpdateUser { get; set; }~\\
\cellcolor{red} & 0 & \verb~463~ & & \verb~            public DateTimeOffset Audited { get; set; }~\\
\cellcolor{red} & 0 & \verb~464~ & & \verb~            public string AuditUser { get; set; }~\\
\cellcolor{red} & 0 & \verb~465~ & & \verb~            public string AuditType { get; set; }~\\
\cellcolor{red} & 0 & \verb~466~ & & \verb~            public int AuditSourceId { get; set; }~\\
\cellcolor{gray} &  & \verb~467~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~468~ & & \verb~~\\
\cellcolor{gray} &  & \verb~469~ & & \verb~        class TestEntityWithComplexTypeAudit : IAuditEntity~\\
\cellcolor{gray} &  & \verb~470~ & & \verb~        {~\\
\cellcolor{red} & 0 & \verb~471~ & & \verb~            public DateTimeOffset Updated { get; set; }~\\
\cellcolor{red} & 0 & \verb~472~ & & \verb~            public string UpdateUser { get; set; }~\\
\cellcolor{red} & 0 & \verb~473~ & & \verb~            public DateTimeOffset Audited { get; set; }~\\
\cellcolor{red} & 0 & \verb~474~ & & \verb~            public string AuditUser { get; set; }~\\
\cellcolor{red} & 0 & \verb~475~ & & \verb~            public string AuditType { get; set; }~\\
\cellcolor{red} & 0 & \verb~476~ & & \verb~            public int AuditSourceId { get; set; }~\\
\cellcolor{gray} &  & \verb~477~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~478~ & & \verb~        #endregion~\\
\cellcolor{gray} &  & \verb~479~ & & \verb~~\\
\cellcolor{gray} &  & \verb~480~ & & \verb~~\\
\cellcolor{gray} &  & \verb~481~ & & \verb~~\\
\cellcolor{gray} &  & \verb~482~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~483~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Auditing.Test.Context}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Auditing.Test.Context\\
\textbf{Assembly:} & entityframework.auditing.test.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{C:\textbackslash Development\textbackslash EntityFrameworkRepository6\textbackslash AuditDbContextTests\textbackslash Context.cs}\end{minipage} \\
\textbf{Covered lines:} & 6\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 6\\
\textbf{Total lines:} & 33\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{Context(bool, string} & 4 & 0\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{C:\textbackslash Development\textbackslash EntityFrameworkRepository6\textbackslash AuditDbContextTests\textbackslash Context.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~//-----------------------------------------------------------------------~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~// <copyright file="CodeFirstDbContext.cs" company="Russell Wilkins">~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~//     Copyright (c) Russell Wilkins. All rights reserved.~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~// </copyright>~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~//-----------------------------------------------------------------------~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~namespace EntityFramework.Auditing.Test~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~    using System;~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~    using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~    using System.Linq;~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~    using System.Text;~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~    using System.Data.Entity;~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~    /// <summary>~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    /// TODO: Describe the class~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    /// </summary>~\\
\cellcolor{gray} &  & \verb~17~ & & \verb~    public class Context : AuditDbContext~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~19~ & & \verb~        public IDbSet<Customer> Customers { get; set; }~\\
\cellcolor{green} & 1 & \verb~20~ & & \verb~        public IDbSet<CustomerAudit> CustomerAudits { get; set; }~\\
\cellcolor{gray} &  & \verb~21~ & & \verb~~\\
\cellcolor{gray} &  & \verb~22~ & & \verb~        #region Constructors~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~        /// <summary>~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~        /// Initializes a new instance of the CodeFirstDbContext class.~\\
\cellcolor{gray} &  & \verb~25~ & & \verb~        /// </summary>~\\
\cellcolor{gray} &  & \verb~26~ & & \verb~        public Context(bool proxies, string conn)~\\
\cellcolor{green} & 1 & \verb~27~ & & \verb~            : base(conn)~\\
\cellcolor{green} & 1 & \verb~28~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~29~ & & \verb~            this.Configuration.ProxyCreationEnabled = proxies;~\\
\cellcolor{green} & 1 & \verb~30~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~31~ & & \verb~        #endregion~\\
\cellcolor{gray} &  & \verb~32~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~33~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Auditing.Test.Customer}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Auditing.Test.Customer\\
\textbf{Assembly:} & entityframework.auditing.test.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{C:\textbackslash Development\textbackslash EntityFrameworkRepository6\textbackslash AuditDbContextTests\textbackslash Customer.cs}\end{minipage} \\
\textbf{Covered lines:} & 3\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 3\\
\textbf{Total lines:} & 27\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{File(s)}
\subsubsection{C:\textbackslash Development\textbackslash EntityFrameworkRepository6\textbackslash AuditDbContextTests\textbackslash Customer.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~//-----------------------------------------------------------------------~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~// <copyright file="Customer.cs" company="Russell Wilkins">~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~//     Copyright (c) Russell Wilkins. All rights reserved.~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~// </copyright>~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~//-----------------------------------------------------------------------~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~namespace EntityFramework.Auditing.Test~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~    using System;~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~    using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~    using System.Linq;~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~    using System.Text;~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~    using System.ComponentModel.DataAnnotations;~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~    /// <summary>~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    /// TODO: Describe the class~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    /// </summary>~\\
\cellcolor{gray} &  & \verb~17~ & & \verb~    public class Customer : AuditableEntity~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~        //public virtual int CustomerId { get; protected set; }~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~21~ & & \verb~        public virtual int Id { get; set; }~\\
\cellcolor{green} & 1 & \verb~22~ & & \verb~        public virtual string CustomerName { get; set; }~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~        [Timestamp]~\\
\cellcolor{green} & 1 & \verb~25~ & & \verb~        public virtual byte[] RowVersion { get; set; }~\\
\cellcolor{gray} &  & \verb~26~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~27~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Auditing.Test.CustomerAudit}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Auditing.Test.CustomerAudit\\
\textbf{Assembly:} & entityframework.auditing.test.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{C:\textbackslash Development\textbackslash EntityFrameworkRepository6\textbackslash AuditDbContextTests\textbackslash CustomerAudit.cs}\end{minipage} \\
\textbf{Covered lines:} & 2\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 2\\
\textbf{Total lines:} & 25\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{File(s)}
\subsubsection{C:\textbackslash Development\textbackslash EntityFrameworkRepository6\textbackslash AuditDbContextTests\textbackslash CustomerAudit.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~//-----------------------------------------------------------------------~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~// <copyright file="CustomerAudit.cs" company="Russell Wilkins">~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~//     Copyright (c) Russell Wilkins. All rights reserved.~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~// </copyright>~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~//-----------------------------------------------------------------------~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~namespace EntityFramework.Auditing.Test~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~    using System;~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~    using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~    using System.Linq;~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~    using System.Text;~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~    /// <summary>~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~    /// TODO: Describe the class~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    /// </summary>~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    public class CustomerAudit : AuditEntity~\\
\cellcolor{gray} &  & \verb~17~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~19~ & & \verb~        public virtual int Id { get; set; }~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~        //public virtual int CustomerAuditId { get; protected set; }~\\
\cellcolor{gray} &  & \verb~21~ & & \verb~~\\
\cellcolor{gray} &  & \verb~22~ & & \verb~        //public virtual int CustomerId { get; private set; }~\\
\cellcolor{green} & 1 & \verb~23~ & & \verb~        public virtual string CustomerName { get; set; }~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~25~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Repository6.BaseContext<TContext>}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Repository6.BaseContext<TContext>\\
\textbf{Assembly:} & entityframework.repository6.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{velopment\textbackslash EntityFrameworkRepository6\textbackslash EntityFrameworkRepository6\textbackslash BaseContext.cs}\end{minipage} \\
\textbf{Covered lines:} & 2\\
\textbf{Uncovered lines:} & 5\\
\textbf{Coverable lines:} & 7\\
\textbf{Total lines:} & 23\\
\textbf{Line coverage:} & 28.5\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{BaseContext()} & 1 & 0\\
\hline
\textbf{BaseContext(System.D} & 3 & 0\\
\hline
\textbf{BaseContext(System.D} & 0 & 3\\
\hline
\textbf{BaseContext(string)} & 0 & 3\\
\hline
\textbf{BaseContext(string, } & 0 & 3\\
\hline
\textbf{BaseContext(System.D} & 0 & 3\\
\hline
\textbf{BaseContext(System.D} & 0 & 3\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{velopment\textbackslash EntityFrameworkRepository6\textbackslash EntityFrameworkRepository6\textbackslash BaseContext.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using System.Data.Common;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using System.Data.Entity;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~namespace EntityFramework.Repository6~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~    public class BaseContext<TContext> : DbContext~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~            where TContext : DbContext~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~9~ & & \verb~        static BaseContext() { }~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~11~ & & \verb~        protected BaseContext(DbConnection dbConnection) : base(dbConnection, ~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~13~ & & \verb~        protected BaseContext(DbConnection dbConnection, bool contextOwnsConne~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~15~ & & \verb~        protected BaseContext(string connectionString) : base(connectionString~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~17~ & & \verb~        protected BaseContext(string connectionString, IDatabaseInitializer<TC~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~19~ & & \verb~        protected BaseContext(DbConnection dbConnection, IDatabaseInitializer<~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~21~ & & \verb~        protected BaseContext(DbConnection dbConnection, IDatabaseInitializer<~\\
\cellcolor{gray} &  & \verb~22~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Repository6.BaseRepository}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Repository6.BaseRepository\\
\textbf{Assembly:} & entityframework.repository6.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{opment\textbackslash EntityFrameworkRepository6\textbackslash EntityFrameworkRepository6\textbackslash BaseRepository.cs}\end{minipage} \\
\textbf{Covered lines:} & 12\\
\textbf{Uncovered lines:} & 7\\
\textbf{Coverable lines:} & 19\\
\textbf{Total lines:} & 241\\
\textbf{Line coverage:} & 63.1\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{FindAsync()} & 6 & 0\\
\hline
\textbf{FindAsync()} & 6 & 0\\
\hline
\textbf{ReloadAsync()} & 6 & 0\\
\hline
\textbf{SaveAsync()} & 0 & 5\\
\hline
\textbf{CountAsync()} & 0 & 6\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{opment\textbackslash EntityFrameworkRepository6\textbackslash EntityFrameworkRepository6\textbackslash BaseRepository.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using EntityFramework.Repository6.Interfaces;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using System.Data.Entity;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Linq.Expressions;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~namespace EntityFramework.Repository6~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~    public abstract class BaseRepository<C, T> :~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~            IBaseRepository<C, T>~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~            , IDisposable~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~        where T : class~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~        where C : DbContext~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~17~ & & \verb~        protected C Context { get; set; }~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~        protected Lazy<List<string>> IgnoreFieldsOnUpdate = new Lazy<List<stri~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~        protected Lazy<List<Expression<Func<T, bool>>>> IgnoreFieldsOnUpdate2 ~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~~\\
\cellcolor{gray} &  & \verb~21~ & & \verb~        protected BaseRepository(C context)~\\
\cellcolor{gray} &  & \verb~22~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~            Context = context;~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~25~ & & \verb~~\\
\cellcolor{gray} &  & \verb~26~ & & \verb~        public virtual void AddUpdateIgnoreField(string fieldName)~\\
\cellcolor{gray} &  & \verb~27~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~28~ & & \verb~            IgnoreFieldsOnUpdate.Value.Add(fieldName);~\\
\cellcolor{gray} &  & \verb~29~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~~\\
\cellcolor{gray} &  & \verb~31~ & & \verb~        public virtual void AddUpdateIgnoreField(Expression<Func<T, bool>> fie~\\
\cellcolor{gray} &  & \verb~32~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~33~ & & \verb~            IgnoreFieldsOnUpdate2.Value.Add(fieldName);~\\
\cellcolor{gray} &  & \verb~34~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~35~ & & \verb~~\\
\cellcolor{gray} &  & \verb~36~ & & \verb~        public virtual T Find(int id)~\\
\cellcolor{gray} &  & \verb~37~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~38~ & & \verb~            T entity = Context.Set<T>().Find(id);~\\
\cellcolor{gray} &  & \verb~39~ & & \verb~~\\
\cellcolor{gray} &  & \verb~40~ & & \verb~            return entity;~\\
\cellcolor{gray} &  & \verb~41~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~42~ & & \verb~~\\
\cellcolor{gray} &  & \verb~43~ & & \verb~        public virtual T Find(params object[] ids)~\\
\cellcolor{gray} &  & \verb~44~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~45~ & & \verb~            T entity = Context.Set<T>().Find(ids);~\\
\cellcolor{gray} &  & \verb~46~ & & \verb~~\\
\cellcolor{gray} &  & \verb~47~ & & \verb~            return entity;~\\
\cellcolor{gray} &  & \verb~48~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~49~ & & \verb~~\\
\cellcolor{gray} &  & \verb~50~ & & \verb~        public virtual async Task<T> FindAsync(int id)~\\
\cellcolor{green} & 1 & \verb~51~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~52~ & & \verb~            var query = Context.Set<T>().FindAsync(id);~\\
\cellcolor{green} & 1 & \verb~53~ & & \verb~            return await query;~\\
\cellcolor{green} & 1 & \verb~54~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~55~ & & \verb~~\\
\cellcolor{gray} &  & \verb~56~ & & \verb~        public virtual async Task<T> FindAsync(params object[] ids)~\\
\cellcolor{green} & 1 & \verb~57~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~58~ & & \verb~            var query = Context.Set<T>().FindAsync(ids);~\\
\cellcolor{green} & 1 & \verb~59~ & & \verb~            return await query;~\\
\cellcolor{green} & 1 & \verb~60~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~61~ & & \verb~~\\
\cellcolor{gray} &  & \verb~62~ & & \verb~        public virtual IQueryable<T> FindBy(Expression<Func<T, bool>> predicat~\\
\cellcolor{gray} &  & \verb~63~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~64~ & & \verb~            IQueryable<T> query = Context.Set<T>().Where(predicate);~\\
\cellcolor{gray} &  & \verb~65~ & & \verb~            return query;~\\
\cellcolor{gray} &  & \verb~66~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~67~ & & \verb~~\\
\cellcolor{gray} &  & \verb~68~ & & \verb~        public virtual bool Exists(Expression<Func<T, bool>> predicate)~\\
\cellcolor{gray} &  & \verb~69~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~70~ & & \verb~            return Context.Set<T>().AsNoTracking().Any(predicate);~\\
\cellcolor{gray} &  & \verb~71~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~72~ & & \verb~~\\
\cellcolor{gray} &  & \verb~73~ & & \verb~        public virtual void Delete(T entity)~\\
\cellcolor{gray} &  & \verb~74~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~75~ & & \verb~            Context.Set<T>().Remove(entity);~\\
\cellcolor{gray} &  & \verb~76~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~77~ & & \verb~~\\
\cellcolor{gray} &  & \verb~78~ & & \verb~        public virtual void Delete(IEnumerable<T> entities)~\\
\cellcolor{gray} &  & \verb~79~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~80~ & & \verb~            foreach (T entity in entities)~\\
\cellcolor{gray} &  & \verb~81~ & & \verb~            {~\\
\cellcolor{gray} &  & \verb~82~ & & \verb~                Delete(entity);~\\
\cellcolor{gray} &  & \verb~83~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~84~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~85~ & & \verb~~\\
\cellcolor{gray} &  & \verb~86~ & & \verb~        public virtual void Reload(T entity)~\\
\cellcolor{gray} &  & \verb~87~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~88~ & & \verb~            Context.Entry<T>(entity).Reload();~\\
\cellcolor{gray} &  & \verb~89~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~90~ & & \verb~~\\
\cellcolor{gray} &  & \verb~91~ & & \verb~        public async virtual Task ReloadAsync(T entity)~\\
\cellcolor{green} & 1 & \verb~92~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~93~ & & \verb~            await Context.Entry<T>(entity).ReloadAsync();~\\
\cellcolor{green} & 1 & \verb~94~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~95~ & & \verb~~\\
\cellcolor{gray} &  & \verb~96~ & & \verb~        public virtual IQueryable<T> FindByReadOnly(Expression<Func<T, bool>> ~\\
\cellcolor{gray} &  & \verb~97~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~98~ & & \verb~            IQueryable<T> query = Context.Set<T>().AsNoTracking().Where(predic~\\
\cellcolor{gray} &  & \verb~99~ & & \verb~            return query;~\\
\cellcolor{gray} &  & \verb~100~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~101~ & & \verb~~\\
\cellcolor{gray} &  & \verb~102~ & & \verb~        public virtual IQueryable<T> GetAll()~\\
\cellcolor{gray} &  & \verb~103~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~104~ & & \verb~            IQueryable<T> query = Context.Set<T>().AsNoTracking();~\\
\cellcolor{gray} &  & \verb~105~ & & \verb~~\\
\cellcolor{gray} &  & \verb~106~ & & \verb~            return query;~\\
\cellcolor{gray} &  & \verb~107~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~108~ & & \verb~~\\
\cellcolor{gray} &  & \verb~109~ & & \verb~        public virtual T Add(T entity)~\\
\cellcolor{gray} &  & \verb~110~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~111~ & & \verb~            Context.Set<T>().Add(entity);~\\
\cellcolor{gray} &  & \verb~112~ & & \verb~~\\
\cellcolor{gray} &  & \verb~113~ & & \verb~            return entity;~\\
\cellcolor{gray} &  & \verb~114~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~115~ & & \verb~~\\
\cellcolor{gray} &  & \verb~116~ & & \verb~        public virtual IEnumerable<T> Add(IEnumerable<T> entities)~\\
\cellcolor{gray} &  & \verb~117~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~118~ & & \verb~            Context.Set<T>().AddRange(entities);~\\
\cellcolor{gray} &  & \verb~119~ & & \verb~~\\
\cellcolor{gray} &  & \verb~120~ & & \verb~            return entities;~\\
\cellcolor{gray} &  & \verb~121~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~122~ & & \verb~~\\
\cellcolor{gray} &  & \verb~123~ & & \verb~        public virtual void Update(T entity, int id)~\\
\cellcolor{gray} &  & \verb~124~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~125~ & & \verb~            var entityToUpdate = Context.Set<T>().Find(id);~\\
\cellcolor{gray} &  & \verb~126~ & & \verb~~\\
\cellcolor{gray} &  & \verb~127~ & & \verb~            if (entityToUpdate == null) throw CreateEntityNotFoundException<Ar~\\
\cellcolor{gray} &  & \verb~128~ & & \verb~~\\
\cellcolor{gray} &  & \verb~129~ & & \verb~            Context.Entry(entityToUpdate).CurrentValues.SetValues(entity);~\\
\cellcolor{gray} &  & \verb~130~ & & \verb~~\\
\cellcolor{gray} &  & \verb~131~ & & \verb~            MarkIgnoreFields(entityToUpdate);~\\
\cellcolor{gray} &  & \verb~132~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~133~ & & \verb~~\\
\cellcolor{gray} &  & \verb~134~ & & \verb~        public virtual void Update(T entity, Expression<Func<T, bool>> predica~\\
\cellcolor{gray} &  & \verb~135~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~136~ & & \verb~            var entityToUpdate = Context.Set<T>().Where(predicate).SingleOrDef~\\
\cellcolor{gray} &  & \verb~137~ & & \verb~~\\
\cellcolor{gray} &  & \verb~138~ & & \verb~            if (entityToUpdate == null) throw CreateEntityNotFoundException<Ar~\\
\cellcolor{gray} &  & \verb~139~ & & \verb~~\\
\cellcolor{gray} &  & \verb~140~ & & \verb~            Context.Entry(entityToUpdate).CurrentValues.SetValues(entity);~\\
\cellcolor{gray} &  & \verb~141~ & & \verb~~\\
\cellcolor{gray} &  & \verb~142~ & & \verb~            MarkIgnoreFields(entityToUpdate);~\\
\cellcolor{gray} &  & \verb~143~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~144~ & & \verb~~\\
\cellcolor{gray} &  & \verb~145~ & & \verb~        public virtual void Update(Delta<T> delta, params object[] ids)~\\
\cellcolor{gray} &  & \verb~146~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~147~ & & \verb~            var entityToUpdate = Context.Set<T>().Find(ids);~\\
\cellcolor{gray} &  & \verb~148~ & & \verb~~\\
\cellcolor{gray} &  & \verb~149~ & & \verb~            if (entityToUpdate == null) throw CreateEntityNotFoundException<Ar~\\
\cellcolor{gray} &  & \verb~150~ & & \verb~~\\
\cellcolor{gray} &  & \verb~151~ & & \verb~            foreach (string field in delta.UpdatedFields())~\\
\cellcolor{gray} &  & \verb~152~ & & \verb~            {~\\
\cellcolor{gray} &  & \verb~153~ & & \verb~                var fieldToSet = typeof(T).GetProperty(field);~\\
\cellcolor{gray} &  & \verb~154~ & & \verb~                var dataOrigion = delta.Internal.GetType().GetProperty(field);~\\
\cellcolor{gray} &  & \verb~155~ & & \verb~~\\
\cellcolor{gray} &  & \verb~156~ & & \verb~                fieldToSet.SetValue(entityToUpdate, dataOrigion.GetValue(delta~\\
\cellcolor{gray} &  & \verb~157~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~158~ & & \verb~~\\
\cellcolor{gray} &  & \verb~159~ & & \verb~            MarkIgnoreFields(entityToUpdate);~\\
\cellcolor{gray} &  & \verb~160~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~161~ & & \verb~~\\
\cellcolor{gray} &  & \verb~162~ & & \verb~        public void Update(Delta<T> delta, Expression<Func<T, bool>> predicate~\\
\cellcolor{gray} &  & \verb~163~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~164~ & & \verb~            var entityToUpdate = Context.Set<T>().Where(predicate).SingleOrDef~\\
\cellcolor{gray} &  & \verb~165~ & & \verb~~\\
\cellcolor{gray} &  & \verb~166~ & & \verb~            if (entityToUpdate == null) throw CreateEntityNotFoundException<Ar~\\
\cellcolor{gray} &  & \verb~167~ & & \verb~~\\
\cellcolor{gray} &  & \verb~168~ & & \verb~            foreach (string field in delta.UpdatedFields())~\\
\cellcolor{gray} &  & \verb~169~ & & \verb~            {~\\
\cellcolor{gray} &  & \verb~170~ & & \verb~                var fieldToSet = typeof(T).GetProperty(field);~\\
\cellcolor{gray} &  & \verb~171~ & & \verb~                var dataOrigion = delta.Internal.GetType().GetProperty(field);~\\
\cellcolor{gray} &  & \verb~172~ & & \verb~~\\
\cellcolor{gray} &  & \verb~173~ & & \verb~                fieldToSet.SetValue(entityToUpdate, dataOrigion.GetValue(delta~\\
\cellcolor{gray} &  & \verb~174~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~175~ & & \verb~~\\
\cellcolor{gray} &  & \verb~176~ & & \verb~            MarkIgnoreFields(entityToUpdate);~\\
\cellcolor{gray} &  & \verb~177~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~178~ & & \verb~~\\
\cellcolor{gray} &  & \verb~179~ & & \verb~        protected virtual E CreateEntityNotFoundException<E>(string entityId, ~\\
\cellcolor{gray} &  & \verb~180~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~181~ & & \verb~            return (E)Activator.CreateInstance(typeof(E), string.Format("{0} i~\\
\cellcolor{gray} &  & \verb~182~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~183~ & & \verb~~\\
\cellcolor{gray} &  & \verb~184~ & & \verb~        protected virtual void MarkIgnoreFields(T entityToUpdate)~\\
\cellcolor{gray} &  & \verb~185~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~186~ & & \verb~            if(IgnoreFieldsOnUpdate.IsValueCreated)~\\
\cellcolor{green} & 1 & \verb~187~ & & \verb~            { IgnoreFieldsOnUpdate.Value.ForEach(ignoreField => Context.Entry(~\\
\cellcolor{gray} &  & \verb~188~ & & \verb~~\\
\cellcolor{gray} &  & \verb~189~ & & \verb~~\\
\cellcolor{gray} &  & \verb~190~ & & \verb~            if(IgnoreFieldsOnUpdate2.IsValueCreated)~\\
\cellcolor{red} & 0 & \verb~191~ & & \verb~            { IgnoreFieldsOnUpdate2.Value.ForEach(ignoreField => Context.Entry~\\
\cellcolor{gray} &  & \verb~192~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~193~ & & \verb~~\\
\cellcolor{gray} &  & \verb~194~ & & \verb~        public async virtual Task<int> SaveAsync()~\\
\cellcolor{red} & 0 & \verb~195~ & & \verb~        {~\\
\cellcolor{red} & 0 & \verb~196~ & & \verb~            return await Context.SaveChangesAsync();~\\
\cellcolor{red} & 0 & \verb~197~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~198~ & & \verb~~\\
\cellcolor{gray} &  & \verb~199~ & & \verb~        public virtual int Save()~\\
\cellcolor{gray} &  & \verb~200~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~201~ & & \verb~            return Context.SaveChanges();~\\
\cellcolor{gray} &  & \verb~202~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~203~ & & \verb~~\\
\cellcolor{gray} &  & \verb~204~ & & \verb~        public virtual int Count()~\\
\cellcolor{gray} &  & \verb~205~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~206~ & & \verb~            return Context.Set<T>().Count();~\\
\cellcolor{gray} &  & \verb~207~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~208~ & & \verb~~\\
\cellcolor{gray} &  & \verb~209~ & & \verb~        public async virtual Task<int> CountAsync()~\\
\cellcolor{red} & 0 & \verb~210~ & & \verb~        {~\\
\cellcolor{red} & 0 & \verb~211~ & & \verb~            return await Context.Set<T>().CountAsync();~\\
\cellcolor{red} & 0 & \verb~212~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~213~ & & \verb~~\\
\cellcolor{gray} &  & \verb~214~ & & \verb~        #region IDisposable Support~\\
\cellcolor{gray} &  & \verb~215~ & & \verb~        private bool disposedValue = false; // To detect redundant calls~\\
\cellcolor{gray} &  & \verb~216~ & & \verb~~\\
\cellcolor{gray} &  & \verb~217~ & & \verb~        protected virtual void Dispose(bool disposing)~\\
\cellcolor{gray} &  & \verb~218~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~219~ & & \verb~            if (!disposedValue)~\\
\cellcolor{gray} &  & \verb~220~ & & \verb~            {~\\
\cellcolor{gray} &  & \verb~221~ & & \verb~                if (disposing)~\\
\cellcolor{gray} &  & \verb~222~ & & \verb~                {~\\
\cellcolor{gray} &  & \verb~223~ & & \verb~                    if (Context != null)~\\
\cellcolor{gray} &  & \verb~224~ & & \verb~                    {~\\
\cellcolor{gray} &  & \verb~225~ & & \verb~                        Context.Dispose();~\\
\cellcolor{gray} &  & \verb~226~ & & \verb~                        Context = null;~\\
\cellcolor{gray} &  & \verb~227~ & & \verb~                    }~\\
\cellcolor{gray} &  & \verb~228~ & & \verb~                }~\\
\cellcolor{gray} &  & \verb~229~ & & \verb~~\\
\cellcolor{gray} &  & \verb~230~ & & \verb~                disposedValue = true;~\\
\cellcolor{gray} &  & \verb~231~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~232~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~233~ & & \verb~~\\
\cellcolor{gray} &  & \verb~234~ & & \verb~        public void Dispose()~\\
\cellcolor{gray} &  & \verb~235~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~236~ & & \verb~            Dispose(true);~\\
\cellcolor{gray} &  & \verb~237~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~238~ & & \verb~        #endregion~\\
\cellcolor{gray} &  & \verb~239~ & & \verb~~\\
\cellcolor{gray} &  & \verb~240~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~241~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Repository6.BaseRepository<C, T>}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Repository6.BaseRepository<C, T>\\
\textbf{Assembly:} & entityframework.repository6.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{opment\textbackslash EntityFrameworkRepository6\textbackslash EntityFrameworkRepository6\textbackslash BaseRepository.cs}\end{minipage} \\
\textbf{Covered lines:} & 119\\
\textbf{Uncovered lines:} & 4\\
\textbf{Coverable lines:} & 123\\
\textbf{Total lines:} & 241\\
\textbf{Line coverage:} & 96.7\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{BaseRepository(C)} & 5 & 0\\
\hline
\textbf{AddUpdateIgnoreField} & 3 & 0\\
\hline
\textbf{AddUpdateIgnoreField} & 0 & 3\\
\hline
\textbf{Find(int)} & 5 & 0\\
\hline
\textbf{Find(object[])} & 5 & 0\\
\hline
\textbf{FindBy(System.Linq.E} & 5 & 0\\
\hline
\textbf{Exists(System.Linq.E} & 6 & 0\\
\hline
\textbf{Delete(T)} & 4 & 0\\
\hline
\textbf{Delete(System.Collec} & 9 & 0\\
\hline
\textbf{Reload(T)} & 4 & 0\\
\hline
\textbf{FindByReadOnly(Syste} & 6 & 0\\
\hline
\textbf{GetAll()} & 5 & 0\\
\hline
\textbf{Add(T)} & 5 & 0\\
\hline
\textbf{Add(System.Collectio} & 5 & 0\\
\hline
\textbf{Update(T, int)} & 10 & 5\\
\hline
\textbf{Update(T, System.Lin} & 16 & 0\\
\hline
\textbf{Update(EntityFramewo} & 22 & 5\\
\hline
\textbf{Update(EntityFramewo} & 23 & 5\\
\hline
\textbf{CreateEntityNotFound} & 5 & 0\\
\hline
\textbf{MarkIgnoreFields(T)} & 9 & 4\\
\hline
\textbf{Save()} & 4 & 0\\
\hline
\textbf{Count()} & 5 & 0\\
\hline
\textbf{Dispose(bool)} & 11 & 0\\
\hline
\textbf{Dispose()} & 2 & 0\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{opment\textbackslash EntityFrameworkRepository6\textbackslash EntityFrameworkRepository6\textbackslash BaseRepository.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using EntityFramework.Repository6.Interfaces;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using System.Data.Entity;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Linq.Expressions;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~namespace EntityFramework.Repository6~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~    public abstract class BaseRepository<C, T> :~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~            IBaseRepository<C, T>~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~            , IDisposable~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~        where T : class~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~        where C : DbContext~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~17~ & & \verb~        protected C Context { get; set; }~\\
\cellcolor{green} & 1 & \verb~18~ & & \verb~        protected Lazy<List<string>> IgnoreFieldsOnUpdate = new Lazy<List<stri~\\
\cellcolor{green} & 1 & \verb~19~ & & \verb~        protected Lazy<List<Expression<Func<T, bool>>>> IgnoreFieldsOnUpdate2 ~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~21~ & & \verb~        protected BaseRepository(C context)~\\
\cellcolor{green} & 1 & \verb~22~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~23~ & & \verb~            Context = context;~\\
\cellcolor{green} & 1 & \verb~24~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~25~ & & \verb~~\\
\cellcolor{gray} &  & \verb~26~ & & \verb~        public virtual void AddUpdateIgnoreField(string fieldName)~\\
\cellcolor{green} & 1 & \verb~27~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~28~ & & \verb~            IgnoreFieldsOnUpdate.Value.Add(fieldName);~\\
\cellcolor{green} & 1 & \verb~29~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~~\\
\cellcolor{gray} &  & \verb~31~ & & \verb~        public virtual void AddUpdateIgnoreField(Expression<Func<T, bool>> fie~\\
\cellcolor{red} & 0 & \verb~32~ & & \verb~        {~\\
\cellcolor{red} & 0 & \verb~33~ & & \verb~            IgnoreFieldsOnUpdate2.Value.Add(fieldName);~\\
\cellcolor{red} & 0 & \verb~34~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~35~ & & \verb~~\\
\cellcolor{gray} &  & \verb~36~ & & \verb~        public virtual T Find(int id)~\\
\cellcolor{green} & 1 & \verb~37~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~38~ & & \verb~            T entity = Context.Set<T>().Find(id);~\\
\cellcolor{gray} &  & \verb~39~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~40~ & & \verb~            return entity;~\\
\cellcolor{green} & 1 & \verb~41~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~42~ & & \verb~~\\
\cellcolor{gray} &  & \verb~43~ & & \verb~        public virtual T Find(params object[] ids)~\\
\cellcolor{green} & 1 & \verb~44~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~45~ & & \verb~            T entity = Context.Set<T>().Find(ids);~\\
\cellcolor{gray} &  & \verb~46~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~47~ & & \verb~            return entity;~\\
\cellcolor{green} & 1 & \verb~48~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~49~ & & \verb~~\\
\cellcolor{gray} &  & \verb~50~ & & \verb~        public virtual async Task<T> FindAsync(int id)~\\
\cellcolor{gray} &  & \verb~51~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~52~ & & \verb~            var query = Context.Set<T>().FindAsync(id);~\\
\cellcolor{gray} &  & \verb~53~ & & \verb~            return await query;~\\
\cellcolor{gray} &  & \verb~54~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~55~ & & \verb~~\\
\cellcolor{gray} &  & \verb~56~ & & \verb~        public virtual async Task<T> FindAsync(params object[] ids)~\\
\cellcolor{gray} &  & \verb~57~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~58~ & & \verb~            var query = Context.Set<T>().FindAsync(ids);~\\
\cellcolor{gray} &  & \verb~59~ & & \verb~            return await query;~\\
\cellcolor{gray} &  & \verb~60~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~61~ & & \verb~~\\
\cellcolor{gray} &  & \verb~62~ & & \verb~        public virtual IQueryable<T> FindBy(Expression<Func<T, bool>> predicat~\\
\cellcolor{green} & 1 & \verb~63~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~64~ & & \verb~            IQueryable<T> query = Context.Set<T>().Where(predicate);~\\
\cellcolor{green} & 1 & \verb~65~ & & \verb~            return query;~\\
\cellcolor{green} & 1 & \verb~66~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~67~ & & \verb~~\\
\cellcolor{gray} &  & \verb~68~ & & \verb~        public virtual bool Exists(Expression<Func<T, bool>> predicate)~\\
\cellcolor{green} & 1 & \verb~69~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~70~ & & \verb~            return Context.Set<T>().AsNoTracking().Any(predicate);~\\
\cellcolor{green} & 1 & \verb~71~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~72~ & & \verb~~\\
\cellcolor{gray} &  & \verb~73~ & & \verb~        public virtual void Delete(T entity)~\\
\cellcolor{green} & 1 & \verb~74~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~75~ & & \verb~            Context.Set<T>().Remove(entity);~\\
\cellcolor{green} & 1 & \verb~76~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~77~ & & \verb~~\\
\cellcolor{gray} &  & \verb~78~ & & \verb~        public virtual void Delete(IEnumerable<T> entities)~\\
\cellcolor{green} & 1 & \verb~79~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~80~ & & \verb~            foreach (T entity in entities)~\\
\cellcolor{green} & 1 & \verb~81~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~82~ & & \verb~                Delete(entity);~\\
\cellcolor{green} & 1 & \verb~83~ & & \verb~            }~\\
\cellcolor{green} & 1 & \verb~84~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~85~ & & \verb~~\\
\cellcolor{gray} &  & \verb~86~ & & \verb~        public virtual void Reload(T entity)~\\
\cellcolor{green} & 1 & \verb~87~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~88~ & & \verb~            Context.Entry<T>(entity).Reload();~\\
\cellcolor{green} & 1 & \verb~89~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~90~ & & \verb~~\\
\cellcolor{gray} &  & \verb~91~ & & \verb~        public async virtual Task ReloadAsync(T entity)~\\
\cellcolor{gray} &  & \verb~92~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~93~ & & \verb~            await Context.Entry<T>(entity).ReloadAsync();~\\
\cellcolor{gray} &  & \verb~94~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~95~ & & \verb~~\\
\cellcolor{gray} &  & \verb~96~ & & \verb~        public virtual IQueryable<T> FindByReadOnly(Expression<Func<T, bool>> ~\\
\cellcolor{green} & 1 & \verb~97~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~98~ & & \verb~            IQueryable<T> query = Context.Set<T>().AsNoTracking().Where(predic~\\
\cellcolor{green} & 1 & \verb~99~ & & \verb~            return query;~\\
\cellcolor{green} & 1 & \verb~100~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~101~ & & \verb~~\\
\cellcolor{gray} &  & \verb~102~ & & \verb~        public virtual IQueryable<T> GetAll()~\\
\cellcolor{green} & 1 & \verb~103~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~104~ & & \verb~            IQueryable<T> query = Context.Set<T>().AsNoTracking();~\\
\cellcolor{gray} &  & \verb~105~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~106~ & & \verb~            return query;~\\
\cellcolor{green} & 1 & \verb~107~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~108~ & & \verb~~\\
\cellcolor{gray} &  & \verb~109~ & & \verb~        public virtual T Add(T entity)~\\
\cellcolor{green} & 1 & \verb~110~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~111~ & & \verb~            Context.Set<T>().Add(entity);~\\
\cellcolor{gray} &  & \verb~112~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~113~ & & \verb~            return entity;~\\
\cellcolor{green} & 1 & \verb~114~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~115~ & & \verb~~\\
\cellcolor{gray} &  & \verb~116~ & & \verb~        public virtual IEnumerable<T> Add(IEnumerable<T> entities)~\\
\cellcolor{green} & 1 & \verb~117~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~118~ & & \verb~            Context.Set<T>().AddRange(entities);~\\
\cellcolor{gray} &  & \verb~119~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~120~ & & \verb~            return entities;~\\
\cellcolor{green} & 1 & \verb~121~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~122~ & & \verb~~\\
\cellcolor{gray} &  & \verb~123~ & & \verb~        public virtual void Update(T entity, int id)~\\
\cellcolor{green} & 1 & \verb~124~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~125~ & & \verb~            var entityToUpdate = Context.Set<T>().Find(id);~\\
\cellcolor{gray} &  & \verb~126~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~127~ & & \verb~            if (entityToUpdate == null) throw CreateEntityNotFoundException<Ar~\\
\cellcolor{gray} &  & \verb~128~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~129~ & & \verb~            Context.Entry(entityToUpdate).CurrentValues.SetValues(entity);~\\
\cellcolor{gray} &  & \verb~130~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~131~ & & \verb~            MarkIgnoreFields(entityToUpdate);~\\
\cellcolor{green} & 1 & \verb~132~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~133~ & & \verb~~\\
\cellcolor{gray} &  & \verb~134~ & & \verb~        public virtual void Update(T entity, Expression<Func<T, bool>> predica~\\
\cellcolor{green} & 1 & \verb~135~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~136~ & & \verb~            var entityToUpdate = Context.Set<T>().Where(predicate).SingleOrDef~\\
\cellcolor{gray} &  & \verb~137~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~138~ & & \verb~            if (entityToUpdate == null) throw CreateEntityNotFoundException<Ar~\\
\cellcolor{gray} &  & \verb~139~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~140~ & & \verb~            Context.Entry(entityToUpdate).CurrentValues.SetValues(entity);~\\
\cellcolor{gray} &  & \verb~141~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~142~ & & \verb~            MarkIgnoreFields(entityToUpdate);~\\
\cellcolor{green} & 1 & \verb~143~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~144~ & & \verb~~\\
\cellcolor{gray} &  & \verb~145~ & & \verb~        public virtual void Update(Delta<T> delta, params object[] ids)~\\
\cellcolor{green} & 1 & \verb~146~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~147~ & & \verb~            var entityToUpdate = Context.Set<T>().Find(ids);~\\
\cellcolor{gray} &  & \verb~148~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~149~ & & \verb~            if (entityToUpdate == null) throw CreateEntityNotFoundException<Ar~\\
\cellcolor{gray} &  & \verb~150~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~151~ & & \verb~            foreach (string field in delta.UpdatedFields())~\\
\cellcolor{green} & 1 & \verb~152~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~153~ & & \verb~                var fieldToSet = typeof(T).GetProperty(field);~\\
\cellcolor{green} & 1 & \verb~154~ & & \verb~                var dataOrigion = delta.Internal.GetType().GetProperty(field);~\\
\cellcolor{gray} &  & \verb~155~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~156~ & & \verb~                fieldToSet.SetValue(entityToUpdate, dataOrigion.GetValue(delta~\\
\cellcolor{green} & 1 & \verb~157~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~158~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~159~ & & \verb~            MarkIgnoreFields(entityToUpdate);~\\
\cellcolor{green} & 1 & \verb~160~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~161~ & & \verb~~\\
\cellcolor{gray} &  & \verb~162~ & & \verb~        public void Update(Delta<T> delta, Expression<Func<T, bool>> predicate~\\
\cellcolor{green} & 1 & \verb~163~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~164~ & & \verb~            var entityToUpdate = Context.Set<T>().Where(predicate).SingleOrDef~\\
\cellcolor{gray} &  & \verb~165~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~166~ & & \verb~            if (entityToUpdate == null) throw CreateEntityNotFoundException<Ar~\\
\cellcolor{gray} &  & \verb~167~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~168~ & & \verb~            foreach (string field in delta.UpdatedFields())~\\
\cellcolor{green} & 1 & \verb~169~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~170~ & & \verb~                var fieldToSet = typeof(T).GetProperty(field);~\\
\cellcolor{green} & 1 & \verb~171~ & & \verb~                var dataOrigion = delta.Internal.GetType().GetProperty(field);~\\
\cellcolor{gray} &  & \verb~172~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~173~ & & \verb~                fieldToSet.SetValue(entityToUpdate, dataOrigion.GetValue(delta~\\
\cellcolor{green} & 1 & \verb~174~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~175~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~176~ & & \verb~            MarkIgnoreFields(entityToUpdate);~\\
\cellcolor{green} & 1 & \verb~177~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~178~ & & \verb~~\\
\cellcolor{gray} &  & \verb~179~ & & \verb~        protected virtual E CreateEntityNotFoundException<E>(string entityId, ~\\
\cellcolor{green} & 1 & \verb~180~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~181~ & & \verb~            return (E)Activator.CreateInstance(typeof(E), string.Format("{0} i~\\
\cellcolor{green} & 1 & \verb~182~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~183~ & & \verb~~\\
\cellcolor{gray} &  & \verb~184~ & & \verb~        protected virtual void MarkIgnoreFields(T entityToUpdate)~\\
\cellcolor{green} & 1 & \verb~185~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~186~ & & \verb~            if(IgnoreFieldsOnUpdate.IsValueCreated)~\\
\cellcolor{green} & 1 & \verb~187~ & & \verb~            { IgnoreFieldsOnUpdate.Value.ForEach(ignoreField => Context.Entry(~\\
\cellcolor{gray} &  & \verb~188~ & & \verb~~\\
\cellcolor{gray} &  & \verb~189~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~190~ & & \verb~            if(IgnoreFieldsOnUpdate2.IsValueCreated)~\\
\cellcolor{red} & 0 & \verb~191~ & & \verb~            { IgnoreFieldsOnUpdate2.Value.ForEach(ignoreField => Context.Entry~\\
\cellcolor{green} & 1 & \verb~192~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~193~ & & \verb~~\\
\cellcolor{gray} &  & \verb~194~ & & \verb~        public async virtual Task<int> SaveAsync()~\\
\cellcolor{gray} &  & \verb~195~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~196~ & & \verb~            return await Context.SaveChangesAsync();~\\
\cellcolor{gray} &  & \verb~197~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~198~ & & \verb~~\\
\cellcolor{gray} &  & \verb~199~ & & \verb~        public virtual int Save()~\\
\cellcolor{green} & 1 & \verb~200~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~201~ & & \verb~            return Context.SaveChanges();~\\
\cellcolor{green} & 1 & \verb~202~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~203~ & & \verb~~\\
\cellcolor{gray} &  & \verb~204~ & & \verb~        public virtual int Count()~\\
\cellcolor{green} & 1 & \verb~205~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~206~ & & \verb~            return Context.Set<T>().Count();~\\
\cellcolor{green} & 1 & \verb~207~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~208~ & & \verb~~\\
\cellcolor{gray} &  & \verb~209~ & & \verb~        public async virtual Task<int> CountAsync()~\\
\cellcolor{gray} &  & \verb~210~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~211~ & & \verb~            return await Context.Set<T>().CountAsync();~\\
\cellcolor{gray} &  & \verb~212~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~213~ & & \verb~~\\
\cellcolor{gray} &  & \verb~214~ & & \verb~        #region IDisposable Support~\\
\cellcolor{green} & 1 & \verb~215~ & & \verb~        private bool disposedValue = false; // To detect redundant calls~\\
\cellcolor{gray} &  & \verb~216~ & & \verb~~\\
\cellcolor{gray} &  & \verb~217~ & & \verb~        protected virtual void Dispose(bool disposing)~\\
\cellcolor{green} & 1 & \verb~218~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~219~ & & \verb~            if (!disposedValue)~\\
\cellcolor{green} & 1 & \verb~220~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~221~ & & \verb~                if (disposing)~\\
\cellcolor{green} & 1 & \verb~222~ & & \verb~                {~\\
\cellcolor{green} & 1 & \verb~223~ & & \verb~                    if (Context != null)~\\
\cellcolor{green} & 1 & \verb~224~ & & \verb~                    {~\\
\cellcolor{green} & 1 & \verb~225~ & & \verb~                        Context.Dispose();~\\
\cellcolor{green} & 1 & \verb~226~ & & \verb~                        Context = null;~\\
\cellcolor{green} & 1 & \verb~227~ & & \verb~                    }~\\
\cellcolor{green} & 1 & \verb~228~ & & \verb~                }~\\
\cellcolor{gray} &  & \verb~229~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~230~ & & \verb~                disposedValue = true;~\\
\cellcolor{green} & 1 & \verb~231~ & & \verb~            }~\\
\cellcolor{green} & 1 & \verb~232~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~233~ & & \verb~~\\
\cellcolor{gray} &  & \verb~234~ & & \verb~        public void Dispose()~\\
\cellcolor{green} & 1 & \verb~235~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~236~ & & \verb~            Dispose(true);~\\
\cellcolor{green} & 1 & \verb~237~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~238~ & & \verb~        #endregion~\\
\cellcolor{gray} &  & \verb~239~ & & \verb~~\\
\cellcolor{gray} &  & \verb~240~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~241~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Repository6.DatabaseFactory<C>}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Repository6.DatabaseFactory<C>\\
\textbf{Assembly:} & entityframework.repository6.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{pment\textbackslash EntityFrameworkRepository6\textbackslash EntityFrameworkRepository6\textbackslash DatabaseFactory.cs}\end{minipage} \\
\textbf{Covered lines:} & 0\\
\textbf{Uncovered lines:} & 11\\
\textbf{Coverable lines:} & 11\\
\textbf{Total lines:} & 33\\
\textbf{Line coverage:} & 0\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{DatabaseFactory(stri} & 0 & 3\\
\hline
\textbf{GetNewDbContext()} & 0 & 11\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{pment\textbackslash EntityFrameworkRepository6\textbackslash EntityFrameworkRepository6\textbackslash DatabaseFactory.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using System.Data.Entity;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~namespace EntityFramework.Repository6~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~    public interface IDatabaseFactory<C>~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~        C GetNewDbContext();~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~        Action<string> Logging { get; set; }~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~    public class DatabaseFactory<C> : IDatabaseFactory<C>~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~        where C : DbContext~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~    {~\\
\cellcolor{red} & 0 & \verb~15~ & & \verb~        public Action<string> Logging { get; set; }~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~17~ & & \verb~        protected string dbConnectionString { get; set; }~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~19~ & & \verb~        public DatabaseFactory(string connectionString)~\\
\cellcolor{red} & 0 & \verb~20~ & & \verb~        {~\\
\cellcolor{red} & 0 & \verb~21~ & & \verb~            dbConnectionString = connectionString;~\\
\cellcolor{red} & 0 & \verb~22~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~        public virtual C GetNewDbContext()~\\
\cellcolor{red} & 0 & \verb~25~ & & \verb~        {~\\
\cellcolor{red} & 0 & \verb~26~ & & \verb~            var newContext = (C)Activator.CreateInstance(typeof(C), dbConnecti~\\
\cellcolor{gray} &  & \verb~27~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~28~ & & \verb~            if (Logging != null) { newContext.Database.Log = Logging; }~\\
\cellcolor{gray} &  & \verb~29~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~30~ & & \verb~            return newContext;~\\
\cellcolor{red} & 0 & \verb~31~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~32~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~33~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Repository6.Delta<T>}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Repository6.Delta<T>\\
\textbf{Assembly:} & entityframework.repository6.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{velopment\textbackslash EntityFrameworkRepository6\textbackslash EntityFramework.SharedRepository\textbackslash Delta.cs}\end{minipage} \\
\textbf{Covered lines:} & 23\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 23\\
\textbf{Total lines:} & 43\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{UpdatedFields()} & 3 & 0\\
\hline
\textbf{Delta()} & 7 & 0\\
\hline
\textbf{SetValue(string, obj} & 14 & 0\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{velopment\textbackslash EntityFrameworkRepository6\textbackslash EntityFramework.SharedRepository\textbackslash Delta.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using System.Text;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~namespace EntityFramework.Repository6~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~    public class Delta<T> where T : class~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~11~ & & \verb~        List<string> Fields { get; set; }~\\
\cellcolor{green} & 1 & \verb~12~ & & \verb~        public T Internal { get; set; }~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~        public List<string> UpdatedFields()~\\
\cellcolor{green} & 1 & \verb~15~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~16~ & & \verb~            return Fields;~\\
\cellcolor{green} & 1 & \verb~17~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~19~ & & \verb~        public Delta()~\\
\cellcolor{green} & 1 & \verb~20~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~21~ & & \verb~            Internal = (T)Activator.CreateInstance(typeof(T));~\\
\cellcolor{green} & 1 & \verb~22~ & & \verb~            Fields = new List<string>();~\\
\cellcolor{green} & 1 & \verb~23~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~~\\
\cellcolor{gray} &  & \verb~25~ & & \verb~        public void SetValue(string fieldName, object data)~\\
\cellcolor{green} & 1 & \verb~26~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~27~ & & \verb~            var prop1 = typeof(T).GetProperty(fieldName);~\\
\cellcolor{green} & 1 & \verb~28~ & & \verb~            if (prop1 == null)~\\
\cellcolor{green} & 1 & \verb~29~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~30~ & & \verb~                throw new ArgumentException($"{fieldName} was not a property f~\\
\cellcolor{gray} &  & \verb~31~ & & \verb~            }~\\
\cellcolor{gray} &  & \verb~32~ & & \verb~            try~\\
\cellcolor{green} & 1 & \verb~33~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~34~ & & \verb~                prop1.SetValue(Internal, data);~\\
\cellcolor{green} & 1 & \verb~35~ & & \verb~                Fields.Add(fieldName);~\\
\cellcolor{green} & 1 & \verb~36~ & & \verb~            }~\\
\cellcolor{green} & 1 & \verb~37~ & & \verb~            catch (ArgumentException ex)~\\
\cellcolor{green} & 1 & \verb~38~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~39~ & & \verb~                throw ex;~\\
\cellcolor{gray} &  & \verb~40~ & & \verb~            }~\\
\cellcolor{green} & 1 & \verb~41~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~42~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~43~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Repository6.Tests.DeltaTests}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Repository6.Tests.DeltaTests\\
\textbf{Assembly:} & entityframework.repository6.tests.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{pment\textbackslash EntityFrameworkRepository6\textbackslash EntityFrameworkRepository6Tests\textbackslash DeltaTests.cs}\end{minipage} \\
\textbf{Covered lines:} & 48\\
\textbf{Uncovered lines:} & 2\\
\textbf{Coverable lines:} & 50\\
\textbf{Total lines:} & 111\\
\textbf{Line coverage:} & 96\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{Setup()} & 18 & 0\\
\hline
\textbf{DeltaTest1()} & 16 & 0\\
\hline
\textbf{DeltaTestWrongDataTy} & 8 & 1\\
\hline
\textbf{DeltaTestInvalidFiel} & 8 & 1\\
\hline
\textbf{DeltaTestWithPredica} & 27 & 0\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{pment\textbackslash EntityFrameworkRepository6\textbackslash EntityFrameworkRepository6Tests\textbackslash DeltaTests.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using Microsoft.VisualStudio.TestTools.UnitTesting;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System.Diagnostics;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using Microsoft.Practices.Unity;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using PersistentLayer.Repositories;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using PersistentLayer.Entities;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~using System.Data.Entity.Infrastructure;~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~using EntityFramework.Repository6.Interfaces;~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~using EntityFramework.Repository6;~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~namespace EntityFramework.Repository6.Tests~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~    [TestClass]~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    public class DeltaTests~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~17~ & & \verb~        UnityContainer LocalIoCContainer { get; set; }~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~        [TestInitialize]~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~        public void Setup()~\\
\cellcolor{green} & 1 & \verb~21~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~22~ & & \verb~            Action<string> logSetup = message => Debug.WriteLine(message);~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~24~ & & \verb~            LocalIoCContainer = new UnityContainer();~\\
\cellcolor{green} & 1 & \verb~25~ & & \verb~            LocalIoCContainer.RegisterType<ISimpleDataEntityRepository, Simple~\\
\cellcolor{green} & 1 & \verb~26~ & & \verb~            LocalIoCContainer.RegisterType<ISimpleCompositeKeyEntityRepository~\\
\cellcolor{gray} &  & \verb~27~ & & \verb~~\\
\cellcolor{gray} &  & \verb~28~ & & \verb~            //Use a physical database file~\\
\cellcolor{gray} &  & \verb~29~ & & \verb~            //var connectionString = @"Data Source = (LocalDb)\MSSQLLocalDB; D~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~            //or~\\
\cellcolor{gray} &  & \verb~31~ & & \verb~            //var connectionString = @"TestDatabase";~\\
\cellcolor{gray} &  & \verb~32~ & & \verb~            //LocalIoCContainer.RegisterType(typeof(IDatabaseFactory<>), typeo~\\
\cellcolor{gray} &  & \verb~33~ & & \verb~            //    , new HierarchicalLifetimeManager()~\\
\cellcolor{gray} &  & \verb~34~ & & \verb~            //    , new InjectionConstructor(connectionString)~\\
\cellcolor{gray} &  & \verb~35~ & & \verb~            //    , new InjectionProperty("Logging", logSetup));~\\
\cellcolor{gray} &  & \verb~36~ & & \verb~~\\
\cellcolor{gray} &  & \verb~37~ & & \verb~            //Use an nmemory database~\\
\cellcolor{green} & 1 & \verb~38~ & & \verb~            LocalIoCContainer.RegisterType(typeof(IDatabaseFactory<>), typeof(~\\
\cellcolor{green} & 1 & \verb~39~ & & \verb~                , new HierarchicalLifetimeManager()~\\
\cellcolor{green} & 1 & \verb~40~ & & \verb~                , new InjectionProperty("Logging", logSetup));~\\
\cellcolor{green} & 1 & \verb~41~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~42~ & & \verb~~\\
\cellcolor{gray} &  & \verb~43~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~44~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~45~ & & \verb~        public void DeltaTest1()~\\
\cellcolor{green} & 1 & \verb~46~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~47~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{green} & 1 & \verb~48~ & & \verb~            var newItem = new SimpleDataEntity { Name = "Delta Test" };~\\
\cellcolor{green} & 1 & \verb~49~ & & \verb~            var actual = repository.Add(newItem);~\\
\cellcolor{green} & 1 & \verb~50~ & & \verb~            var result = repository.Save();~\\
\cellcolor{gray} &  & \verb~51~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~52~ & & \verb~            var delta1 = new Delta<SimpleDataEntity>();~\\
\cellcolor{green} & 1 & \verb~53~ & & \verb~            delta1.SetValue("Name", "Delta Change Test");~\\
\cellcolor{gray} &  & \verb~54~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~55~ & & \verb~            repository.Update(delta1, newItem.Id);~\\
\cellcolor{gray} &  & \verb~56~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~57~ & & \verb~            repository.Save();~\\
\cellcolor{gray} &  & \verb~58~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~59~ & & \verb~            var updatedValue = repository.Find(actual.Id);~\\
\cellcolor{green} & 1 & \verb~60~ & & \verb~            Assert.AreEqual("Delta Change Test", updatedValue.Name);~\\
\cellcolor{green} & 1 & \verb~61~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~62~ & & \verb~~\\
\cellcolor{gray} &  & \verb~63~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~64~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~65~ & & \verb~        [ExpectedException(typeof(ArgumentException))]~\\
\cellcolor{gray} &  & \verb~66~ & & \verb~        public void DeltaTestWrongDataType1()~\\
\cellcolor{green} & 1 & \verb~67~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~68~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{green} & 1 & \verb~69~ & & \verb~            var newItem = new SimpleDataEntity { Name = "Delta Test" };~\\
\cellcolor{green} & 1 & \verb~70~ & & \verb~            var actual = repository.Add(newItem);~\\
\cellcolor{green} & 1 & \verb~71~ & & \verb~            var result = repository.Save();~\\
\cellcolor{gray} &  & \verb~72~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~73~ & & \verb~            var delta1 = new Delta<SimpleDataEntity>();~\\
\cellcolor{green} & 1 & \verb~74~ & & \verb~            delta1.SetValue("Name", 1);~\\
\cellcolor{red} & 0 & \verb~75~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~76~ & & \verb~~\\
\cellcolor{gray} &  & \verb~77~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~78~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~79~ & & \verb~        [ExpectedException(typeof(ArgumentException))]~\\
\cellcolor{gray} &  & \verb~80~ & & \verb~        public void DeltaTestInvalidFieldName1()~\\
\cellcolor{green} & 1 & \verb~81~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~82~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{green} & 1 & \verb~83~ & & \verb~            var newItem = new SimpleDataEntity { Name = "Delta Test" };~\\
\cellcolor{green} & 1 & \verb~84~ & & \verb~            var actual = repository.Add(newItem);~\\
\cellcolor{green} & 1 & \verb~85~ & & \verb~            var result = repository.Save();~\\
\cellcolor{gray} &  & \verb~86~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~87~ & & \verb~            var delta1 = new Delta<SimpleDataEntity>();~\\
\cellcolor{green} & 1 & \verb~88~ & & \verb~            delta1.SetValue("NameNotRight", "Right data type");~\\
\cellcolor{red} & 0 & \verb~89~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~90~ & & \verb~~\\
\cellcolor{gray} &  & \verb~91~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~92~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~93~ & & \verb~        public void DeltaTestWithPredicate()~\\
\cellcolor{green} & 1 & \verb~94~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~95~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{green} & 1 & \verb~96~ & & \verb~            var newItem = new SimpleDataEntity { Name = "Delta Test" };~\\
\cellcolor{green} & 1 & \verb~97~ & & \verb~            var actual = repository.Add(newItem);~\\
\cellcolor{green} & 1 & \verb~98~ & & \verb~            var result = repository.Save();~\\
\cellcolor{gray} &  & \verb~99~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~100~ & & \verb~            var delta1 = new Delta<SimpleDataEntity>();~\\
\cellcolor{green} & 1 & \verb~101~ & & \verb~            delta1.SetValue("Name", "Delta Change Test");~\\
\cellcolor{gray} &  & \verb~102~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~103~ & & \verb~            repository.Update(delta1, x=>x.Id == newItem.Id);~\\
\cellcolor{gray} &  & \verb~104~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~105~ & & \verb~            repository.Save();~\\
\cellcolor{gray} &  & \verb~106~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~107~ & & \verb~            var updatedValue = repository.Find(actual.Id);~\\
\cellcolor{green} & 1 & \verb~108~ & & \verb~            Assert.AreEqual("Delta Change Test", updatedValue.Name);~\\
\cellcolor{green} & 1 & \verb~109~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~110~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~111~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Repository6.Tests.RepositoryCreateTests}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Repository6.Tests.RepositoryCreateTests\\
\textbf{Assembly:} & entityframework.repository6.tests.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{yFrameworkRepository6\textbackslash EntityFrameworkRepository6Tests\textbackslash RepositoryCreateTests.cs}\end{minipage} \\
\textbf{Covered lines:} & 80\\
\textbf{Uncovered lines:} & 1\\
\textbf{Coverable lines:} & 81\\
\textbf{Total lines:} & 165\\
\textbf{Line coverage:} & 98.7\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{Setup()} & 18 & 0\\
\hline
\textbf{InsertTestMethod()} & 14 & 0\\
\hline
\textbf{InsertTestMethod2()} & 14 & 0\\
\hline
\textbf{InsertTestMethod3()} & 14 & 0\\
\hline
\textbf{InsertMultipleTest()} & 20 & 0\\
\hline
\textbf{InsertIntoCompositeK} & 24 & 0\\
\hline
\textbf{InsertDuplicateIntoC} & 17 & 1\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{yFrameworkRepository6\textbackslash EntityFrameworkRepository6Tests\textbackslash RepositoryCreateTests.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using Microsoft.VisualStudio.TestTools.UnitTesting;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System.Diagnostics;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using Microsoft.Practices.Unity;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using PersistentLayer.Repositories;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using PersistentLayer.Entities;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~using System.Data.Entity.Infrastructure;~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~using EntityFramework.Repository6;~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~namespace EntityFramework.Repository6.Tests~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~    [TestClass]~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    public class RepositoryCreateTests~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~17~ & & \verb~        UnityContainer LocalIoCContainer { get; set; }~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~        [TestInitialize]~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~        public void Setup()~\\
\cellcolor{green} & 1 & \verb~21~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~22~ & & \verb~            Action<string> logSetup = message => Debug.WriteLine(message);~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~24~ & & \verb~            LocalIoCContainer = new UnityContainer();~\\
\cellcolor{green} & 1 & \verb~25~ & & \verb~            LocalIoCContainer.RegisterType<ISimpleDataEntityRepository, Simple~\\
\cellcolor{green} & 1 & \verb~26~ & & \verb~            LocalIoCContainer.RegisterType<ISimpleCompositeKeyEntityRepository~\\
\cellcolor{gray} &  & \verb~27~ & & \verb~~\\
\cellcolor{gray} &  & \verb~28~ & & \verb~            //Use a physical database file~\\
\cellcolor{gray} &  & \verb~29~ & & \verb~            //var connectionString = @"Data Source = (LocalDb)\MSSQLLocalDB; D~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~            //or~\\
\cellcolor{gray} &  & \verb~31~ & & \verb~            //var connectionString = @"TestDatabase";~\\
\cellcolor{gray} &  & \verb~32~ & & \verb~            //LocalIoCContainer.RegisterType(typeof(IDatabaseFactory<>), typeo~\\
\cellcolor{gray} &  & \verb~33~ & & \verb~            //    , new HierarchicalLifetimeManager()~\\
\cellcolor{gray} &  & \verb~34~ & & \verb~            //    , new InjectionConstructor(connectionString)~\\
\cellcolor{gray} &  & \verb~35~ & & \verb~            //    , new InjectionProperty("Logging", logSetup));~\\
\cellcolor{gray} &  & \verb~36~ & & \verb~~\\
\cellcolor{gray} &  & \verb~37~ & & \verb~            //Use an nmemory database~\\
\cellcolor{green} & 1 & \verb~38~ & & \verb~            LocalIoCContainer.RegisterType(typeof(IDatabaseFactory<>), typeof(~\\
\cellcolor{green} & 1 & \verb~39~ & & \verb~                , new HierarchicalLifetimeManager()~\\
\cellcolor{green} & 1 & \verb~40~ & & \verb~                , new InjectionProperty("Logging", logSetup));~\\
\cellcolor{green} & 1 & \verb~41~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~42~ & & \verb~~\\
\cellcolor{gray} &  & \verb~43~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~44~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~45~ & & \verb~        public void InsertTestMethod()~\\
\cellcolor{green} & 1 & \verb~46~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~47~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{green} & 1 & \verb~48~ & & \verb~            var newItem = new SimpleDataEntity { Name = "My Test" };~\\
\cellcolor{green} & 1 & \verb~49~ & & \verb~            var actual = repository.Add(newItem);~\\
\cellcolor{green} & 1 & \verb~50~ & & \verb~            var result = repository.Save();~\\
\cellcolor{gray} &  & \verb~51~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~52~ & & \verb~            Assert.AreNotEqual(0, actual.Id);~\\
\cellcolor{gray} &  & \verb~53~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~54~ & & \verb~            var actual2 = repository.Find(actual.Id);~\\
\cellcolor{gray} &  & \verb~55~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~56~ & & \verb~            Assert.AreEqual("My Test", actual2.Name);~\\
\cellcolor{gray} &  & \verb~57~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~58~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~59~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~60~ & & \verb~~\\
\cellcolor{gray} &  & \verb~61~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~62~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~63~ & & \verb~        public void InsertTestMethod2()~\\
\cellcolor{green} & 1 & \verb~64~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~65~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{green} & 1 & \verb~66~ & & \verb~            var newItem = new SimpleDataEntity { Name = "My Test 200" };~\\
\cellcolor{green} & 1 & \verb~67~ & & \verb~            var actual = repository.Add(newItem);~\\
\cellcolor{green} & 1 & \verb~68~ & & \verb~            var result = repository.Save();~\\
\cellcolor{gray} &  & \verb~69~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~70~ & & \verb~            Assert.AreNotEqual(0, actual.Id);~\\
\cellcolor{gray} &  & \verb~71~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~72~ & & \verb~            var actual2 = repository.Find(actual.Id);~\\
\cellcolor{gray} &  & \verb~73~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~74~ & & \verb~            Assert.AreEqual("My Test 200", actual2.Name);~\\
\cellcolor{gray} &  & \verb~75~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~76~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~77~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~78~ & & \verb~~\\
\cellcolor{gray} &  & \verb~79~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~80~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~81~ & & \verb~        public void InsertTestMethod3()~\\
\cellcolor{green} & 1 & \verb~82~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~83~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{green} & 1 & \verb~84~ & & \verb~            var newItem = new SimpleDataEntity { Name = "My Test 300" };~\\
\cellcolor{green} & 1 & \verb~85~ & & \verb~            var actual = repository.Add(newItem);~\\
\cellcolor{green} & 1 & \verb~86~ & & \verb~            var result = repository.Save();~\\
\cellcolor{gray} &  & \verb~87~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~88~ & & \verb~            Assert.AreNotEqual(0, actual.Id);~\\
\cellcolor{gray} &  & \verb~89~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~90~ & & \verb~            var actual2 = repository.Find(actual.Id);~\\
\cellcolor{gray} &  & \verb~91~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~92~ & & \verb~            Assert.AreEqual("My Test 300", actual2.Name);~\\
\cellcolor{gray} &  & \verb~93~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~94~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~95~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~96~ & & \verb~~\\
\cellcolor{gray} &  & \verb~97~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~98~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~99~ & & \verb~        public void InsertMultipleTest()~\\
\cellcolor{green} & 1 & \verb~100~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~101~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~102~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~103~ & & \verb~            var actual1 = repository.Count();~\\
\cellcolor{gray} &  & \verb~104~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~105~ & & \verb~            var newItem1 = new SimpleDataEntity { Name = "Multiple Item 1" };~\\
\cellcolor{green} & 1 & \verb~106~ & & \verb~            var newItem2 = new SimpleDataEntity { Name = "Multiple Item 2" };~\\
\cellcolor{green} & 1 & \verb~107~ & & \verb~            var newItem3 = new SimpleDataEntity { Name = "Multiple Item 3" };~\\
\cellcolor{green} & 1 & \verb~108~ & & \verb~            var actual = repository.Add(new List<SimpleDataEntity>~\\
\cellcolor{green} & 1 & \verb~109~ & & \verb~            {~\\
\cellcolor{green} & 1 & \verb~110~ & & \verb~                newItem1~\\
\cellcolor{green} & 1 & \verb~111~ & & \verb~                , newItem2~\\
\cellcolor{green} & 1 & \verb~112~ & & \verb~                , newItem3~\\
\cellcolor{green} & 1 & \verb~113~ & & \verb~            });~\\
\cellcolor{green} & 1 & \verb~114~ & & \verb~            var result = repository.Save();~\\
\cellcolor{gray} &  & \verb~115~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~116~ & & \verb~            var actual2 = repository.Count();~\\
\cellcolor{gray} &  & \verb~117~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~118~ & & \verb~            Assert.AreEqual(7, actual1);~\\
\cellcolor{green} & 1 & \verb~119~ & & \verb~            Assert.AreEqual(10, actual2);~\\
\cellcolor{gray} &  & \verb~120~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~121~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~122~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~123~ & & \verb~~\\
\cellcolor{gray} &  & \verb~124~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~125~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~126~ & & \verb~        public void InsertIntoCompositeKeyTableMethod()~\\
\cellcolor{green} & 1 & \verb~127~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~128~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleCompositeKeyEnti~\\
\cellcolor{green} & 1 & \verb~129~ & & \verb~            var newItem = new SimpleCompositeKeyEntity { Id = 1, Name = "Compo~\\
\cellcolor{green} & 1 & \verb~130~ & & \verb~            var actual = repository.Add(newItem);~\\
\cellcolor{green} & 1 & \verb~131~ & & \verb~            var result = repository.Save();~\\
\cellcolor{gray} &  & \verb~132~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~133~ & & \verb~            Assert.AreNotEqual(0, actual.Id);~\\
\cellcolor{gray} &  & \verb~134~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~135~ & & \verb~            var actual2 = repository.Find(actual.Id, actual.Name);~\\
\cellcolor{gray} &  & \verb~136~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~137~ & & \verb~            var saveAgain = repository.Add(new SimpleCompositeKeyEntity { Id =~\\
\cellcolor{green} & 1 & \verb~138~ & & \verb~            var result2 = repository.Save();~\\
\cellcolor{gray} &  & \verb~139~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~140~ & & \verb~            Assert.AreNotEqual(actual.Id, saveAgain.Id);~\\
\cellcolor{gray} &  & \verb~141~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~142~ & & \verb~            Assert.AreEqual("Composite Test", actual2.Name);~\\
\cellcolor{gray} &  & \verb~143~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~144~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~145~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~146~ & & \verb~~\\
\cellcolor{gray} &  & \verb~147~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~148~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~149~ & & \verb~        [ExpectedException(typeof(DbUpdateException))]~\\
\cellcolor{gray} &  & \verb~150~ & & \verb~        public void InsertDuplicateIntoCompositeKeyTableMethod()~\\
\cellcolor{green} & 1 & \verb~151~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~152~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleCompositeKeyEnti~\\
\cellcolor{green} & 1 & \verb~153~ & & \verb~            var newItem = new SimpleCompositeKeyEntity { Id = 1, Name = "Compo~\\
\cellcolor{green} & 1 & \verb~154~ & & \verb~            var actual = repository.Add(newItem);~\\
\cellcolor{green} & 1 & \verb~155~ & & \verb~            var result = repository.Save();~\\
\cellcolor{gray} &  & \verb~156~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~157~ & & \verb~            Assert.AreNotEqual(0, actual.Id);~\\
\cellcolor{gray} &  & \verb~158~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~159~ & & \verb~            var actual2 = repository.Find(actual.Id, actual.Name);~\\
\cellcolor{gray} &  & \verb~160~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~161~ & & \verb~            var saveAgain = repository.Add(new SimpleCompositeKeyEntity { Id =~\\
\cellcolor{green} & 1 & \verb~162~ & & \verb~            var result2 = repository.Save();~\\
\cellcolor{red} & 0 & \verb~163~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~164~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~165~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Repository6.Tests.RepositoryDeleteTests}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Repository6.Tests.RepositoryDeleteTests\\
\textbf{Assembly:} & entityframework.repository6.tests.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{yFrameworkRepository6\textbackslash EntityFrameworkRepository6Tests\textbackslash RepositoryDeleteTests.cs}\end{minipage} \\
\textbf{Covered lines:} & 32\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 32\\
\textbf{Total lines:} & 87\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{Setup()} & 18 & 0\\
\hline
\textbf{DeleteTestMethod()} & 11 & 0\\
\hline
\textbf{DeleteMultipleTestMe} & 25 & 0\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{yFrameworkRepository6\textbackslash EntityFrameworkRepository6Tests\textbackslash RepositoryDeleteTests.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using Microsoft.Practices.Unity;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using Microsoft.VisualStudio.TestTools.UnitTesting;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using PersistentLayer.Entities;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using PersistentLayer.Repositories;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using System.Diagnostics;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~using System.Text;~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~namespace EntityFramework.Repository6.Tests~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~    [TestClass]~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    public class RepositoryDeleteTests~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~17~ & & \verb~        UnityContainer LocalIoCContainer { get; set; }~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~        [TestInitialize]~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~        public void Setup()~\\
\cellcolor{green} & 1 & \verb~21~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~22~ & & \verb~            Action<string> logSetup = message => Debug.WriteLine(message);~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~24~ & & \verb~            LocalIoCContainer = new UnityContainer();~\\
\cellcolor{green} & 1 & \verb~25~ & & \verb~            LocalIoCContainer.RegisterType<ISimpleDataEntityRepository, Simple~\\
\cellcolor{green} & 1 & \verb~26~ & & \verb~            LocalIoCContainer.RegisterType<ISimpleCompositeKeyEntityRepository~\\
\cellcolor{gray} &  & \verb~27~ & & \verb~~\\
\cellcolor{gray} &  & \verb~28~ & & \verb~            //Use a physical database file~\\
\cellcolor{gray} &  & \verb~29~ & & \verb~            //var connectionString = @"Data Source = (LocalDb)\MSSQLLocalDB; D~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~            //or~\\
\cellcolor{gray} &  & \verb~31~ & & \verb~            //var connectionString = @"TestDatabase";~\\
\cellcolor{gray} &  & \verb~32~ & & \verb~            //LocalIoCContainer.RegisterType(typeof(IDatabaseFactory<>), typeo~\\
\cellcolor{gray} &  & \verb~33~ & & \verb~            //    , new HierarchicalLifetimeManager()~\\
\cellcolor{gray} &  & \verb~34~ & & \verb~            //    , new InjectionConstructor(connectionString)~\\
\cellcolor{gray} &  & \verb~35~ & & \verb~            //    , new InjectionProperty("Logging", logSetup));~\\
\cellcolor{gray} &  & \verb~36~ & & \verb~~\\
\cellcolor{gray} &  & \verb~37~ & & \verb~            //Use an nmemory database~\\
\cellcolor{green} & 1 & \verb~38~ & & \verb~            LocalIoCContainer.RegisterType(typeof(IDatabaseFactory<>), typeof(~\\
\cellcolor{green} & 1 & \verb~39~ & & \verb~                , new HierarchicalLifetimeManager()~\\
\cellcolor{green} & 1 & \verb~40~ & & \verb~                , new InjectionProperty("Logging", logSetup));~\\
\cellcolor{green} & 1 & \verb~41~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~42~ & & \verb~~\\
\cellcolor{gray} &  & \verb~43~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~44~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~45~ & & \verb~        public void DeleteTestMethod()~\\
\cellcolor{green} & 1 & \verb~46~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~47~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~48~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~49~ & & \verb~            var actual1 = repository.Count();~\\
\cellcolor{gray} &  & \verb~50~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~51~ & & \verb~            var itemToDelete = repository.Find(1);~\\
\cellcolor{gray} &  & \verb~52~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~53~ & & \verb~            repository.Delete(itemToDelete);~\\
\cellcolor{gray} &  & \verb~54~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~55~ & & \verb~            repository.Save();~\\
\cellcolor{gray} &  & \verb~56~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~57~ & & \verb~            var actual2 = repository.Count();~\\
\cellcolor{gray} &  & \verb~58~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~59~ & & \verb~            Assert.AreEqual(7, actual1);~\\
\cellcolor{green} & 1 & \verb~60~ & & \verb~            Assert.AreEqual(6, actual2);~\\
\cellcolor{gray} &  & \verb~61~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~62~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~63~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~64~ & & \verb~~\\
\cellcolor{gray} &  & \verb~65~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~66~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~67~ & & \verb~        public void DeleteMultipleTestMethod()~\\
\cellcolor{green} & 1 & \verb~68~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~69~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~70~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~71~ & & \verb~            var actual1 = repository.Count();~\\
\cellcolor{gray} &  & \verb~72~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~73~ & & \verb~            var itemsToDelete = repository.FindBy(x => x.Id == 1 || x.Id == 2)~\\
\cellcolor{gray} &  & \verb~74~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~75~ & & \verb~            repository.Delete(itemsToDelete);~\\
\cellcolor{gray} &  & \verb~76~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~77~ & & \verb~            repository.Save();~\\
\cellcolor{gray} &  & \verb~78~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~79~ & & \verb~            var actual2 = repository.Count();~\\
\cellcolor{gray} &  & \verb~80~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~81~ & & \verb~            Assert.AreEqual(7, actual1);~\\
\cellcolor{green} & 1 & \verb~82~ & & \verb~            Assert.AreEqual(5, actual2);~\\
\cellcolor{gray} &  & \verb~83~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~84~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~85~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~86~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~87~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Repository6.Tests.RepositoryReadTests}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Repository6.Tests.RepositoryReadTests\\
\textbf{Assembly:} & entityframework.repository6.tests.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{ityFrameworkRepository6\textbackslash EntityFrameworkRepository6Tests\textbackslash RepositoryReadTests.cs}\end{minipage} \\
\textbf{Covered lines:} & 78\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 78\\
\textbf{Total lines:} & 178\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{Setup()} & 18 & 0\\
\hline
\textbf{GetAllFromSimpleData} & 7 & 0\\
\hline
\textbf{CountOfSimpleDataEnt} & 6 & 0\\
\hline
\textbf{FindTestMethod1()} & 7 & 0\\
\hline
\textbf{SelectTestMethod()} & 16 & 0\\
\hline
\textbf{FindAsyncTest()} & 8 & 0\\
\hline
\textbf{FindAsyncMultiplePar} & 8 & 0\\
\hline
\textbf{FindByReadOnlyTestAu} & 16 & 0\\
\hline
\textbf{ExistsTestAudit()} & 14 & 0\\
\hline
\textbf{FindAndReloadAsyncTe} & 15 & 0\\
\hline
\textbf{FindAndReloadTestAud} & 13 & 0\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{ityFrameworkRepository6\textbackslash EntityFrameworkRepository6Tests\textbackslash RepositoryReadTests.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using Microsoft.VisualStudio.TestTools.UnitTesting;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System.Diagnostics;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using Microsoft.Practices.Unity;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using PersistentLayer.Repositories;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using EntityFramework.Repository6;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~namespace EntityFramework.Repository6.Tests~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~    [TestClass]~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~    public class RepositoryReadTests~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~14~ & & \verb~        UnityContainer LocalIoCContainer { get; set; }~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~        [TestInitialize]~\\
\cellcolor{gray} &  & \verb~17~ & & \verb~        public void Setup()~\\
\cellcolor{green} & 1 & \verb~18~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~19~ & & \verb~            Action<string> logSetup = message => Debug.WriteLine(message);~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~21~ & & \verb~            LocalIoCContainer = new UnityContainer();~\\
\cellcolor{green} & 1 & \verb~22~ & & \verb~            LocalIoCContainer.RegisterType<ISimpleDataEntityRepository, Simple~\\
\cellcolor{green} & 1 & \verb~23~ & & \verb~            LocalIoCContainer.RegisterType<ISimpleCompositeKeyEntityRepository~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~~\\
\cellcolor{gray} &  & \verb~25~ & & \verb~            //Use a physical database file~\\
\cellcolor{gray} &  & \verb~26~ & & \verb~            //var connectionString = @"Data Source = (LocalDb)\MSSQLLocalDB; D~\\
\cellcolor{gray} &  & \verb~27~ & & \verb~            //or~\\
\cellcolor{gray} &  & \verb~28~ & & \verb~            //var connectionString = @"TestDatabase";~\\
\cellcolor{gray} &  & \verb~29~ & & \verb~            //LocalIoCContainer.RegisterType(typeof(IDatabaseFactory<>), typeo~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~            //    , new HierarchicalLifetimeManager()~\\
\cellcolor{gray} &  & \verb~31~ & & \verb~            //    , new InjectionConstructor(connectionString)~\\
\cellcolor{gray} &  & \verb~32~ & & \verb~            //    , new InjectionProperty("Logging", logSetup));~\\
\cellcolor{gray} &  & \verb~33~ & & \verb~~\\
\cellcolor{gray} &  & \verb~34~ & & \verb~            //Use an nmemory database~\\
\cellcolor{green} & 1 & \verb~35~ & & \verb~            LocalIoCContainer.RegisterType(typeof(IDatabaseFactory<>), typeof(~\\
\cellcolor{green} & 1 & \verb~36~ & & \verb~                , new HierarchicalLifetimeManager()~\\
\cellcolor{green} & 1 & \verb~37~ & & \verb~                , new InjectionProperty("Logging", logSetup));~\\
\cellcolor{green} & 1 & \verb~38~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~39~ & & \verb~~\\
\cellcolor{gray} &  & \verb~40~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~41~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~42~ & & \verb~        public void GetAllFromSimpleDataEntitiesTable()~\\
\cellcolor{green} & 1 & \verb~43~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~44~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~45~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~46~ & & \verb~            var actual = repository.GetAll();~\\
\cellcolor{green} & 1 & \verb~47~ & & \verb~            Assert.AreEqual(7, actual.Count());~\\
\cellcolor{gray} &  & \verb~48~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~49~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~50~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~51~ & & \verb~~\\
\cellcolor{gray} &  & \verb~52~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~53~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~54~ & & \verb~        public void CountOfSimpleDataEntitiesTable()~\\
\cellcolor{green} & 1 & \verb~55~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~56~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~57~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~58~ & & \verb~            var actual = repository.Count();~\\
\cellcolor{green} & 1 & \verb~59~ & & \verb~            Assert.AreEqual(7, actual);~\\
\cellcolor{gray} &  & \verb~60~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~61~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~62~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~63~ & & \verb~~\\
\cellcolor{gray} &  & \verb~64~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~65~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~66~ & & \verb~        public void FindTestMethod1()~\\
\cellcolor{green} & 1 & \verb~67~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~68~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~69~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~70~ & & \verb~            var actual = repository.Find(1);~\\
\cellcolor{green} & 1 & \verb~71~ & & \verb~            Assert.AreEqual("Test 1", actual.Name);~\\
\cellcolor{gray} &  & \verb~72~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~73~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~74~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~75~ & & \verb~~\\
\cellcolor{gray} &  & \verb~76~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~77~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~78~ & & \verb~        public void SelectTestMethod()~\\
\cellcolor{green} & 1 & \verb~79~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~80~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~81~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~82~ & & \verb~            var actual = repository.FindBy(x => x.Id == 2).FirstOrDefault();~\\
\cellcolor{green} & 1 & \verb~83~ & & \verb~            Assert.AreEqual("Test 2", actual.Name);~\\
\cellcolor{gray} &  & \verb~84~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~85~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~86~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~87~ & & \verb~~\\
\cellcolor{gray} &  & \verb~88~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~89~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~90~ & & \verb~        public void FindAsyncTest()~\\
\cellcolor{green} & 1 & \verb~91~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~92~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~93~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~94~ & & \verb~            var actual = repository.FindAsync(2);~\\
\cellcolor{green} & 1 & \verb~95~ & & \verb~            Assert.AreEqual("Test 2", actual.Result.Name);~\\
\cellcolor{gray} &  & \verb~96~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~97~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~98~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~99~ & & \verb~~\\
\cellcolor{gray} &  & \verb~100~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~101~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~102~ & & \verb~        public void FindAsyncMultipleParamsTest()~\\
\cellcolor{green} & 1 & \verb~103~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~104~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleCompositeKeyEnti~\\
\cellcolor{gray} &  & \verb~105~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~106~ & & \verb~            var actual = repository.FindAsync(1, "Another Key");~\\
\cellcolor{green} & 1 & \verb~107~ & & \verb~            Assert.AreEqual("Another Key", actual.Result.Name);~\\
\cellcolor{gray} &  & \verb~108~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~109~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~110~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~111~ & & \verb~~\\
\cellcolor{gray} &  & \verb~112~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~113~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~114~ & & \verb~        public void FindByReadOnlyTestAudit()~\\
\cellcolor{green} & 1 & \verb~115~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~116~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~117~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~118~ & & \verb~            var actual = repository.FindByReadOnly(x => x.Id == 1).SingleOrDef~\\
\cellcolor{green} & 1 & \verb~119~ & & \verb~            Assert.AreEqual("Test 1", actual.Name);~\\
\cellcolor{gray} &  & \verb~120~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~121~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~122~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~123~ & & \verb~~\\
\cellcolor{gray} &  & \verb~124~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~125~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~126~ & & \verb~        public void ExistsTestAudit()~\\
\cellcolor{green} & 1 & \verb~127~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~128~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~129~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~130~ & & \verb~            var actual = repository.Exists(x => x.Id == 1);~\\
\cellcolor{green} & 1 & \verb~131~ & & \verb~            Assert.IsTrue(actual);~\\
\cellcolor{gray} &  & \verb~132~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~133~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~134~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~135~ & & \verb~~\\
\cellcolor{gray} &  & \verb~136~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~137~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~138~ & & \verb~        public void FindAndReloadAsyncTestAudit()~\\
\cellcolor{green} & 1 & \verb~139~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~140~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~141~ & & \verb~~\\
\cellcolor{gray} &  & \verb~142~ & & \verb~            //Load the entity~\\
\cellcolor{green} & 1 & \verb~143~ & & \verb~            var actualEntity = repository.FindAsync(2).Result;~\\
\cellcolor{green} & 1 & \verb~144~ & & \verb~            Assert.AreEqual("Test 2", actualEntity.Name);~\\
\cellcolor{gray} &  & \verb~145~ & & \verb~~\\
\cellcolor{gray} &  & \verb~146~ & & \verb~            //Alter the entity~\\
\cellcolor{green} & 1 & \verb~147~ & & \verb~            actualEntity.Name = "Test 10";~\\
\cellcolor{green} & 1 & \verb~148~ & & \verb~            Assert.AreEqual("Test 10", actualEntity.Name);~\\
\cellcolor{gray} &  & \verb~149~ & & \verb~~\\
\cellcolor{gray} &  & \verb~150~ & & \verb~            //Reload the entity from the database, resetting the data~\\
\cellcolor{green} & 1 & \verb~151~ & & \verb~            repository.ReloadAsync(actualEntity).Wait();~\\
\cellcolor{gray} &  & \verb~152~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~153~ & & \verb~            Assert.AreEqual("Test 2", actualEntity.Name);~\\
\cellcolor{green} & 1 & \verb~154~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~155~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~156~ & & \verb~~\\
\cellcolor{gray} &  & \verb~157~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~158~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~159~ & & \verb~        public void FindAndReloadTestAudit()~\\
\cellcolor{green} & 1 & \verb~160~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~161~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~162~ & & \verb~~\\
\cellcolor{gray} &  & \verb~163~ & & \verb~            //Load the entity~\\
\cellcolor{green} & 1 & \verb~164~ & & \verb~            var actualEntity = repository.Find(2);~\\
\cellcolor{green} & 1 & \verb~165~ & & \verb~            Assert.AreEqual("Test 2", actualEntity.Name);~\\
\cellcolor{gray} &  & \verb~166~ & & \verb~~\\
\cellcolor{gray} &  & \verb~167~ & & \verb~            //Alter the entity~\\
\cellcolor{green} & 1 & \verb~168~ & & \verb~            actualEntity.Name = "Test 10";~\\
\cellcolor{green} & 1 & \verb~169~ & & \verb~            Assert.AreEqual("Test 10", actualEntity.Name);~\\
\cellcolor{gray} &  & \verb~170~ & & \verb~~\\
\cellcolor{gray} &  & \verb~171~ & & \verb~            //Reload the entity from the database, resetting the data~\\
\cellcolor{green} & 1 & \verb~172~ & & \verb~            repository.Reload(actualEntity);~\\
\cellcolor{gray} &  & \verb~173~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~174~ & & \verb~            Assert.AreEqual("Test 2", actualEntity.Name);~\\
\cellcolor{green} & 1 & \verb~175~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~176~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~177~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~178~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Repository6.Tests.RepositoryUpdateTests}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Repository6.Tests.RepositoryUpdateTests\\
\textbf{Assembly:} & entityframework.repository6.tests.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{yFrameworkRepository6\textbackslash EntityFrameworkRepository6Tests\textbackslash RepositoryUpdateTests.cs}\end{minipage} \\
\textbf{Covered lines:} & 46\\
\textbf{Uncovered lines:} & 1\\
\textbf{Coverable lines:} & 47\\
\textbf{Total lines:} & 112\\
\textbf{Line coverage:} & 97.8\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{Setup()} & 18 & 0\\
\hline
\textbf{UpdateTestMethod()} & 12 & 0\\
\hline
\textbf{UpdateTestMethodWith} & 13 & 0\\
\hline
\textbf{UpdateByTestMethod()} & 19 & 0\\
\hline
\textbf{UpdateByTestMethodIn} & 13 & 1\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{yFrameworkRepository6\textbackslash EntityFrameworkRepository6Tests\textbackslash RepositoryUpdateTests.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using Microsoft.Practices.Unity;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using Microsoft.VisualStudio.TestTools.UnitTesting;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using PersistentLayer.Entities;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using PersistentLayer.Repositories;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Data.Entity.Infrastructure;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using System.Diagnostics;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~using EntityFramework.Repository6.Interfaces;~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~using EntityFramework.Repository6;~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~namespace EntityFramework.Repository6.Tests~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~    [TestClass]~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    public class RepositoryUpdateTests~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~17~ & & \verb~        UnityContainer LocalIoCContainer { get; set; }~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~        [TestInitialize]~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~        public void Setup()~\\
\cellcolor{green} & 1 & \verb~21~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~22~ & & \verb~            Action<string> logSetup = message => Debug.WriteLine(message);~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~24~ & & \verb~            LocalIoCContainer = new UnityContainer();~\\
\cellcolor{green} & 1 & \verb~25~ & & \verb~            LocalIoCContainer.RegisterType<ISimpleDataEntityRepository, Simple~\\
\cellcolor{green} & 1 & \verb~26~ & & \verb~            LocalIoCContainer.RegisterType<ISimpleCompositeKeyEntityRepository~\\
\cellcolor{gray} &  & \verb~27~ & & \verb~~\\
\cellcolor{gray} &  & \verb~28~ & & \verb~            //Use a physical database file~\\
\cellcolor{gray} &  & \verb~29~ & & \verb~            //Direct connection string~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~            //var connectionString = @"Data Source = (LocalDb)\MSSQLLocalDB; D~\\
\cellcolor{gray} &  & \verb~31~ & & \verb~            //or~\\
\cellcolor{gray} &  & \verb~32~ & & \verb~            //Computed connection~\\
\cellcolor{gray} &  & \verb~33~ & & \verb~            //var connectionString = @"TestDatabase";~\\
\cellcolor{gray} &  & \verb~34~ & & \verb~            //LocalIoCContainer.RegisterType(typeof(IDatabaseFactory<>), typeo~\\
\cellcolor{gray} &  & \verb~35~ & & \verb~            //    , new HierarchicalLifetimeManager()~\\
\cellcolor{gray} &  & \verb~36~ & & \verb~            //    , new InjectionConstructor(connectionString)~\\
\cellcolor{gray} &  & \verb~37~ & & \verb~            //    , new InjectionProperty("Logging", logSetup));~\\
\cellcolor{gray} &  & \verb~38~ & & \verb~~\\
\cellcolor{gray} &  & \verb~39~ & & \verb~            //Use an nmemory database~\\
\cellcolor{green} & 1 & \verb~40~ & & \verb~            LocalIoCContainer.RegisterType(typeof(IDatabaseFactory<>), typeof(~\\
\cellcolor{green} & 1 & \verb~41~ & & \verb~                , new HierarchicalLifetimeManager()~\\
\cellcolor{green} & 1 & \verb~42~ & & \verb~                , new InjectionProperty("Logging", logSetup));~\\
\cellcolor{green} & 1 & \verb~43~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~44~ & & \verb~~\\
\cellcolor{gray} &  & \verb~45~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~46~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~47~ & & \verb~        public void UpdateTestMethod()~\\
\cellcolor{green} & 1 & \verb~48~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~49~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~50~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~51~ & & \verb~            var itemToUpdate = repository.Find(2);~\\
\cellcolor{green} & 1 & \verb~52~ & & \verb~            itemToUpdate.Name = "Updated Name";~\\
\cellcolor{green} & 1 & \verb~53~ & & \verb~            repository.Update(itemToUpdate, itemToUpdate.Id);~\\
\cellcolor{green} & 1 & \verb~54~ & & \verb~            repository.Save();~\\
\cellcolor{gray} &  & \verb~55~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~56~ & & \verb~            var actual = repository.Find(2);~\\
\cellcolor{gray} &  & \verb~57~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~58~ & & \verb~            Assert.AreEqual("Updated Name", actual.Name);~\\
\cellcolor{gray} &  & \verb~59~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~60~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~61~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~62~ & & \verb~~\\
\cellcolor{gray} &  & \verb~63~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~64~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~65~ & & \verb~        public void UpdateTestMethodWithIgnoreFieldFeature()~\\
\cellcolor{green} & 1 & \verb~66~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~67~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{green} & 1 & \verb~68~ & & \verb~            repository.AddUpdateIgnoreField("Name");~\\
\cellcolor{gray} &  & \verb~69~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~70~ & & \verb~            var itemToUpdate = repository.Find(2);~\\
\cellcolor{green} & 1 & \verb~71~ & & \verb~            itemToUpdate.Name = "Updated Name";~\\
\cellcolor{green} & 1 & \verb~72~ & & \verb~            repository.Update(itemToUpdate, itemToUpdate.Id);~\\
\cellcolor{green} & 1 & \verb~73~ & & \verb~            repository.Save();~\\
\cellcolor{gray} &  & \verb~74~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~75~ & & \verb~            var actual = repository.Find(2);~\\
\cellcolor{gray} &  & \verb~76~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~77~ & & \verb~            Assert.AreNotEqual("Updated Name", actual.Name);~\\
\cellcolor{gray} &  & \verb~78~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~79~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~80~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~81~ & & \verb~~\\
\cellcolor{gray} &  & \verb~82~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~83~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~84~ & & \verb~        public void UpdateByTestMethod()~\\
\cellcolor{green} & 1 & \verb~85~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~86~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~87~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~88~ & & \verb~            var itemToUpdate = repository.Find(2);~\\
\cellcolor{green} & 1 & \verb~89~ & & \verb~            itemToUpdate.Name = "Updated Name 2";~\\
\cellcolor{green} & 1 & \verb~90~ & & \verb~            repository.Update(itemToUpdate, x => x.Id == 2);~\\
\cellcolor{green} & 1 & \verb~91~ & & \verb~            repository.Save();~\\
\cellcolor{gray} &  & \verb~92~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~93~ & & \verb~            var actual = repository.Find(2);~\\
\cellcolor{gray} &  & \verb~94~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~95~ & & \verb~            Assert.AreEqual("Updated Name 2", actual.Name);~\\
\cellcolor{gray} &  & \verb~96~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~97~ & & \verb~            repository.Dispose();~\\
\cellcolor{green} & 1 & \verb~98~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~99~ & & \verb~~\\
\cellcolor{gray} &  & \verb~100~ & & \verb~        [TestCategory("StandardRepository")]~\\
\cellcolor{gray} &  & \verb~101~ & & \verb~        [TestMethod]~\\
\cellcolor{gray} &  & \verb~102~ & & \verb~        [ExpectedException(typeof(ArgumentOutOfRangeException))]~\\
\cellcolor{gray} &  & \verb~103~ & & \verb~        public void UpdateByTestMethodIncorrectId()~\\
\cellcolor{green} & 1 & \verb~104~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~105~ & & \verb~            var repository = LocalIoCContainer.Resolve<ISimpleDataEntityReposi~\\
\cellcolor{gray} &  & \verb~106~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~107~ & & \verb~            var itemToUpdate = repository.Find(2);~\\
\cellcolor{green} & 1 & \verb~108~ & & \verb~            itemToUpdate.Name = "Updated Name 2";~\\
\cellcolor{green} & 1 & \verb~109~ & & \verb~            repository.Update(itemToUpdate, x => x.Id == 55);~\\
\cellcolor{red} & 0 & \verb~110~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~111~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~112~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Repository6.Tests.TestDbInitializer}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Repository6.Tests.TestDbInitializer\\
\textbf{Assembly:} & entityframework.repository6.tests.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{orkRepository6\textbackslash EntityFrameworkRepository6Tests\textbackslash SampleData\textbackslash TestDbInitializer.cs}\end{minipage} \\
\textbf{Covered lines:} & 7\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 7\\
\textbf{Total lines:} & 24\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{Seed(PersistentLayer} & 10 & 0\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{orkRepository6\textbackslash EntityFrameworkRepository6Tests\textbackslash SampleData\textbackslash TestDbInitializer.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using PersistentLayer.Contexts;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using PersistentLayer.Entities;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System.Data.Entity;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using System.Text;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~namespace EntityFramework.Repository6.Tests~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~    public class TestDbInitializer : DropCreateDatabaseAlways<YourCustomDataCo~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~        protected override void Seed(YourCustomDataContext context)~\\
\cellcolor{green} & 1 & \verb~15~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~16~ & & \verb~            var mydata1 = new SimpleDataEntity { Name = "Hello Test 2" };~\\
\cellcolor{green} & 1 & \verb~17~ & & \verb~            var mydata2 = new SimpleDataEntity { Name = "Hello Test Again 2" }~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~19~ & & \verb~            context.SimpleDataEntities.Add(mydata1);~\\
\cellcolor{green} & 1 & \verb~20~ & & \verb~            context.SimpleDataEntities.Add(mydata2);~\\
\cellcolor{green} & 1 & \verb~21~ & & \verb~            context.SaveChanges();~\\
\cellcolor{green} & 1 & \verb~22~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~}~\\
\end{longtable}
\newpage
\section{EntityFramework.Repository6.Tests.TestExampleDatabaseFactory}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & EntityFramework.Repository6.Tests.TestExampleDatabaseFactory\\
\textbf{Assembly:} & entityframework.repository6.tests.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{tory6\textbackslash EntityFrameworkRepository6Tests\textbackslash SampleData\textbackslash TestExampleDatabaseFactory.cs}\end{minipage} \\
\textbf{Covered lines:} & 17\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 17\\
\textbf{Total lines:} & 45\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{GetNewDbContext()} & 46 & 0\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{tory6\textbackslash EntityFrameworkRepository6Tests\textbackslash SampleData\textbackslash TestExampleDatabaseFactory.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using System.Text;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Data.Entity;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using Effort.Extra;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~using PersistentLayer.Entities;~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~using PersistentLayer;~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~using PersistentLayer.Contexts;~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~using EntityFramework.Repository6;~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~namespace EntityFramework.Repository6.Tests~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    public class TestExampleDatabaseFactory : IDatabaseFactory<YourCustomDataC~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~17~ & & \verb~        public Action<string> Logging { get; set; }~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~        public YourCustomDataContext GetNewDbContext()~\\
\cellcolor{green} & 1 & \verb~20~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~21~ & & \verb~            var data = new ObjectData();~\\
\cellcolor{gray} &  & \verb~22~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~23~ & & \verb~            data.Table<SimpleDataEntity>("SimpleDataEntities").Add(new SimpleD~\\
\cellcolor{green} & 1 & \verb~24~ & & \verb~            data.Table<SimpleDataEntity>("SimpleDataEntities").Add(new SimpleD~\\
\cellcolor{green} & 1 & \verb~25~ & & \verb~            data.Table<SimpleDataEntity>("SimpleDataEntities").Add(new SimpleD~\\
\cellcolor{green} & 1 & \verb~26~ & & \verb~            data.Table<SimpleDataEntity>("SimpleDataEntities").Add(new SimpleD~\\
\cellcolor{green} & 1 & \verb~27~ & & \verb~            data.Table<SimpleDataEntity>("SimpleDataEntities").Add(new SimpleD~\\
\cellcolor{gray} &  & \verb~28~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~29~ & & \verb~            data.Table<SimpleCompositeKeyEntity>("SimpleCompositeKeyEntities")~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~31~ & & \verb~            var dataLoader = new ObjectDataLoader(data);~\\
\cellcolor{gray} &  & \verb~32~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~33~ & & \verb~            var connection = Effort.DbConnectionFactory.CreateTransient(dataLo~\\
\cellcolor{gray} &  & \verb~34~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~35~ & & \verb~            var _context = new YourCustomDataContext(connection);~\\
\cellcolor{gray} &  & \verb~36~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~37~ & & \verb~            _context.Database.CreateIfNotExists();~\\
\cellcolor{green} & 1 & \verb~38~ & & \verb~            _context.Database.Initialize(true);~\\
\cellcolor{gray} &  & \verb~39~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~40~ & & \verb~            if (Logging != null) { _context.Database.Log = Logging; }~\\
\cellcolor{gray} &  & \verb~41~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~42~ & & \verb~            return _context;~\\
\cellcolor{green} & 1 & \verb~43~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~44~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~45~ & & \verb~}~\\
\end{longtable}
\newpage
\section{PersistentLayer.Auditable.Contexts.YourCustomDataContext}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & PersistentLayer.Auditable.Contexts.YourCustomDataContext\\
\textbf{Assembly:} & persistentlayer.auditable.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{rameworkRepository6\textbackslash PersistentLayerAuditable\textbackslash Contexts\textbackslash YourCustomDataContext.cs}\end{minipage} \\
\textbf{Covered lines:} & 4\\
\textbf{Uncovered lines:} & 1\\
\textbf{Coverable lines:} & 5\\
\textbf{Total lines:} & 30\\
\textbf{Line coverage:} & 80\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{YourCustomDataContex} & 0 & 2\\
\hline
\textbf{YourCustomDataContex} & 2 & 0\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{rameworkRepository6\textbackslash PersistentLayerAuditable\textbackslash Contexts\textbackslash YourCustomDataContext.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using PersistentLayer.Auditable.Entities;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using System.Data.Entity;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Text;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~using System.Data.Common;~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~using System.Data.Entity.ModelConfiguration.Conventions;~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~using PersistentLayer.Auditable.Initializers;~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~using EntityFramework.Auditable.Repository6;~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~namespace PersistentLayer.Auditable.Contexts~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    public class YourCustomDataContext : AuditableBaseContext<YourCustomDataCo~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~17~ & & \verb~        public DbSet<SimpleDataEntity> SimpleDataEntities { get; set; }~\\
\cellcolor{green} & 1 & \verb~18~ & & \verb~        public DbSet<SimpleCompositeKeyEntity> SimpleCompositeKeyEntities { ge~\\
\cellcolor{green} & 1 & \verb~19~ & & \verb~        public DbSet<SimpleDataEntityAudit> SimpleDataEntityAudits { get; set;~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~~\\
\cellcolor{gray} &  & \verb~21~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~22~ & & \verb~        public YourCustomDataContext(string connectionString) : base(connectio~\\
\cellcolor{green} & 1 & \verb~23~ & & \verb~        public YourCustomDataContext(DbConnection dbConnection) : base(dbConne~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~~\\
\cellcolor{gray} &  & \verb~25~ & & \verb~        //protected override void OnModelCreating(DbModelBuilder modelBuilder)~\\
\cellcolor{gray} &  & \verb~26~ & & \verb~        //{~\\
\cellcolor{gray} &  & \verb~27~ & & \verb~        //    modelBuilder.Conventions.Remove<PluralizingTableNameConvention>(~\\
\cellcolor{gray} &  & \verb~28~ & & \verb~        //}~\\
\cellcolor{gray} &  & \verb~29~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~30~ & & \verb~}~\\
\end{longtable}
\newpage
\section{PersistentLayer.Auditable.Entities.PersistentEntity}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & PersistentLayer.Auditable.Entities.PersistentEntity\\
\textbf{Assembly:} & persistentlayer.auditable.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{tityFrameworkRepository6\textbackslash PersistentLayerAuditable\textbackslash Entities\textbackslash PersistentEntity.cs}\end{minipage} \\
\textbf{Covered lines:} & 0\\
\textbf{Uncovered lines:} & 1\\
\textbf{Coverable lines:} & 1\\
\textbf{Total lines:} & 13\\
\textbf{Line coverage:} & 0\%\\
\end{longtable}
\subsection{File(s)}
\subsubsection{tityFrameworkRepository6\textbackslash PersistentLayerAuditable\textbackslash Entities\textbackslash PersistentEntity.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using System.Text;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~namespace PersistentLayer.Auditable.Entities~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~    public abstract class PersistentEntity~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~    {~\\
\cellcolor{red} & 0 & \verb~11~ & & \verb~        public int Id { get; set; }~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~}~\\
\end{longtable}
\newpage
\section{PersistentLayer.Auditable.Entities.SimpleCompositeKeyEntity}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & PersistentLayer.Auditable.Entities.SimpleCompositeKeyEntity\\
\textbf{Assembly:} & persistentlayer.auditable.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{eworkRepository6\textbackslash PersistentLayerAuditable\textbackslash Entities\textbackslash SimpleCompositeKeyEntity.cs}\end{minipage} \\
\textbf{Covered lines:} & 2\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 2\\
\textbf{Total lines:} & 20\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{File(s)}
\subsubsection{eworkRepository6\textbackslash PersistentLayerAuditable\textbackslash Entities\textbackslash SimpleCompositeKeyEntity.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System.ComponentModel.DataAnnotations;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using System.ComponentModel.DataAnnotations.Schema;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Text;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~namespace PersistentLayer.Auditable.Entities~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~    public class SimpleCompositeKeyEntity~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~        [Key]~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~        [Column(Order = 1)]~\\
\cellcolor{green} & 1 & \verb~15~ & & \verb~        public int Id { get; set; }~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~        [Key]~\\
\cellcolor{gray} &  & \verb~17~ & & \verb~        [Column(Order = 2)]~\\
\cellcolor{green} & 1 & \verb~18~ & & \verb~        public string Name { get; set; }~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~}~\\
\end{longtable}
\newpage
\section{PersistentLayer.Auditable.Entities.SimpleDataEntity}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & PersistentLayer.Auditable.Entities.SimpleDataEntity\\
\textbf{Assembly:} & persistentlayer.auditable.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{tityFrameworkRepository6\textbackslash PersistentLayerAuditable\textbackslash Entities\textbackslash SimpleDataEntity.cs}\end{minipage} \\
\textbf{Covered lines:} & 2\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 2\\
\textbf{Total lines:} & 13\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{File(s)}
\subsubsection{tityFrameworkRepository6\textbackslash PersistentLayerAuditable\textbackslash Entities\textbackslash SimpleDataEntity.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using EntityFramework.Auditing;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using System.ComponentModel.DataAnnotations;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System.ComponentModel.DataAnnotations.Schema;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~namespace PersistentLayer.Auditable.Entities~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~    public class SimpleDataEntity : AuditableEntity~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~        [Key, DatabaseGenerated(DatabaseGeneratedOption.Identity)]~\\
\cellcolor{green} & 1 & \verb~10~ & & \verb~        public virtual int Id { get; set; }~\\
\cellcolor{green} & 1 & \verb~11~ & & \verb~        public string Name { get; set; }~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~}~\\
\end{longtable}
\newpage
\section{PersistentLayer.Auditable.Entities.SimpleDataEntityAudit}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & PersistentLayer.Auditable.Entities.SimpleDataEntityAudit\\
\textbf{Assembly:} & persistentlayer.auditable.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{rameworkRepository6\textbackslash PersistentLayerAuditable\textbackslash Entities\textbackslash SimpleDataAuditEntity.cs}\end{minipage} \\
\textbf{Covered lines:} & 3\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 3\\
\textbf{Total lines:} & 16\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{File(s)}
\subsubsection{rameworkRepository6\textbackslash PersistentLayerAuditable\textbackslash Entities\textbackslash SimpleDataAuditEntity.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using EntityFramework.Auditing;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using System.ComponentModel.DataAnnotations;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System.ComponentModel.DataAnnotations.Schema;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~namespace PersistentLayer.Auditable.Entities~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~    public class SimpleDataEntityAudit : AuditEntity~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~        [Key, DatabaseGenerated(DatabaseGeneratedOption.Identity)]~\\
\cellcolor{green} & 1 & \verb~10~ & & \verb~        public int Id { get; set; }~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~12~ & & \verb~        public override int AuditSourceId { get; set; }~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~14~ & & \verb~        public string Name { get; set; }~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~}~\\
\end{longtable}
\newpage
\section{PersistentLayer.Auditable.Initializers.MyDbInitializer}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & PersistentLayer.Auditable.Initializers.MyDbInitializer\\
\textbf{Assembly:} & persistentlayer.auditable.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{yFrameworkRepository6\textbackslash PersistentLayerAuditable\textbackslash Initializers\textbackslash MyDbInitializer.cs}\end{minipage} \\
\textbf{Covered lines:} & 0\\
\textbf{Uncovered lines:} & 7\\
\textbf{Coverable lines:} & 7\\
\textbf{Total lines:} & 24\\
\textbf{Line coverage:} & 0\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{Seed(PersistentLayer} & 0 & 10\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{yFrameworkRepository6\textbackslash PersistentLayerAuditable\textbackslash Initializers\textbackslash MyDbInitializer.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using PersistentLayer.Auditable.Contexts;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using PersistentLayer.Auditable.Entities;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System.Data.Entity;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using System.Text;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~namespace PersistentLayer.Auditable.Initializers~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~    public class MyDbInitializer : DropCreateDatabaseIfModelChanges<YourCustom~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~        protected override void Seed(YourCustomDataContext context)~\\
\cellcolor{red} & 0 & \verb~15~ & & \verb~        {~\\
\cellcolor{red} & 0 & \verb~16~ & & \verb~            var mydata1 = new SimpleDataEntity { Name = "Hello Test" };~\\
\cellcolor{red} & 0 & \verb~17~ & & \verb~            var mydata2 = new SimpleDataEntity { Name = "Hello Test Again" };~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~19~ & & \verb~            context.SimpleDataEntities.Add(mydata1);~\\
\cellcolor{red} & 0 & \verb~20~ & & \verb~            context.SimpleDataEntities.Add(mydata2);~\\
\cellcolor{red} & 0 & \verb~21~ & & \verb~            context.SaveChanges();~\\
\cellcolor{red} & 0 & \verb~22~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~}~\\
\end{longtable}
\newpage
\section{PersistentLayer.Auditable.Repositories.SimpleCompositeKeyEntityRepository}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & PersistentLayer.Auditable.Repositories.SimpleCompositeKeyEntityRepository\\
\textbf{Assembly:} & persistentlayer.auditable.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{y6\textbackslash PersistentLayerAuditable\textbackslash Repositories\textbackslash SimpleCompositeKeyEntityRepository.cs}\end{minipage} \\
\textbf{Covered lines:} & 3\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 3\\
\textbf{Total lines:} & 26\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{SimpleCompositeKeyEn} & 3 & 0\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{y6\textbackslash PersistentLayerAuditable\textbackslash Repositories\textbackslash SimpleCompositeKeyEntityRepository.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using EntityFramework.Auditable.Repository6;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using EntityFramework.Repository6;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using EntityFramework.Repository6.Interfaces;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using PersistentLayer.Auditable.Contexts;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using PersistentLayer.Auditable.Entities;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~using System.Text;~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~namespace PersistentLayer.Auditable.Repositories~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~    public interface ISimpleCompositeKeyEntityRepository : IBaseRepository<You~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~~\\
\cellcolor{gray} &  & \verb~17~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~    public class SimpleCompositeKeyEntityRepository : AuditableBaseRepository<~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~21~ & & \verb~        public SimpleCompositeKeyEntityRepository(IDatabaseFactory<YourCustomD~\\
\cellcolor{green} & 1 & \verb~22~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~24~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~25~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~26~ & & \verb~}~\\
\end{longtable}
\newpage
\section{PersistentLayer.Auditable.Repositories.SimpleDataEntityRepository}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & PersistentLayer.Auditable.Repositories.SimpleDataEntityRepository\\
\textbf{Assembly:} & persistentlayer.auditable.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{epository6\textbackslash PersistentLayerAuditable\textbackslash Repositories\textbackslash SimpleDataEntityRepository.cs}\end{minipage} \\
\textbf{Covered lines:} & 6\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 6\\
\textbf{Total lines:} & 27\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{SimpleDataEntityRepo} & 3 & 0\\
\hline
\textbf{GetExistingContext()} & 3 & 0\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{epository6\textbackslash PersistentLayerAuditable\textbackslash Repositories\textbackslash SimpleDataEntityRepository.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using PersistentLayer.Auditable.Contexts;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using PersistentLayer.Auditable.Entities;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using EntityFramework.Repository6.Interfaces;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using EntityFramework.Auditable.Repository6;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using EntityFramework.Repository6;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~namespace PersistentLayer.Auditable.Repositories~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~    public interface ISimpleDataEntityRepository : IBaseRepository<YourCustomD~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~        YourCustomDataContext GetExistingContext();~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    public class SimpleDataEntityRepository : AuditableBaseRepository<YourCust~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~17~ & & \verb~        public SimpleDataEntityRepository(IDatabaseFactory<YourCustomDataConte~\\
\cellcolor{green} & 1 & \verb~18~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~20~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~21~ & & \verb~~\\
\cellcolor{gray} &  & \verb~22~ & & \verb~        public YourCustomDataContext GetExistingContext()~\\
\cellcolor{green} & 1 & \verb~23~ & & \verb~        {~\\
\cellcolor{green} & 1 & \verb~24~ & & \verb~            return Context;~\\
\cellcolor{green} & 1 & \verb~25~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~26~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~27~ & & \verb~}~\\
\end{longtable}
\newpage
\section{PersistentLayer.Contexts.YourCustomDataContext}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & PersistentLayer.Contexts.YourCustomDataContext\\
\textbf{Assembly:} & persistentlayer.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{t\textbackslash EntityFrameworkRepository6\textbackslash PersistentLayer\textbackslash Contexts\textbackslash YourCustomDataContext.cs}\end{minipage} \\
\textbf{Covered lines:} & 3\\
\textbf{Uncovered lines:} & 1\\
\textbf{Coverable lines:} & 4\\
\textbf{Total lines:} & 29\\
\textbf{Line coverage:} & 75\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{YourCustomDataContex} & 0 & 2\\
\hline
\textbf{YourCustomDataContex} & 2 & 0\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{t\textbackslash EntityFrameworkRepository6\textbackslash PersistentLayer\textbackslash Contexts\textbackslash YourCustomDataContext.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using PersistentLayer.Entities;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using System.Data.Entity;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Text;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~using System.Data.Common;~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~using System.Data.Entity.ModelConfiguration.Conventions;~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~using PersistentLayer.Initializers;~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~using EntityFramework.Repository6;~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~namespace PersistentLayer.Contexts~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    public class YourCustomDataContext : BaseContext<YourCustomDataContext>~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~17~ & & \verb~        public DbSet<SimpleDataEntity> SimpleDataEntities { get; set; }~\\
\cellcolor{green} & 1 & \verb~18~ & & \verb~        public DbSet<SimpleCompositeKeyEntity> SimpleCompositeKeyEntities { ge~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~21~ & & \verb~        public YourCustomDataContext(string connectionString) : base(connectio~\\
\cellcolor{green} & 1 & \verb~22~ & & \verb~        public YourCustomDataContext(DbConnection dbConnection) : base(dbConne~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~        //protected override void OnModelCreating(DbModelBuilder modelBuilder)~\\
\cellcolor{gray} &  & \verb~25~ & & \verb~        //{~\\
\cellcolor{gray} &  & \verb~26~ & & \verb~        //    modelBuilder.Conventions.Remove<PluralizingTableNameConvention>(~\\
\cellcolor{gray} &  & \verb~27~ & & \verb~        //}~\\
\cellcolor{gray} &  & \verb~28~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~29~ & & \verb~}~\\
\end{longtable}
\newpage
\section{PersistentLayer.Entities.PersistentEntity}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & PersistentLayer.Entities.PersistentEntity\\
\textbf{Assembly:} & persistentlayer.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{opment\textbackslash EntityFrameworkRepository6\textbackslash PersistentLayer\textbackslash Entities\textbackslash PersistentEntity.cs}\end{minipage} \\
\textbf{Covered lines:} & 1\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 1\\
\textbf{Total lines:} & 13\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{File(s)}
\subsubsection{opment\textbackslash EntityFrameworkRepository6\textbackslash PersistentLayer\textbackslash Entities\textbackslash PersistentEntity.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using System.Text;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~namespace PersistentLayer.Entities~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~    public abstract class PersistentEntity~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~11~ & & \verb~        public int Id { get; set; }~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~}~\\
\end{longtable}
\newpage
\section{PersistentLayer.Entities.SimpleCompositeKeyEntity}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & PersistentLayer.Entities.SimpleCompositeKeyEntity\\
\textbf{Assembly:} & persistentlayer.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{ntityFrameworkRepository6\textbackslash PersistentLayer\textbackslash Entities\textbackslash SimpleCompositeKeyEntity.cs}\end{minipage} \\
\textbf{Covered lines:} & 2\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 2\\
\textbf{Total lines:} & 20\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{File(s)}
\subsubsection{ntityFrameworkRepository6\textbackslash PersistentLayer\textbackslash Entities\textbackslash SimpleCompositeKeyEntity.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System.ComponentModel.DataAnnotations;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using System.ComponentModel.DataAnnotations.Schema;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Text;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~namespace PersistentLayer.Entities~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~    public class SimpleCompositeKeyEntity~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~        [Key]~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~        [Column(Order = 1)]~\\
\cellcolor{green} & 1 & \verb~15~ & & \verb~        public int Id { get; set; }~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~        [Key]~\\
\cellcolor{gray} &  & \verb~17~ & & \verb~        [Column(Order = 2)]~\\
\cellcolor{green} & 1 & \verb~18~ & & \verb~        public string Name { get; set; }~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~20~ & & \verb~}~\\
\end{longtable}
\newpage
\section{PersistentLayer.Entities.SimpleDataEntity}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & PersistentLayer.Entities.SimpleDataEntity\\
\textbf{Assembly:} & persistentlayer.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{opment\textbackslash EntityFrameworkRepository6\textbackslash PersistentLayer\textbackslash Entities\textbackslash SimpleDataEntity.cs}\end{minipage} \\
\textbf{Covered lines:} & 1\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 1\\
\textbf{Total lines:} & 7\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{File(s)}
\subsubsection{opment\textbackslash EntityFrameworkRepository6\textbackslash PersistentLayer\textbackslash Entities\textbackslash SimpleDataEntity.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~namespace PersistentLayer.Entities~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~    public class SimpleDataEntity : PersistentEntity~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~5~ & & \verb~        public string Name { get; set; }~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~}~\\
\end{longtable}
\newpage
\section{PersistentLayer.Initializers.MyDbInitializer}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & PersistentLayer.Initializers.MyDbInitializer\\
\textbf{Assembly:} & persistentlayer.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{ent\textbackslash EntityFrameworkRepository6\textbackslash PersistentLayer\textbackslash Initializers\textbackslash MyDbInitializer.cs}\end{minipage} \\
\textbf{Covered lines:} & 0\\
\textbf{Uncovered lines:} & 7\\
\textbf{Coverable lines:} & 7\\
\textbf{Total lines:} & 24\\
\textbf{Line coverage:} & 0\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{Seed(PersistentLayer} & 0 & 10\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{ent\textbackslash EntityFrameworkRepository6\textbackslash PersistentLayer\textbackslash Initializers\textbackslash MyDbInitializer.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using PersistentLayer.Contexts;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using PersistentLayer.Entities;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System.Data.Entity;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using System.Text;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~namespace PersistentLayer.Initializers~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~    public class MyDbInitializer : DropCreateDatabaseIfModelChanges<YourCustom~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~        protected override void Seed(YourCustomDataContext context)~\\
\cellcolor{red} & 0 & \verb~15~ & & \verb~        {~\\
\cellcolor{red} & 0 & \verb~16~ & & \verb~            var mydata1 = new SimpleDataEntity { Name = "Hello Test" };~\\
\cellcolor{red} & 0 & \verb~17~ & & \verb~            var mydata2 = new SimpleDataEntity { Name = "Hello Test Again" };~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~~\\
\cellcolor{red} & 0 & \verb~19~ & & \verb~            context.SimpleDataEntities.Add(mydata1);~\\
\cellcolor{red} & 0 & \verb~20~ & & \verb~            context.SimpleDataEntities.Add(mydata2);~\\
\cellcolor{red} & 0 & \verb~21~ & & \verb~            context.SaveChanges();~\\
\cellcolor{red} & 0 & \verb~22~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~23~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~}~\\
\end{longtable}
\newpage
\section{PersistentLayer.Repositories.SimpleCompositeKeyEntityRepository}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & PersistentLayer.Repositories.SimpleCompositeKeyEntityRepository\\
\textbf{Assembly:} & persistentlayer.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{Repository6\textbackslash PersistentLayer\textbackslash Repositories\textbackslash SimpleCompositeKeyEntityRepository.cs}\end{minipage} \\
\textbf{Covered lines:} & 3\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 3\\
\textbf{Total lines:} & 25\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{SimpleCompositeKeyEn} & 3 & 0\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{Repository6\textbackslash PersistentLayer\textbackslash Repositories\textbackslash SimpleCompositeKeyEntityRepository.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using EntityFramework.Repository6;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using EntityFramework.Repository6.Interfaces;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using PersistentLayer.Contexts;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using PersistentLayer.Entities;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~using System.Text;~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~namespace PersistentLayer.Repositories~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~    public interface ISimpleCompositeKeyEntityRepository : IBaseRepository<You~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~17~ & & \verb~~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~    public class SimpleCompositeKeyEntityRepository : BaseRepository<YourCusto~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~20~ & & \verb~        public SimpleCompositeKeyEntityRepository(IDatabaseFactory<YourCustomD~\\
\cellcolor{green} & 1 & \verb~21~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~22~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~23~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~25~ & & \verb~}~\\
\end{longtable}
\newpage
\section{PersistentLayer.Repositories.SimpleDataEntityRepository}
\subsection{Summary}
\begin{longtable}[l]{ll}
\textbf{Class:} & PersistentLayer.Repositories.SimpleDataEntityRepository\\
\textbf{Assembly:} & persistentlayer.dll\\
\textbf{File(s):} & \begin{minipage}[t]{12cm}{rameworkRepository6\textbackslash PersistentLayer\textbackslash Repositories\textbackslash SimpleDataEntityRepository.cs}\end{minipage} \\
\textbf{Covered lines:} & 3\\
\textbf{Uncovered lines:} & 0\\
\textbf{Coverable lines:} & 3\\
\textbf{Total lines:} & 25\\
\textbf{Line coverage:} & 100\%\\
\end{longtable}
\subsection{Metrics}
\begin{longtable}[l]{|l|l|l|}
\hline
\textbf{Method} & \textbf{Blocks covered} & \textbf{Blocks not covered}\\
\hline
\textbf{SimpleDataEntityRepo} & 3 & 0\\
\hline
\end{longtable}
\subsection{File(s)}
\subsubsection{rameworkRepository6\textbackslash PersistentLayer\textbackslash Repositories\textbackslash SimpleDataEntityRepository.cs}
\begin{longtable}[l]{lrrll}
\textbf{} & \textbf{\#} & \textbf{Line} & \textbf{} & \textbf{Line coverage}\\
\cellcolor{gray} &  & \verb~1~ & & \verb~using EntityFramework.Repository6;~\\
\cellcolor{gray} &  & \verb~2~ & & \verb~using EntityFramework.Repository6.Interfaces;~\\
\cellcolor{gray} &  & \verb~3~ & & \verb~using PersistentLayer.Contexts;~\\
\cellcolor{gray} &  & \verb~4~ & & \verb~using PersistentLayer.Entities;~\\
\cellcolor{gray} &  & \verb~5~ & & \verb~using System;~\\
\cellcolor{gray} &  & \verb~6~ & & \verb~using System.Collections.Generic;~\\
\cellcolor{gray} &  & \verb~7~ & & \verb~using System.Data.Entity;~\\
\cellcolor{gray} &  & \verb~8~ & & \verb~using System.Linq;~\\
\cellcolor{gray} &  & \verb~9~ & & \verb~using System.Text;~\\
\cellcolor{gray} &  & \verb~10~ & & \verb~using System.Threading.Tasks;~\\
\cellcolor{gray} &  & \verb~11~ & & \verb~~\\
\cellcolor{gray} &  & \verb~12~ & & \verb~namespace PersistentLayer.Repositories~\\
\cellcolor{gray} &  & \verb~13~ & & \verb~{~\\
\cellcolor{gray} &  & \verb~14~ & & \verb~    public interface ISimpleDataEntityRepository : IBaseRepository<YourCustomD~\\
\cellcolor{gray} &  & \verb~15~ & & \verb~    {~\\
\cellcolor{gray} &  & \verb~16~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~17~ & & \verb~~\\
\cellcolor{gray} &  & \verb~18~ & & \verb~    public class SimpleDataEntityRepository : BaseRepository<YourCustomDataCon~\\
\cellcolor{gray} &  & \verb~19~ & & \verb~    {~\\
\cellcolor{green} & 1 & \verb~20~ & & \verb~        public SimpleDataEntityRepository(IDatabaseFactory<YourCustomDataConte~\\
\cellcolor{green} & 1 & \verb~21~ & & \verb~        {~\\
\cellcolor{gray} &  & \verb~22~ & & \verb~~\\
\cellcolor{green} & 1 & \verb~23~ & & \verb~        }~\\
\cellcolor{gray} &  & \verb~24~ & & \verb~    }~\\
\cellcolor{gray} &  & \verb~25~ & & \verb~}~\\
\end{longtable}
\end{document}